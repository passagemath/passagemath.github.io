<!doctype html>
<html class="no-js" lang="ja" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="genindex.html" /><link rel="search" title="検索" href="search.html" /><link rel="next" title="インターフェイスについて" href="interfaces.html" /><link rel="prev" title="より進んだ数学" href="tour_advanced.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>対話型シェル - Sage チュートリアル v10.6.2</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom-furo.css?v=d2ecc25a" />
    <link rel="stylesheet" type="text/css" href="_static/custom-jupyter-sphinx.css?v=75860c6b" />
    <link rel="stylesheet" type="text/css" href="_static/custom-codemirror-monokai.css?v=b5588f12" />
    <link rel="stylesheet" type="text/css" href="_static/custom-tabs.css?v=8a724d73" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Sage チュートリアル v10.6.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../en/index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">passagemath 10.6.2 Documentation</span>
  
</a><div class="select-wrapper">
  <select id="versions-menu" onchange="changeVersion()">
    <option value="" selected>other version</option>
    <option value="https://doc-develop--sagemath.netlify.app">develop</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="検索" name="q" aria-label="検索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="index.html">Home - Sage チュートリアル v10.6.2</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">はじめに</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tour.html">Sage観光ツアー</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Sage観光ツアー</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tour_assignment.html">代入，等式と算術演算</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_help.html">ヘルプの利用</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_help.html#section-functions">関数, インデントおよび数え上げ</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_algebra.html">代数と微積分の基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_plotting.html">プロットする</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_functions.html">関数まわりの注意点</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_rings.html">基本的な環</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_linalg.html">線形代数</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_polynomial.html">多項式</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_coercion.html">ペアレント，型変換および型強制</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_groups.html">有限群，アーベル群</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_numtheory.html">数論</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_advanced.html">より進んだ数学</a></li>
</ul>
</li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">対話型シェル</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">インターフェイスについて</a></li>
<li class="toctree-l1"><a class="reference internal" href="latex.html">Sage，LaTeXと仲間たち</a></li>
<li class="toctree-l1"><a class="reference internal" href="programming.html">プログラミング</a></li>
<li class="toctree-l1"><a class="reference internal" href="sagetex.html">SageTeXを使う</a></li>
<li class="toctree-l1"><a class="reference internal" href="afterword.html">あとがき</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">付録</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/blob/develop/src/doc/ja/tutorial/interactive_shell.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/edit/develop/src/doc/ja/tutorial/interactive_shell.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="chapter-interactive-shell">
<span id="id1"></span><h1>対話型シェル<a class="headerlink" href="#chapter-interactive-shell" title="Link to this heading">¶</a></h1>
<p>このチュートリアルの大部分は，読者が <code class="docutils literal notranslate"><span class="pre">sage</span></code> コマンドによってSageインタプリタを起動しているものと前提している．
コマンド <code class="docutils literal notranslate"><span class="pre">sage</span></code> は改造版IPythonシェルを起動し，大量の関数やクラス群をインポートしてコマンドプロンプトから利用可能にする．
<code class="docutils literal notranslate"><span class="pre">$SAGE_ROOT/ipythonrc</span></code> ファイルを編集すれば，さらなるシェル環境のカスタマイズも可能だ．
Sageを起動すると，すぐに次のような画面が現れる:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">┌────────────────────────────────────────────────────────────────────┐</span>
<span class="go">│ SageMath version 9.7, Release Date: 2022-01-10                     │</span>
<span class="go">│ Using Python 3.10.4. Type &quot;help()&quot; for help.                       │</span>
<span class="go">└────────────────────────────────────────────────────────────────────┘</span>


<span class="gp">sage:</span>
</pre></div>
</div>
<p>Sageを終了するには，Ctrl-Dと押すか， コマンド <code class="docutils literal notranslate"><span class="pre">quit</span></code> あるいは <code class="docutils literal notranslate"><span class="pre">exit</span></code> を入力する．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">quit</span>
<span class="go">Exiting Sage (CPU time 0m0.00s, Wall time 0m0.89s)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">quit</span>
<span class="go">Exiting Sage (CPU time 0m0.00s, Wall time 0m0.89s)</span>
</pre></div>
</div>
</div>
</div>
<p>&quot;Wall time&quot;は，CPUタイムではなく外界の実経過時間を示している．
CPUタイムはGAPやSingularなどのサブプロセスの消費時間までは勘定に入れてくれないから，実経過時間も計算時間の見積りに必要だ．</p>
<p>(ターミナルから <code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-9</span></code> を入力してSageプロセスを停止するのは止めたほうがいい．
<code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-9</span></code> ではMapleなどの子プロセスが停止しなかったり， <code class="docutils literal notranslate"><span class="pre">$HOME/.sage/tmp</span></code> 内の一時ファイルが消去されずに終わるなどの恐れがある．)</p>
<section id="sage">
<h2>Sageセッション<a class="headerlink" href="#sage" title="Link to this heading">¶</a></h2>
<p><em>セッション</em> とは，Sageの起動から終了までの間に行なわれた一連の入出力の総体のことをいう．
Sageは，Sageに対する入力の全てをIPython経由で記録している．
事実，(ノートブック経由ではなく)対話型シェルを使ってSageを動かしているのならば，好きな時に <code class="docutils literal notranslate"><span class="pre">%history</span></code> (または <code class="docutils literal notranslate"><span class="pre">%hist</span></code>) と入力して，それまでの全入力履歴を見ることができる．
IPythonについてもっと知りたければ、Sageプロンプトで <code class="docutils literal notranslate"><span class="pre">?</span></code> と入力すれば， &quot;IPython offers numbered prompts ... with input and output caching. All input is saved and can be retrieved as variables (besides the usual arrow key recall). The following GLOBAL variables always exist (so don't overwrite them!)&quot; などと詳しい情報を表示させることができる:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">   _:  前回の入力を呼び出す (対話型シェルとノートブックの両方で通用する)</span>
<span class="go">  __: 前々回の入力を呼び出す(対話型シェルのみで通用)</span>
<span class="go">_oh : 全ての入力をリストする(対話型シェルのみで通用)</span>
</pre></div>
</div>
<p>ここで例を見てみよう:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">factor</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go"> _1 = 2^2 * 5^2</span>
<span class="gp">sage:</span> <span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go"> _2 = -1</span>
<span class="gp">sage:</span> <span class="o">%</span><span class="k">hist</span>   # これが使えるのは対話型シェル上のみ．ノートブックではだめ．
<span class="go">1: factor(100)</span>
<span class="go">2: kronecker_symbol(3,5)</span>
<span class="go">3: %hist</span>
<span class="gp">sage:</span> <span class="n">_oh</span>
<span class="go"> _4 = {1: 2^2 * 5^2, 2: -1}</span>
<span class="gp">sage:</span> <span class="n">_i1</span>
<span class="go"> _5 = &#39;factor(ZZ(100))\n&#39;</span>
<span class="gp">sage:</span> <span class="nb">eval</span><span class="p">(</span><span class="n">_i1</span><span class="p">)</span>
<span class="go"> _6 = 2^2 * 5^2</span>
<span class="gp">sage:</span> <span class="o">%</span><span class="k">hist</span>
<span class="go">1: factor(100)</span>
<span class="go">2: kronecker_symbol(3,5)</span>
<span class="go">3: %hist</span>
<span class="go">4: _oh</span>
<span class="go">5: _i1</span>
<span class="go">6: eval(_i1)</span>
<span class="go">7: %hist</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">factor</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go"> _1 = 2^2 * 5^2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">kronecker_symbol</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go"> _2 = -1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">hist</span>   # これが使えるのは対話型シェル上のみ．ノートブックではだめ．
<span class="go">1: factor(100)</span>
<span class="go">2: kronecker_symbol(3,5)</span>
<span class="go">3: %hist</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">_oh</span>
<span class="go"> _4 = {1: 2^2 * 5^2, 2: -1}</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">_i1</span>
<span class="go"> _5 = &#39;factor(ZZ(100))\n&#39;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="n">_i1</span><span class="p">)</span>
<span class="go"> _6 = 2^2 * 5^2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">hist</span>
<span class="go">1: factor(100)</span>
<span class="go">2: kronecker_symbol(3,5)</span>
<span class="go">3: %hist</span>
<span class="go">4: _oh</span>
<span class="go">5: _i1</span>
<span class="go">6: eval(_i1)</span>
<span class="go">7: %hist</span>
</pre></div>
</div>
</div>
</div>
<p>以降，このチュートリアル，それに他のSageドキュメンテーションでも出力番号を省略する．</p>
<p>セッション中は，一連の入力をマクロとして保存しておいて再利用することもできる．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="o">%</span><span class="k">hist</span>
<span class="go">1: E = EllipticCurve([1,2,3,4,5])</span>
<span class="go">2: M = ModularSymbols(37)</span>
<span class="go">3: %hist</span>
<span class="gp">sage:</span> <span class="o">%</span><span class="k">macro</span> em 1-2
<span class="go">Macro `em` created. To execute, type its name (without quotes).</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">hist</span>
<span class="go">1: E = EllipticCurve([1,2,3,4,5])</span>
<span class="go">2: M = ModularSymbols(37)</span>
<span class="go">3: %hist</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">macro</span> em Integer(1)-Integer(2)
<span class="go">Macro `em` created. To execute, type its name (without quotes).</span>
</pre></div>
</div>
</div>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over</span>
<span class="go">Rational Field</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">sage:</span> <span class="n">em</span>
<span class="go">Executing Macro...</span>
<span class="gp">sage:</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over</span>
<span class="go">Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">em</span>
<span class="go">Executing Macro...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</div>
</div>
<p>対話型シェルを使っている間も，感嘆符 <code class="docutils literal notranslate"><span class="pre">!</span></code> を前置すれば好きなUNIXシェルコマンドを実行することができる．
例えば</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="o">!</span>ls
<span class="go">auto  example.sage glossary.tex  t  tmp  tut.log  tut.tex</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">!</span>ls
<span class="go">auto  example.sage glossary.tex  t  tmp  tut.log  tut.tex</span>
</pre></div>
</div>
</div>
</div>
<p>のように，カレントディレクトリの内容を表示することができる．</p>
<p>シェル変数 <code class="docutils literal notranslate"><span class="pre">PATH</span></code> の先頭にはSageのbinディレクトリが配置されているから， <code class="docutils literal notranslate"><span class="pre">gp</span></code> ， <code class="docutils literal notranslate"><span class="pre">gap</span></code> ， <code class="docutils literal notranslate"><span class="pre">singular</span></code> ， <code class="docutils literal notranslate"><span class="pre">maxima</span></code> などを実行すると，Sageに付属しているプログラムのバージョンを確認することができる．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="o">!</span>gp
<span class="go">Reading GPRC: /etc/gprc ...Done.</span>

<span class="go">                           GP/PARI CALCULATOR Version 2.2.11 (alpha)</span>
<span class="go">                  i686 running linux (ix86/GMP-4.1.4 kernel) 32-bit version</span>
<span class="gp">...</span>
<span class="gp">sage:</span> <span class="o">!</span>singular
<span class="go">                     SINGULAR                             /  Development</span>
<span class="go"> A Computer Algebra System for Polynomial Computations   /   version 3-0-1</span>
<span class="go">                                                       0&lt;</span>
<span class="go">     by: G.-M. Greuel, G. Pfister, H. Schoenemann        \   October 2005</span>
<span class="go">FB Mathematik der Universitaet, D-67653 Kaiserslautern    \</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">!</span>gp
<span class="go">Reading GPRC: /etc/gprc ...Done.</span>

<span class="go">                           GP/PARI CALCULATOR Version 2.2.11 (alpha)</span>
<span class="go">                  i686 running linux (ix86/GMP-4.1.4 kernel) 32-bit version</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">!</span>singular
<span class="go">                     SINGULAR                             /  Development</span>
<span class="go"> A Computer Algebra System for Polynomial Computations   /   version 3-0-1</span>
<span class="go">                                                       0&lt;</span>
<span class="go">     by: G.-M. Greuel, G. Pfister, H. Schoenemann        \   October 2005</span>
<span class="go">FB Mathematik der Universitaet, D-67653 Kaiserslautern    \</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>入出力のログをとる<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>Sageセッションのロギングと，セッションの保存(<a class="reference internal" href="#section-save"><span class="std std-ref">セッション全体の保存と読み込み</span></a> 節を参照)は同じことではない．
入力のログをとるには， <code class="docutils literal notranslate"><span class="pre">logstart</span></code> コマンドを使う(オプションで出力のログも可能だ)．
詳細については <code class="docutils literal notranslate"><span class="pre">logstart?</span></code> と入力してみてほしい．
<code class="docutils literal notranslate"><span class="pre">logstart</span></code> を使えば，全ての入力と出力のログを残し，将来のセッション時に(そのログファイルをリロードしてやるだけで)入力を再生することも可能になる．</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">was@form:~$ sage</span>
<span class="go">┌────────────────────────────────────────────────────────────────────┐</span>
<span class="go">│ SageMath version 9.7, Release Date: 2022-01-10                     │</span>
<span class="go">│ Using Python 3.10.4. Type &quot;help()&quot; for help.                       │</span>
<span class="go">└────────────────────────────────────────────────────────────────────┘</span>

<span class="gp">sage:</span> <span class="n">logstart</span> <span class="n">setup</span>
<span class="go">Activating auto-logging. Current session state plus future input saved.</span>
<span class="go">Filename       : setup</span>
<span class="go">Mode           : backup</span>
<span class="go">Output logging : False</span>
<span class="go">Timestamping   : False</span>
<span class="go">State          : active</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">F</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage:</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage:</span>
<span class="go">Exiting Sage (CPU time 0m0.61s, Wall time 0m50.39s).</span>
<span class="go">was@form:~$ sage</span>
<span class="go">┌────────────────────────────────────────────────────────────────────┐</span>
<span class="go">│ SageMath version 9.7, Release Date: 2022-01-10                     │</span>
<span class="go">│ Using Python 3.10.4. Type &quot;help()&quot; for help.                       │</span>
<span class="go">└────────────────────────────────────────────────────────────────────┘</span>

<span class="gp">sage:</span> <span class="n">load</span><span class="p">(</span><span class="s2">&quot;setup&quot;</span><span class="p">)</span>
<span class="go">Loading log file &lt;setup&gt; one line at a time...</span>
<span class="go">Finished replaying log file &lt;setup&gt;</span>
<span class="gp">sage:</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y  = x^3 - x^2 + 4*x + 3 over Rational</span>
<span class="go">Field</span>
<span class="gp">sage:</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="go">x*y</span>
<span class="gp">sage:</span> <span class="n">G</span>
<span class="go">[(2 : 3 : 1)]</span>
</pre></div>
</div>
<p>SageをLinux KDEターミナル <code class="docutils literal notranslate"><span class="pre">konsole</span></code> 上で使っているなら，以下の手順でセッションを保存することもできる．
まず <code class="docutils literal notranslate"><span class="pre">konsole</span></code> 上でSageを起動したら、 &quot;settings&quot;(日本語環境であれば『設定』)を選択し，次に &quot;history&quot;(『履歴』)， &quot;set unlimited&quot;(『無制限にする』)の順に選択しておく．
セッションを保存したくなった時点で， &quot;edit&quot;(『編集』)の中の &quot;save history as...&quot;(『履歴を名前を付けて保存』)を選択してセッションを保存するファイル名を入力してやればよい．
いったんファイルとして保存してしまえば，好きなようにxemacsなどのエディタで読み込んだりプリントアウトしたりすることができる．</p>
</section>
<section id="id3">
<h2>プロンプト記号はペースト時に無視される<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p>SageセッションあるいはPythonの演算結果を読み込んで，Sage上にコピーしたい場合がある．
厄介なのは、そうした出力に <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> や <code class="docutils literal notranslate"><span class="pre">sage:</span></code> といったプロンプト記号が紛れ込んでいることだ．
しかし実際には，プロンプト記号を含む実行例をSage上へ好きにコピー・ペーストしてやることができる．
デフォルトでSageパーサーはデータをPythonに送る前に行頭の <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> や <code class="docutils literal notranslate"><span class="pre">sage:</span></code> プロンプト記号を除去してくれるからだ．
例えば</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="mi">2</span><span class="o">^</span><span class="mi">10</span>
<span class="go">1024</span>
<span class="gp">sage:</span> <span class="n">sage</span><span class="p">:</span> <span class="n">sage</span><span class="p">:</span> <span class="mi">2</span><span class="o">^</span><span class="mi">10</span>
<span class="go">1024</span>
<span class="gp">sage:</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="o">^</span><span class="mi">10</span>
<span class="go">1024</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1024</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sage</span><span class="p">:</span> <span class="n">sage</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1024</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1024</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h2>計時コマンド<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<p>入力行の先頭に <code class="docutils literal notranslate"><span class="pre">%time</span></code> コマンドを入れておくと，出力までに要した時間を表示することができる．
例として，べき乗計算を異なった方法で行なった場合の実行時間を比較してみよう．
以下に示した実行時間の値は，動かしているコンピュータ本体やSageのバージョンによって大きく異なる可能性が高い．
まず、Pythonを直に動かしてみると:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="o">%</span><span class="k">time</span> a = int(1938)^int(99484)
<span class="go">CPU times: user 0.66 s, sys: 0.00 s, total: 0.66 s</span>
<span class="go">Wall time: 0.66</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">time</span> a = int(Integer(1938))**int(Integer(99484))
<span class="go">CPU times: user 0.66 s, sys: 0.00 s, total: 0.66 s</span>
<span class="go">Wall time: 0.66</span>
</pre></div>
</div>
</div>
</div>
<p>上の出力は，実行に計0.66秒かかり， &quot;Wall time&quot; つまりユーザーの実待ち時間もやはり0.66秒だったことを示している．
コンピュータに他のプログラムから大きな負荷がかかっている場合， &quot;Wall time&quot;がCPUタイムよりかなり長くなることがある．</p>
<p>次に，同じべき乗計算をSage組み込みのInteger型を使って実行した場合の時間を計ってみよう．
SageのInteger型は，Cython経由でGMPライブラリを使って実装されている:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="o">%</span><span class="k">time</span> a = 1938^99484
<span class="go">CPU times: user 0.04 s, sys: 0.00 s, total: 0.04 s</span>
<span class="go">Wall time: 0.04</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">time</span> a = Integer(1938)**Integer(99484)
<span class="go">CPU times: user 0.04 s, sys: 0.00 s, total: 0.04 s</span>
<span class="go">Wall time: 0.04</span>
</pre></div>
</div>
</div>
</div>
<p>PARIのC-ライブラリを経由すると</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="o">%</span><span class="k">time</span> a = pari(1938)^pari(99484)
<span class="go">CPU times: user 0.05 s, sys: 0.00 s, total: 0.05 s</span>
<span class="go">Wall time: 0.05</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">time</span> a = pari(Integer(1938))**pari(Integer(99484))
<span class="go">CPU times: user 0.05 s, sys: 0.00 s, total: 0.05 s</span>
<span class="go">Wall time: 0.05</span>
</pre></div>
</div>
</div>
</div>
<p>GMPの方が速いが，その差はわずかだ(Sage用にビルドされたPARIは整数演算にGMPを使っているのだから，納得できる結果である)．</p>
<p class="with-sage-tab with-python-tab">次の例のように， <code class="docutils literal notranslate"><span class="pre">cputime</span></code> コマンドを使えば，一連のコマンドからなるコードブロックの実行時間を計ることもできる:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">^</span><span class="nb">int</span><span class="p">(</span><span class="mi">99484</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1938</span><span class="o">^</span><span class="mi">99484</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">pari</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">^</span><span class="n">pari</span><span class="p">(</span><span class="mi">99484</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                       <span class="c1"># random 値には若干の幅がある．</span>
<span class="go">0.64</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1938</span><span class="p">))</span><span class="o">**</span><span class="nb">int</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">99484</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">99484</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">pari</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1938</span><span class="p">))</span><span class="o">**</span><span class="n">pari</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">99484</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                       <span class="c1"># random 値には若干の幅がある．</span>
<span class="go">0.64</span>
</pre></div>
</div>
</div>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> cputime<span class="o">?</span>
<span class="go"> ...</span>
<span class="go">     Return the time in CPU second since Sage started, or with optional</span>
<span class="go">     argument t, return the time since time t.</span>
<span class="go">     INPUT:</span>
<span class="go">         t -- (optional) float, time in CPU seconds</span>
<span class="go">     OUTPUT:</span>
<span class="go">         float -- time in CPU seconds</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> cputime<span class="o">?</span>
<span class="go"> ...</span>
<span class="go">     Return the time in CPU second since Sage started, or with optional</span>
<span class="go">     argument t, return the time since time t.</span>
<span class="go">     INPUT:</span>
<span class="go">         t -- (optional) float, time in CPU seconds</span>
<span class="go">     OUTPUT:</span>
<span class="go">         float -- time in CPU seconds</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">walltime</span></code> コマンドの動作は，計測するのが実経過時間である点以外は <code class="docutils literal notranslate"><span class="pre">cputime</span></code> コマンドと変わらない．</p>
<p>上で求めたべき乗を，Sageに取り込まれている各コンピュータ代数システムを使って計算することもできる．
計算を実行するには，使いたいシステムの名前をコマンド名としてそのプログラムのサーバを呼び出す．
いちばん肝心な計測値は，実経過時間(wall time)だ．
しかし，実経過時間とCPUタイムの値が大幅に食い違う場合は，解決すべきパフォーマンス上の問題点の存在を示している可能性がある．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">time</span> <span class="mi">1938</span><span class="o">^</span><span class="mi">99484</span><span class="p">;</span>
<span class="go">CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s</span>
<span class="go">Wall time: 0.01</span>
<span class="gp">sage:</span> <span class="n">gp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.04</span>
<span class="gp">sage:</span> <span class="n">maxima</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">maxima</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.30</span>
<span class="gp">sage:</span> <span class="n">kash</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">kash</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.04</span>
<span class="gp">sage:</span> <span class="n">mathematica</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">        0</span>
<span class="gp">sage:</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">mathematica</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.03</span>
<span class="gp">sage:</span> <span class="n">maple</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">maple</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.11</span>
<span class="gp">sage:</span> <span class="n">libgap</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">libgap</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;1938^99484;&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 1.02</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">time</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1938</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">99484</span><span class="p">);</span>
<span class="go">CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s</span>
<span class="go">Wall time: 0.01</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">gp</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.04</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">maxima</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">maxima</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.30</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">kash</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">kash</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.04</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">mathematica</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">        0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">mathematica</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.03</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">maple</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">maple</span><span class="p">(</span><span class="s1">&#39;1938^99484&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.11</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">libgap</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">time</span> <span class="n">g</span> <span class="o">=</span> <span class="n">libgap</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;1938^99484;&#39;</span><span class="p">)</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 1.02</span>
</pre></div>
</div>
</div>
</div>
<p>以上のテスト計算で最も遅かったのは，GAPとMaximaである(実行結果はホスト <code class="docutils literal notranslate"><span class="pre">sage.math.washington.edu</span></code> 上のもの)．
各システムとのpexpectインターフェイスにかかる負荷を考えると，上の一連の計測値を最速だったSageの値と比較するのは公平を欠く面があるかもしれない．</p>
</section>
<section id="ipython">
<h2>IPythonトリック<a class="headerlink" href="#ipython" title="Link to this heading">¶</a></h2>
<p>すでに述べたように，SageはそのフロントエンドとしてIPythonを援用しており，ユーザはIPythonのコマンドと独自機能を自由に利用することができる．
その全貌については， ご自分で <a class="reference external" href="http://ipython.scipy.org/moin/Documentation">full IPython documentation</a> を読んみてほしい．
そのかわり，ここではIPythonの「マジックコマンド」と呼ばれる，お便利なトリックをいくつか紹介させていただこう:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">%edit</span></code> (<code class="docutils literal notranslate"><span class="pre">%ed</span></code> や <code class="docutils literal notranslate"><span class="pre">ed</span></code> でもいい)を使ってエディタを起動すれば，複雑なコードの入力が楽になる．
Sageの使用前に，環境変数 <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EDITOR</span></code> に好みのエディタ名を設定しておこう(<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">EDITOR=/usr/bin/emacs</span></code> または <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">EDITOR=/usr/bin/vim</span></code> とするか， <code class="docutils literal notranslate"><span class="pre">.profile</span></code> ファイルなどで同様の設定をする)．
するとSageプロンプトで <code class="docutils literal notranslate"><span class="pre">%edit</span></code> を実行すれば設定したエディタが起動する．そのエディタで関数</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">def some_function(n):</span>
<span class="go">    return n**2 + 3*n + 2</span>
</pre></div>
</div>
<p>を定義し，保存したらエディタを終了する．
以降，このセッション中は <code class="docutils literal notranslate"><span class="pre">some_function</span></code> を利用できるようになる．
内容を編集したければSageプロンプトで <code class="docutils literal notranslate"><span class="pre">%edit</span> <span class="pre">some_function</span></code> と入力すればよい．</p>
</li>
<li><p class="with-sage-tab with-python-tab">結果出力を他の用途のために編集したければ， <code class="docutils literal notranslate"><span class="pre">%rep</span></code> を実行する．
すると直前に実行したコマンドの出力が編集できるようにSageプロンプト上に配置される．:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-sin(x)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">__tmp__</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">);</span> <span class="n">f</span> <span class="o">=</span> <span class="n">symbolic_expression</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-sin(x)</span>
</pre></div>
</div>
</div>
</div>
<p>この段階でSageプロンプトから <code class="docutils literal notranslate"><span class="pre">%rep</span></code> を実行すると，新しいSageプロンプトに続いて <code class="docutils literal notranslate"><span class="pre">-sin(x)</span></code> が現われる．
カーソルは同じ行末にある．</p>
</li>
</ul>
<p>IPythonのクイック レファレンスガイドを見たければ， <code class="docutils literal notranslate"><span class="pre">%quickref</span></code> と入力する．
執筆時点(2011年4月)ではSageはIPythonのバージョン0.9.1を採用しており， <a class="reference external" href="http://ipython.org/ipython-doc/dev/interactive/tutorial.html#magic-functions">documentation for its magic commands</a>
はオンラインで読むことができる．
マジックコマンドの，ちょっと進んだ機能群についてはIPythonの <a class="reference external" href="http://ipython.org/ipython-doc/stable/interactive/reference.html#magic-command-system">ここ</a>
で文書化されているのが見つかるはずだ．</p>
</section>
<section id="id6">
<h2>エラーと例外処理<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h2>
<p class="with-sage-tab with-python-tab">処理中に何かまずいことが起きると，Pythonはふつう『例外』(exception)を発生し，その例外を引き起こした原因を教えてくれることもある．
よくお目にかかることになるのは， <a class="reference external" href="https://docs.python.org/library/exceptions.html#NameError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NameError</span></code></a> や <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a> といった名称の例外だ(Pythonライブラリーリファレンス <a class="reference internal" href="bibliography.html#pylr" id="id7"><span>[PyLR]</span></a> に例外名の包括的なリストがある)．
実例を見てみよう:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">infinity</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">SignError: cannot multiply infinity by zero</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">infinity</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">SignError: cannot multiply infinity by zero</span>
</pre></div>
</div>
</div>
</div>
<p>何が悪いか調べるには対話型デバッガが役立つこともある．
デバッガを使うには、 <code class="docutils literal notranslate"><span class="pre">%pdb</span></code> コマンドによって作動のオン/オフをトグルする(デフォルトはオフ)．
作動後は、例外が発生するとデバッガが起動し，プロンプト <code class="docutils literal notranslate"><span class="pre">ipdb&gt;</span></code> が表示される．
このデバッガの中から，任意のローカル変数の状態を表示したり，実行スタックを上下して様子を調べることができる．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="o">%</span><span class="k">pdb</span>
<span class="go">Automatic pdb calling has been turned ON</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">infinity</span><span class="p">])</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">exceptions</span><span class="o">.</span><span class="n">TypeError</span><span class="s1">&#39;&gt;             Traceback (most recent call last)</span>
<span class="o">...</span>

<span class="n">ipdb</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">pdb</span>
<span class="go">Automatic pdb calling has been turned ON</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">infinity</span><span class="p">])</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">exceptions</span><span class="o">.</span><span class="n">TypeError</span><span class="s1">&#39;&gt;             Traceback (most recent call last)</span>
<span class="o">...</span>

<span class="n">ipdb</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<p>デバッガから実行できるコマンドの一覧を見るには， <code class="docutils literal notranslate"><span class="pre">ipdb&gt;</span></code> プロンプト上で <code class="docutils literal notranslate"><span class="pre">?</span></code> を入力する:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">ipdb&gt; ?</span>

<span class="go">Documented commands (type help &lt;topic&gt;):</span>
<span class="go">========================================</span>
<span class="go">EOF    break  commands   debug    h       l     pdef   quit    tbreak</span>
<span class="go">a      bt     condition  disable  help    list  pdoc   r       u</span>
<span class="go">alias  c      cont       down     ignore  n     pinfo  return  unalias</span>
<span class="go">args   cl     continue   enable   j       next  pp     s       up</span>
<span class="go">b      clear  d          exit     jump    p     q      step    w</span>
<span class="go">whatis where</span>

<span class="go">Miscellaneous help topics:</span>
<span class="go">==========================</span>
<span class="go">exec  pdb</span>

<span class="go">Undocumented commands:</span>
<span class="go">======================</span>
<span class="go">retval  rv</span>
</pre></div>
</div>
<p>Sageに戻るには，Ctrl-Dか <code class="docutils literal notranslate"><span class="pre">quit</span></code> を入力する．</p>
</section>
<section id="section-tabcompletion">
<span id="id8"></span><h2>コマンド入力の遡行検索とタブ補完<a class="headerlink" href="#section-tabcompletion" title="Link to this heading">¶</a></h2>
<p><em>遡行検索</em>: コマンドの冒頭部を打ち込んでから <code class="docutils literal notranslate"><span class="pre">Ctrl-p</span></code>  (または上向き矢印キー)を押すと，冒頭部が一致する過去の入力行を全て呼び出すことができる．
この機能は，Sageをいったん終了し再起動してからでも有効である．
<code class="docutils literal notranslate"><span class="pre">Ctrl-r</span></code> を入力すれば，入力ヒストリを逆方向に検索することも可能だ．
この入力行の検索と再利用機能は全て <code class="docutils literal notranslate"><span class="pre">readline</span></code>  パッケージを経由しており，ほとんどのLinux系システム上で利用できるはずだ．</p>
<p class="with-sage-tab with-python-tab">タブ補完機能を体験するため，まず3次元ベクトル空間 <span class="math notranslate nohighlight">\(V=\QQ^3\)</span> を生成しておく:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">V</span>
<span class="go">Vector space of dimension 3 over Rational Field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span>
<span class="go">Vector space of dimension 3 over Rational Field</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">次のような，もっと簡潔な記号法を使ってもよい:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>タブ補完を使えば，簡単に <span class="math notranslate nohighlight">\(V\)</span> の全メンバ関数を一覧表示することができる．
<code class="docutils literal notranslate"><span class="pre">V.</span></code> と入力し，ついで <code class="docutils literal notranslate"><span class="pre">[tab]</span></code> キーを押すだけだ:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span><span class="o">.</span><span class="p">[</span><span class="n">tab</span> <span class="n">key</span><span class="p">]</span>
<span class="go">V._VectorSpace_generic__base_field</span>
<span class="gp">...</span>
<span class="go">V.ambient_space</span>
<span class="go">V.base_field</span>
<span class="go">V.base_ring</span>
<span class="go">V.basis</span>
<span class="go">V.coordinates</span>
<span class="gp">...</span>
<span class="go">V.zero_vector</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span><span class="o">.</span><span class="p">[</span><span class="n">tab</span> <span class="n">key</span><span class="p">]</span>
<span class="go">V._VectorSpace_generic__base_field</span>
<span class="gp">...</span>
<span class="go">V.ambient_space</span>
<span class="go">V.base_field</span>
<span class="go">V.base_ring</span>
<span class="go">V.basis</span>
<span class="go">V.coordinates</span>
<span class="gp">...</span>
<span class="go">V.zero_vector</span>
</pre></div>
</div>
</div>
</div>
<p>関数名の出だし何文字かを打ってから <code class="docutils literal notranslate"><span class="pre">[tab</span> <span class="pre">キー]</span></code> を押せば，入力した文字で始まる名前の関数だけに候補を絞ることができる．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="n">tab</span> <span class="n">key</span><span class="p">]</span>
<span class="go">V.is_ambient  V.is_dense    V.is_full     V.is_sparse</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="n">tab</span> <span class="n">key</span><span class="p">]</span>
<span class="go">V.is_ambient  V.is_dense    V.is_full     V.is_sparse</span>
</pre></div>
</div>
</div>
</div>
<p>特定の関数について調べたい場合もある．
coordinates関数を例にとると，そのヘルプを表示するには <code class="docutils literal notranslate"><span class="pre">V.coordinates?</span></code> と入力すればいいし，ソースコードを見るには <code class="docutils literal notranslate"><span class="pre">V.coordinates??</span></code> を入力すればいい．
詳細については次の節で解説する．</p>
</section>
<section id="id9">
<h2>統合ヘルプシステム<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h2>
<p>Sageの特長の一つは，総合的なヘルプ機能の装備である．
関数名に続けて?を入力すると、その関数のドキュメントを表示することができる．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage:</span> V.coordinates<span class="o">?</span>
<span class="go">Type:           instancemethod</span>
<span class="go">Base Class:     &lt;class &#39;instancemethod&#39;&gt;</span>
<span class="go">String Form:    &lt;bound method FreeModule_ambient_field.coordinates of Vector</span>
<span class="go">space of dimension 3 over Rational Field&gt;</span>
<span class="go">Namespace:      Interactive</span>
<span class="go">File:           /home/was/s/local/lib/python2.4/site-packages/sage/modules/f</span>
<span class="go">ree_module.py</span>
<span class="go">Definition:     V.coordinates(self, v)</span>
<span class="go">Docstring:</span>
<span class="go">    Write v in terms of the basis for self.</span>

<span class="go">    Returns a list c such that if B is the basis for self, then</span>

<span class="go">            sum c_i B_i = v.</span>

<span class="go">    If v is not in self, raises an ArithmeticError exception.</span>

<span class="go">    EXAMPLES:</span>
<span class="go">        sage: M = FreeModule(IntegerRing(), 2); M0,M1=M.gens()</span>
<span class="go">        sage: W = M.submodule([M0 + M1, M0 - 2*M1])</span>
<span class="go">        sage: W.coordinates(2*M0-M1)</span>
<span class="go">        [2, -1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> V.coordinates<span class="o">?</span>
<span class="go">Type:           instancemethod</span>
<span class="go">Base Class:     &lt;class &#39;instancemethod&#39;&gt;</span>
<span class="go">String Form:    &lt;bound method FreeModule_ambient_field.coordinates of Vector</span>
<span class="go">space of dimension 3 over Rational Field&gt;</span>
<span class="go">Namespace:      Interactive</span>
<span class="go">File:           /home/was/s/local/lib/python2.4/site-packages/sage/modules/f</span>
<span class="go">ree_module.py</span>
<span class="go">Definition:     V.coordinates(self, v)</span>
<span class="go">Docstring:</span>
<span class="go">    Write v in terms of the basis for self.</span>

<span class="go">    Returns a list c such that if B is the basis for self, then</span>

<span class="go">            sum c_i B_i = v.</span>

<span class="go">    If v is not in self, raises an ArithmeticError exception.</span>

<span class="go">    EXAMPLES:</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">FreeModule</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">M0</span><span class="p">,</span><span class="n">M1</span><span class="o">=</span><span class="n">M</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">W</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">submodule</span><span class="p">([</span><span class="n">M0</span> <span class="o">+</span> <span class="n">M1</span><span class="p">,</span> <span class="n">M0</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">M1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">W</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">M0</span><span class="o">-</span><span class="n">M1</span><span class="p">)</span>
<span class="go">        [2, -1]</span>
</pre></div>
</div>
</div>
</div>
<p>上で見たように，ヘルプ表示には，そのオブジェクトの型，定義されているファイル，現セッションにペーストすることができる使用例付きの解説が含まれる．
使用例のほとんどは常に自動的なテストが行なわれていて，仕様どおりの正確な動作が確認されている．</p>
<p>もう一つの機能は，Sageのオープンソース精神をよく表すものだ．
<code class="docutils literal notranslate"><span class="pre">f</span></code> がPythonで書かれた関数であれば <code class="docutils literal notranslate"><span class="pre">f??</span></code> と入力すると <code class="docutils literal notranslate"><span class="pre">f</span></code> を定義しているソースを表示することができるのだ．
例えば</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage:</span> V.coordinates<span class="o">??</span>
<span class="go">Type:           instancemethod</span>
<span class="gp">...</span>
<span class="go">Source:</span>
<span class="go">def coordinates(self, v):</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">        Write $v$ in terms of the basis for self.</span>
<span class="go">        ...</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">        return self.coordinate_vector(v).list()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> V.coordinates<span class="o">??</span>
<span class="go">Type:           instancemethod</span>
<span class="gp">...</span>
<span class="go">Source:</span>
<span class="go">def coordinates(self, v):</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">        Write $v$ in terms of the basis for self.</span>
<span class="go">        ...</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">        return self.coordinate_vector(v).list()</span>
</pre></div>
</div>
</div>
</div>
<p>これを見ると， <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> 関数は <code class="docutils literal notranslate"><span class="pre">coordinate_vector</span></code> 関数を呼び出して結果をリストに変換しているだけであることが判る．
では <code class="docutils literal notranslate"><span class="pre">coordinate_vector</span></code> 関数が何をしているかと言うと:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage:</span> V.coordinate_vector<span class="o">??</span>
<span class="gp">...</span>
<span class="go">def coordinate_vector(self, v):</span>
<span class="go">        ...</span>
<span class="go">        return self.ambient_vector_space()(v)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> V.coordinate_vector<span class="o">??</span>
<span class="gp">...</span>
<span class="go">def coordinate_vector(self, v):</span>
<span class="go">        ...</span>
<span class="go">        return self.ambient_vector_space()(v)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">coordinate_vector</span></code> 関数は，入力を生成空間(ambient space)に合わせて型変換するから，これは <span class="math notranslate nohighlight">\(v\)</span> の係数ベクトルが空間 <span class="math notranslate nohighlight">\(V\)</span> ではどう変換されるか計算していることと同じである．
<span class="math notranslate nohighlight">\(V\)</span> は <span class="math notranslate nohighlight">\(\QQ^3\)</span> そのものだから，すでに同じ構造になっている．
部分空間用に，上とは異なる <code class="docutils literal notranslate"><span class="pre">coordinate_vector</span></code> 関数も用意されている．
部分空間を作って，どんな関数か見てみることにしよう:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span><span class="p">;</span> <span class="n">W</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">span_of_basis</span><span class="p">([</span><span class="n">V</span><span class="mf">.0</span><span class="p">,</span> <span class="n">V</span><span class="mf">.1</span><span class="p">])</span>
<span class="gp">sage:</span> W.coordinate_vector<span class="o">??</span>
<span class="gp">...</span>
<span class="go">def coordinate_vector(self, v):</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">         ...</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">        # First find the coordinates of v wrt echelon basis.</span>
<span class="go">        w = self.echelon_coordinate_vector(v)</span>
<span class="go">        # Next use transformation matrix from echelon basis to</span>
<span class="go">        # user basis.</span>
<span class="go">        T = self.echelon_to_user_matrix()</span>
<span class="go">        return T.linear_combination_of_rows(w)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">W</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">span_of_basis</span><span class="p">([</span><span class="n">V</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">V</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> W.coordinate_vector<span class="o">??</span>
<span class="gp">...</span>
<span class="go">def coordinate_vector(self, v):</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">         ...</span>
<span class="go">        &quot;&quot;&quot;</span>
<span class="go">        # First find the coordinates of v wrt echelon basis.</span>
<span class="go">        w = self.echelon_coordinate_vector(v)</span>
<span class="go">        # Next use transformation matrix from echelon basis to</span>
<span class="go">        # user basis.</span>
<span class="go">        T = self.echelon_to_user_matrix()</span>
<span class="go">        return T.linear_combination_of_rows(w)</span>
</pre></div>
</div>
</div>
</div>
<p>(こうした実装の仕方は無駄が多いと思われる方は，どうか我々に連絡して線形代数周りの最適化に力を貸していただきたい．)</p>
<p><code class="docutils literal notranslate"><span class="pre">help(コマンド名)</span></code> あるいは <code class="docutils literal notranslate"><span class="pre">help(クラス名)</span></code> と入力すれば，知りた いクラスのmanページ型ヘルプファイルを表示することもできる．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">help</span><span class="p">(</span><span class="n">VectorSpace</span><span class="p">)</span>
<span class="go">Help on function VectorSpace in module sage.modules.free_module:</span>

<span class="go">VectorSpace(K, dimension_or_basis_keys=None, sparse=False, inner_product_matrix=None, *,</span>
<span class="go">            with_basis=&#39;standard&#39;, dimension=None, basis_keys=None, **args)</span>
<span class="go">EXAMPLES:</span>

<span class="go">The base can be complicated, as long as it is a field.</span>

<span class="go">::</span>

<span class="go">    sage: V = VectorSpace(FractionField(PolynomialRing(ZZ,&#39;x&#39;)),3)</span>
<span class="go">    sage: V</span>
<span class="go">    Vector space of dimension 3 over Fraction Field of Univariate Polynomial Ring in x</span>
<span class="go">     over Integer Ring</span>
<span class="go">    sage: V.basis()</span>
<span class="go">    [</span>
<span class="go">    (1, 0, 0),</span>
<span class="go">    (0, 1, 0),</span>
<span class="go">--More--</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">VectorSpace</span><span class="p">)</span>
<span class="go">Help on function VectorSpace in module sage.modules.free_module:</span>

<span class="go">VectorSpace(K, dimension_or_basis_keys=None, sparse=False, inner_product_matrix=None, *,</span>
<span class="go">            with_basis=&#39;standard&#39;, dimension=None, basis_keys=None, **args)</span>
<span class="go">EXAMPLES:</span>

<span class="go">The base can be complicated, as long as it is a field.</span>

<span class="go">::</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span>
<span class="go">    Vector space of dimension 3 over Fraction Field of Univariate Polynomial Ring in x</span>
<span class="go">     over Integer Ring</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">    [</span>
<span class="go">    (1, 0, 0),</span>
<span class="go">    (0, 1, 0),</span>
<span class="go">--More--</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">q</span></code> と入力してヘルプを終えると，中断前のセッション画面がそのまま復帰する．
セッションに干渉することがある <code class="docutils literal notranslate"><span class="pre">function_name?</span></code> と違って， ヘルプ表示はセッションの邪魔をしない．
とりわけ便利なのは  <code class="docutils literal notranslate"><span class="pre">help(モジュール名)</span></code> と入力することだ．
例えばベクトル空間は  <code class="docutils literal notranslate"><span class="pre">sage.modules.free_module</span></code> で定義されているから，そのモジュール全体に関するドキュメントを見たければ <code class="docutils literal notranslate"><span class="pre">help(sage.modules.free_module)</span></code> と実行すればよい．
ヘルプを使ってドキュメントを閲覧している間は， <code class="docutils literal notranslate"><span class="pre">/</span></code> と打てば語句検索 ができるし， <code class="docutils literal notranslate"><span class="pre">?</span></code> と打てば逆方向に検索することができる．</p>
</section>
<section id="id10">
<h2>オブジェクトの保存と読み込み<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h2>
<p>行列や，あるいはもっと手間のかかる複雑なモジュラーシンボルの空間を扱っていて，後で利用するため結果を保存しておきたくなったとしよう．
そんな場合にはどうすればよいだろうか．
オブジェクトを保存するために各コンピュータ代数システムが提供している方法は，以下の通りである．</p>
<ol class="arabic simple">
<li><p><strong>セッションの保存:</strong> セッション全体の保存と読み込みのみ可能(GAP，Magmaなど)．</p></li>
<li><p><strong>統合入出力:</strong> 全オブジェクトの印字が再利用可能な形式で行なわれる(GAPとPARI)．</p></li>
<li><p><strong>再実行</strong>: インタープリタによるプログラムの再実行が容易にしてある(Singular，PARI)．</p></li>
</ol>
<p>Pythonで動くSageでは，全てのオブジェクトのシリアル化(直列化)という，他とは異なる方法が採用されている．
つまりオブジェクトを，その原型を再現可能な形式で文字列に変換するのだ．
これはPARIの統合入出力の考え方に近いが，オブジェクトを複雑な印字形式で画面出力してやる必要がないのが利点だ．
さらに保存と読み込みは(ほとんどの場合)完全に自動化されているから，新たにプログラムを書く必要もない．
そうした機能はPythonに最初から組込まれているものだからである．</p>
<p>ほぼ全てのSageオブジェクト <code class="docutils literal notranslate"><span class="pre">x</span></code> は， コマンド <code class="docutils literal notranslate"><span class="pre">save(x,ファイル名)</span></code> (あるいは多くの場合 <code class="docutils literal notranslate"><span class="pre">x.save(ファイル名)</span></code>)を使えば圧縮形式でディスクに保存することができるようになっている．
保存したオブジェクトを読み戻すには， <code class="docutils literal notranslate"><span class="pre">load(ファイル名)</span></code> を実行する．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--25-input--1" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage:</span> <span class="n">A</span>
<span class="go">[ 15  18  21]</span>
<span class="go">[ 42  54  66]</span>
<span class="go">[ 69  90 111]</span>
<span class="gp">sage:</span> <span class="n">save</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--25-input--2" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span>
<span class="go">[ 15  18  21]</span>
<span class="go">[ 42  54  66]</span>
<span class="go">[ 69  90 111]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">save</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>ここでいったんSageを終了してみよう．再起動後に <code class="docutils literal notranslate"><span class="pre">A</span></code>  を読み込むには:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--26-input--1" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span>
<span class="go">[ 15  18  21]</span>
<span class="go">[ 42  54  66]</span>
<span class="go">[ 69  90 111]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--26-input--2" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span>
<span class="go">[ 15  18  21]</span>
<span class="go">[ 42  54  66]</span>
<span class="go">[ 69  90 111]</span>
</pre></div>
</div>
</div>
</div>
<p>楕円曲線のようなもっと複雑なオブジェクトに対しても，以上と同じやり方が通用する．
メモリ上に配置されていたオブジェクト関連の全データは，そのオブジェクトと共に保存される．
例えば</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--27-input--1" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">anlist</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>              <span class="c1"># ちょっと時間がかかる</span>
<span class="gp">sage:</span> <span class="n">save</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">quit</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--27-input--2" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">anlist</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100000</span><span class="p">))</span>              <span class="c1"># ちょっと時間がかかる</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">save</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">quit</span>
</pre></div>
</div>
</div>
</div>
<p>こうして保存された <code class="docutils literal notranslate"><span class="pre">E</span></code> は，オブジェクト本体と一緒に <span class="math notranslate nohighlight">\(a_n\)</span> の冒頭100000個も保存するため，153Kバイトの大きさになる．</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">~/tmp$ ls -l E.sobj</span>
<span class="go">-rw-r--r--  1 was was 153500 2006-01-28 19:23 E.sobj</span>
<span class="go">~/tmp$ sage [...]</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">anlist</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>              <span class="c1"># すぐ終了</span>
</pre></div>
</div>
<p>(Python経由の保存と読み込みには， <code class="docutils literal notranslate"><span class="pre">cPickle</span></code> モジュールが使われている．
実際，Sageオブジェクト <code class="docutils literal notranslate"><span class="pre">x</span></code> の保存は <code class="docutils literal notranslate"><span class="pre">cPickle.dumps(x,</span> <span class="pre">2)</span></code> を実行して行なうことができる．引数 <code class="docutils literal notranslate"><span class="pre">2</span></code> に注目．)</p>
<p>Sageで保存・読み込みできないのは，GAP， Singular， Maximaなど外部コンピュータ代数システムで作成されたオブジェクトである．
これらは読み込むことができても &quot;invalid&quot;(利用不能)な状態にあると認識される．
GAPでは，相当数のオブジェクトが再構成に使える印字形式を持つ一方，再構成できな場合も多いため印字形式からのオブジェクトの再構成は意図的に禁止されている．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--28-input--1" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">libgap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: The session in which this object was defined is no longer</span>
<span class="go">running.</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--28-input--2" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">libgap</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: The session in which this object was defined is no longer</span>
<span class="go">running.</span>
</pre></div>
</div>
</div>
</div>
<p>GP/PARIオブジェクトは，印字形式から十分に再構成可能なため，保存と読み込みも可能になっている．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--29-input--1" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--29-input--2" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">gp</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
</div>
<p>保存したオブジェクトは，異なるアーキテクチャ上の，異なるオペレーティングシステムで動くSageへもロードすることができる．
例えば，32ビット OSX上で保存した大規模行列を64ビット版LinuxのSageへ読み込み，その階段形式を求めてから元のOS X上へ戻すといったことも可能だ．
さらに，オブジェクトの保存までに使ったのとは違うバージョンのSageでオブジェクトを読み込むこともできる場合が多い．
ただし，これは読み書きしたいオブジェクトに関わるコードがバージョン間で大きくは異ならないことが条件となる．
オブジェクトの保存に際しては，その属性の全てがオブジェクトを定義している(ソースコードではなく)クラスと共に保存される．
そのクラスが新バージョンのSageに存在しない場合，配下のオブジェクトを新バージョンでは読み込むことはできない．
しかし古いバージョンで読み込むことはできるはずだから，(<code class="docutils literal notranslate"><span class="pre">x.__dict__</span></code> で)オブジェクト <code class="docutils literal notranslate"><span class="pre">x</span></code> のディクショナリを生成して保存しておけば，それを新しいバージョンで読み込むことができることもある．</p>
<section id="id11">
<h3>テキスト形式で保存する<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<p>オブジェクトをASCIIテキスト形式で保存しておくこともできる．
手順は，ファイルを書込みモードで開いて，そこに保存すべきオブジェクトの文字列表現を書き込むだけのことだ(このやり方で複数個のオブジェクトを保存することができる)．
オブジェクトの書込みを終えたら，ファイルをクローズすればよい．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--30-input--1" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span>
<span class="gp">sage:</span> <span class="n">o</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">o</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">o</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--30-input--2" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,)</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="section-save">
<span id="id12"></span><h2>セッション全体の保存と読み込み<a class="headerlink" href="#section-save" title="Link to this heading">¶</a></h2>
<p>Sageは，セッション全体を保存し再ロードするための非常に柔軟な機能を備えている．</p>
<p>コマンド <code class="docutils literal notranslate"><span class="pre">save_session(セッション名)</span></code> は，現セッション中に定義された全ての変数を、コマンドで指定した <code class="docutils literal notranslate"><span class="pre">セッション名</span></code> にディクショナリとして保存する．
(保存を想定していない変数がある場合もまれに見られるが，そうした時はディクショナリに保存されずに終るだけだ．)
保存先は <code class="docutils literal notranslate"><span class="pre">.sobj</span></code> ファイルとなり，他の保存済みオブジェクトと全く同じように読み込むことができる．
セッション中に保存したオブジェクトを再びロードすると，変数名をキー，オブジェクトを値とするディクショナリが生成されることになる．</p>
<p>実行中のセッションに <code class="docutils literal notranslate"><span class="pre">セッション名</span></code> に定義された変数をロードするには， <code class="docutils literal notranslate"><span class="pre">load_session(セッション名)</span></code> コマンドを使う．
このコマンドは現セッションとロードされる側のセッション内容を合併するのであって，現セッションで定義した変数が消去されるわけではない．</p>
<p>まずSageを起動し，変数をいくつか定義しておく．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--31-input--1" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">389</span>
<span class="gp">sage:</span> <span class="n">t</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2003</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">t</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go"> _4 = (x - 2004) * (x - 12)^2 * (x + 54)^2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--31-input--2" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2003</span><span class="p">))</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">t</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go"> _4 = (x - 2004) * (x - 12)^2 * (x + 54)^2</span>
</pre></div>
</div>
</div>
</div>
<p>次にこのセッションをファイルに保存し，先に定義した変数を残しておく．
<code class="docutils literal notranslate"><span class="pre">.sobj</span></code> ファイルを確認すると，その大きさは3Kバイトほどとなっている．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--32-input--1" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">save_session</span><span class="p">(</span><span class="s1">&#39;misc&#39;</span><span class="p">)</span>
<span class="go">Saving a</span>
<span class="go">Saving M</span>
<span class="go">Saving t</span>
<span class="go">Saving E</span>
<span class="gp">sage:</span> <span class="n">quit</span>
<span class="go">was@form:~/tmp$ ls -l misc.sobj</span>
<span class="go">-rw-r--r--  1 was was 2979 2006-01-28 19:47 misc.sobj</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--32-input--2" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">save_session</span><span class="p">(</span><span class="s1">&#39;misc&#39;</span><span class="p">)</span>
<span class="go">Saving a</span>
<span class="go">Saving M</span>
<span class="go">Saving t</span>
<span class="go">Saving E</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">quit</span>
<span class="go">was@form:~/tmp$ ls -l misc.sobj</span>
<span class="go">-rw-r--r--  1 was was 2979 2006-01-28 19:47 misc.sobj</span>
</pre></div>
</div>
</div>
</div>
<p>仕上げにSageを再起動し，変数をいくつか追加定義してから，先に保存したセッションを読み込んでみよう．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--33-input--1" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">19</span>
<span class="gp">sage:</span> <span class="n">load_session</span><span class="p">(</span><span class="s1">&#39;misc&#39;</span><span class="p">)</span>
<span class="go">Loading a</span>
<span class="go">Loading M</span>
<span class="go">Loading E</span>
<span class="go">Loading t</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--33-input--2" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">load_session</span><span class="p">(</span><span class="s1">&#39;misc&#39;</span><span class="p">)</span>
<span class="go">Loading a</span>
<span class="go">Loading M</span>
<span class="go">Loading E</span>
<span class="go">Loading t</span>
</pre></div>
</div>
</div>
</div>
<p>保存しておいた変数が再び利用可能になる一方，上で追加した変数 <code class="docutils literal notranslate"><span class="pre">b</span></code> は上書きされていないことが分る．</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--34-input--1" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span>
<span class="go">Full Modular Symbols space for Gamma_0(37) of weight 2 with sign 0</span>
<span class="go">and dimension 5 over Rational Field</span>
<span class="gp">sage:</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational</span>
<span class="go">Field</span>
<span class="gp">sage:</span> <span class="n">b</span>
<span class="go">19</span>
<span class="gp">sage:</span> <span class="n">a</span>
<span class="go">389</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--34-input--2" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span>
<span class="go">Full Modular Symbols space for Gamma_0(37) of weight 2 with sign 0</span>
<span class="go">and dimension 5 over Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational</span>
<span class="go">Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span>
<span class="go">19</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="go">389</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="interfaces.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">インターフェイスについて</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="tour_advanced.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">より進んだ数学</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2025, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">対話型シェル</a><ul>
<li><a class="reference internal" href="#sage">Sageセッション</a></li>
<li><a class="reference internal" href="#id2">入出力のログをとる</a></li>
<li><a class="reference internal" href="#id3">プロンプト記号はペースト時に無視される</a></li>
<li><a class="reference internal" href="#id4">計時コマンド</a></li>
<li><a class="reference internal" href="#ipython">IPythonトリック</a></li>
<li><a class="reference internal" href="#id6">エラーと例外処理</a></li>
<li><a class="reference internal" href="#section-tabcompletion">コマンド入力の遡行検索とタブ補完</a></li>
<li><a class="reference internal" href="#id9">統合ヘルプシステム</a></li>
<li><a class="reference internal" href="#id10">オブジェクトの保存と読み込み</a><ul>
<li><a class="reference internal" href="#id11">テキスト形式で保存する</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-save">セッション全体の保存と読み込み</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=c64d86ae"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=8e571dd6"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/translations.js?v=4755f45a"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "im": "\\mathop{\\operatorname{im}}", "rank": "\\mathop{\\operatorname{rank}}", "PP": "\\Bold{P}", "OO": "\\mathcal{O}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="_static/jupyter-sphinx-furo.js?v=77915cdd"></script>
    </body>
</html>