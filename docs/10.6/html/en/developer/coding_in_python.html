<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Coding in Cython" href="coding_in_cython.html" /><link rel="prev" title="The Sage Manuals" href="sage_manuals.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Coding in Python for Sage - Developer Guide</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom-furo.css?v=d2ecc25a" />
    <link rel="stylesheet" type="text/css" href="_static/custom-jupyter-sphinx.css?v=75860c6b" />
    <link rel="stylesheet" type="text/css" href="_static/custom-codemirror-monokai.css?v=b5588f12" />
    <link rel="stylesheet" type="text/css" href="_static/custom-tabs.css?v=8a724d73" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Developer Guide</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">passagemath 10.6.2 Documentation</span>
  
</a><div class="select-wrapper">
  <select id="versions-menu" onchange="changeVersion()">
    <option value="" selected>other version</option>
    <option value="https://passagemath.org/docs/10.6">passagemath-10.6.x</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="index.html">Home - Developer Guide</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="walkthrough.html">Development Walk-through</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_setup.html">Setting Up Git</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="github.html">The passagemath Repository on GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Using Git with GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html">Reviewing Code</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="git_basic.html">Git Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_advanced.html">Advanced Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_background.html">Git Tips and References</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workspace.html">Setting up Your Workspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_basics.html">General Conventions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="doctesting.html">Running Sage’s Doctests</a></li>
<li class="toctree-l1"><a class="reference internal" href="portability_testing.html">Testing on Multiple Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Development and Testing Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sage_manuals.html">The Sage Manuals</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Coding in Python for Sage</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_in_cython.html">Coding in Cython</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_in_other.html">Using External Libraries and Interfaces</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="packaging.html">Packaging Third-Party Code for Sage</a></li>
<li class="toctree-l1"><a class="reference internal" href="downstream.html">Packaging the Sage Library for Monolithic Distribution (ignore)</a></li>
<li class="toctree-l1"><a class="reference internal" href="packaging_sage_library.html">Packaging the Sage Library for Modularized Distribution in passagemath</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/blob/develop/src/doc/en/developer/coding_in_python.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/edit/develop/src/doc/en/developer/coding_in_python.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="coding-in-python-for-sage">
<span id="chapter-python"></span><h1>Coding in Python for Sage<a class="headerlink" href="#coding-in-python-for-sage" title="Link to this heading">¶</a></h1>
<p>This chapter discusses some issues with, and advice for, coding in
Sage.</p>
<section id="python-language-standard">
<span id="section-python-language-standard"></span><h2>Python language standard<a class="headerlink" href="#python-language-standard" title="Link to this heading">¶</a></h2>
<p>Sage library code needs to be compatible with all versions of Python
that Sage supports.  The information regarding the supported versions
can be found in the files <a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/build/pkgs/python3/spkg-configure.m4">SAGE_ROOT/build/pkgs/python3/spkg-configure.m4</a>
(for the Sage distribution), <a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/pyproject.toml">SAGE_ROOT/src/pyproject.toml</a> (for the Sage
library), and <a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/m4/pyproject_toml_metadata.m4">SAGE_ROOT/m4/pyproject_toml_metadata.m4</a> (for most other
distribution packages in <code class="docutils literal notranslate"><span class="pre">pkgs/</span></code>).</p>
<p>Python 3.10 is the oldest supported version.  Hence,
all language and library features that are available in Python 3.10 can
be used; but features introduced in Python 3.11 cannot be used.  If a
feature is deprecated in a newer supported version, it must be ensured
that deprecation warnings issued by Python do not lead to failures in
doctests.</p>
<p>Some key language and library features have been backported to older Python versions
using one of two mechanisms:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code> (see Python reference for
<a class="reference external" href="https://docs.python.org/3/library/__future__.html">__future__</a>)
modernizes type annotations according to <a class="reference external" href="https://www.python.org/dev/peps/pep-0563">PEP 563</a> (Postponed evaluation
of annotations).  All Sage library code that uses type annotations
should include this <code class="docutils literal notranslate"><span class="pre">__future__</span></code> import and follow PEP 563.</p></li>
<li><p>Backport packages</p>
<ul class="simple">
<li><p><a class="reference external" href="../reference/spkg/importlib_metadata">importlib_metadata</a>
(to be used in place of <code class="docutils literal notranslate"><span class="pre">importlib.metadata</span></code> when Python older
than 3.13 is in use if you need a newer feature),</p></li>
<li><p><a class="reference external" href="../reference/spkg/importlib_resources">importlib_resources</a>
(to be used in place of <code class="docutils literal notranslate"><span class="pre">importlib.resources</span></code> when Python older than
3.13 is in use if you need a newer feature),</p></li>
<li><p><a class="reference external" href="../reference/spkg/typing_extensions">typing_extensions</a>
(to be used in place of <code class="docutils literal notranslate"><span class="pre">typing</span></code> when Python older than
3.13 is in use and any of the features introduced after Python
3.10.0 are used).</p></li>
</ul>
<p>The Sage library declares these backport packages as conditional
dependencies for use with Python older than 3.13 and ensures that
versions of the packages that provide features of Python 3.13
are available.</p>
<p>The backport packages should not be imported unconditionally.
For example, on Linux distributions that only ship newer versions
of Python, the backport packages may not be available as
system packages. Hence, if there is a need to use the backport
packages, they should be imported like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
    <span class="c1"># Use backport package providing Python 3.13 features</span>
    <span class="kn">from</span> <span class="nn">importlib_resources</span> <span class="kn">import</span> <span class="n">files</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">importlib.resources</span> <span class="kn">import</span> <span class="n">files</span>
</pre></div>
</div>
</li>
</ul>
<p>Meta <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/29756">upstream Issue #29756</a> keeps track of newer Python features and serves
as a starting point for discussions on how to make use of them in the
Sage library.</p>
</section>
<section id="design">
<h2>Design<a class="headerlink" href="#design" title="Link to this heading">¶</a></h2>
<p>If you are planning to develop some new code for Sage, design is
important. So think about what your program will do and how that fits
into the structure of Sage. In particular, much of Sage is implemented
in the object-oriented language Python, and there is a hierarchy of
classes that organize code and functionality. For example, if you
implement elements of a ring, your class should derive from
<a class="reference external" href="../reference/structure/sage/structure/element.html#sage.structure.element.RingElement" title="(in Parents and Elements v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.RingElement</span></code></a>, rather than starting from
scratch. Try to figure out how your code should fit in with other Sage
code, and design it accordingly.</p>
</section>
<section id="special-sage-functions">
<h2>Special Sage functions<a class="headerlink" href="#special-sage-functions" title="Link to this heading">¶</a></h2>
<p>Functions with leading and trailing double underscores <code class="xref py py-meth docutils literal notranslate"><span class="pre">__XXX__()</span></code> are
all predefined by Python. Functions with leading and trailing single
underscores <code class="xref py py-meth docutils literal notranslate"><span class="pre">_XXX_()</span></code> are defined for Sage. Functions with a single
leading underscore are meant to be semi-private, and those with a
double leading underscore are considered really private. Users can
create functions with leading and trailing underscores.</p>
<p>Just as Python has many standard special methods for objects, Sage
also has special methods. They are typically of the form <code class="xref py py-meth docutils literal notranslate"><span class="pre">_XXX_()</span></code>.
In a few cases, the trailing underscore is not included, but this will
eventually be changed so that the trailing underscore is always
included. This section describes these special methods.</p>
<p>All objects in Sage should derive from the Cython extension class
<a class="reference external" href="../reference/structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.structure.sage_object</span> <span class="kn">import</span> <span class="n">SageObject</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">SageObject</span><span class="p">,</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>or from some other already existing Sage class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.structure.parent</span> <span class="kn">import</span> <span class="n">Parent</span>

<span class="k">class</span> <span class="nc">MyFavoriteAlgebra</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>You should implement the <code class="xref py py-meth docutils literal notranslate"><span class="pre">_latex_()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">_repr_()</span></code> method for every
object. The other methods depend on the nature of the object.</p>
</section>
<section id="latex-representation">
<h2>LaTeX representation<a class="headerlink" href="#latex-representation" title="Link to this heading">¶</a></h2>
<p>Every object <code class="docutils literal notranslate"><span class="pre">x</span></code> in Sage should support the command <code class="docutils literal notranslate"><span class="pre">latex(x)</span></code>, so
that any Sage object can be easily and accurately displayed via
LaTeX. Here is how to make a class (and therefore its instances)
support the command <a class="reference external" href="../reference/misc/sage/misc/latex.html#sage.misc.latex.latex" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">latex()</span></code></a>.</p>
<ol class="arabic simple">
<li><p>Define a method <code class="docutils literal notranslate"><span class="pre">_latex_(self)</span></code> that returns a LaTeX
representation of your object. It should be something that can be
typeset correctly within math mode. Do not include opening and
closing $’s.</p></li>
<li><p>Often objects are built up out of other Sage objects, and these
components should be typeset using <a class="reference external" href="../reference/misc/sage/misc/latex.html#sage.misc.latex.latex" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">latex()</span></code></a> function. For
example, if <code class="docutils literal notranslate"><span class="pre">c</span></code> is a coefficient of your object, and you want to
typeset <code class="docutils literal notranslate"><span class="pre">c</span></code> using LaTeX, use <code class="docutils literal notranslate"><span class="pre">latex(c)</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">c._latex_()</span></code>, since <code class="docutils literal notranslate"><span class="pre">c</span></code> might not have a <code class="xref py py-meth docutils literal notranslate"><span class="pre">_latex_()</span></code> method,
and <code class="docutils literal notranslate"><span class="pre">latex(c)</span></code> knows how to deal with this.</p></li>
<li><p>Do not forget to include a docstring and an example that
illustrates LaTeX generation for your object.</p></li>
<li><p>You can use any macros included in <code class="docutils literal notranslate"><span class="pre">amsmath</span></code>, <code class="docutils literal notranslate"><span class="pre">amssymb</span></code>, or
<code class="docutils literal notranslate"><span class="pre">amsfonts</span></code>, or the ones defined in <a class="reference external" href="../reference/misc/sage/misc/latex_macros.html#module-sage.misc.latex_macros" title="(in Reference Manual v10.6.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.latex_macros</span></code></a>.</p></li>
</ol>
<p>An example template for a <code class="xref py py-meth docutils literal notranslate"><span class="pre">_latex_()</span></code> method follows. Note that the
<code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">skip</span></code> line should not be included in your code; it is here to
prevent doctests from running on this fake example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">X</span><span class="p">:</span>
   <span class="o">...</span>
   <span class="k">def</span> <span class="nf">_latex_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">       </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Return the LaTeX representation of X.</span>

<span class="sd">       EXAMPLES::</span>

<span class="sd">           sage: a = X(1,2)</span>
<span class="sd">           sage: latex(a)</span>
<span class="sd">           &#39;\\frac{1}{2}&#39;</span>
<span class="sd">       &quot;&quot;&quot;</span>
       <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">frac{</span><span class="si">%s</span><span class="s1">}{</span><span class="si">%s</span><span class="s1">}&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numer</span><span class="p">),</span> <span class="n">latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">denom</span><span class="p">))</span>
</pre></div>
</div>
<p>As shown in the example, <code class="docutils literal notranslate"><span class="pre">latex(a)</span></code> will produce LaTeX code
representing the object <code class="docutils literal notranslate"><span class="pre">a</span></code>. Calling <code class="docutils literal notranslate"><span class="pre">view(a)</span></code> will display the
typeset version of this.</p>
</section>
<section id="print-representation">
<h2>Print representation<a class="headerlink" href="#print-representation" title="Link to this heading">¶</a></h2>
<p>The standard Python printing method is <code class="docutils literal notranslate"><span class="pre">__repr__(self)</span></code>. In Sage,
that is for objects that derive from <a class="reference external" href="../reference/structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a> (which is
everything in Sage), instead define <code class="docutils literal notranslate"><span class="pre">_repr_(self)</span></code>. This is
preferable because if you only define <code class="docutils literal notranslate"><span class="pre">_repr_(self)</span></code> and not
<code class="docutils literal notranslate"><span class="pre">__repr__(self)</span></code>, then users can rename your object to print however
they like. Also, some objects should print differently depending on
the context.</p>
<p>Here is an example of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">_latex_()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">_repr_()</span></code> methods for the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Pi</span></code> class. It is from the file
<a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/sage/symbolic/constants.py">SAGE_ROOT/src/sage/symbolic/constants.py</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Pi</span><span class="p">(</span><span class="n">Constant</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ratio of a circle&#39;s circumference to its diameter.</span>

<span class="sd">    EXAMPLES::</span>

<span class="sd">        sage: pi</span>
<span class="sd">        pi</span>
<span class="sd">        sage: float(pi) # rel tol 1e-10</span>
<span class="sd">        3.1415926535897931</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">_repr_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;pi&quot;</span>

    <span class="k">def</span> <span class="nf">_latex_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">pi&quot;</span>
</pre></div>
</div>
</section>
<section id="matrix-or-vector-from-object">
<h2>Matrix or vector from object<a class="headerlink" href="#matrix-or-vector-from-object" title="Link to this heading">¶</a></h2>
<p>Provide a <code class="xref py py-meth docutils literal notranslate"><span class="pre">_matrix_()</span></code> method for an object that can be coerced to a
matrix over a ring <span class="math notranslate nohighlight">\(R\)</span>. Then the Sage function <a class="reference external" href="../reference/matrices/sage/matrix/constructor.html#sage.matrix.constructor.matrix" title="(in Matrices and Spaces of Matrices v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix()</span></code></a> will work
for this object.</p>
<p>The following is from
<a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/sage/graphs/generic_graph.py">SAGE_ROOT/src/sage/graphs/generic_graph.py</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GenericGraph</span><span class="p">(</span><span class="n">SageObject</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">_matrix_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">am</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">adjacency_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_first</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Similarly, provide a <code class="xref py py-meth docutils literal notranslate"><span class="pre">_vector_()</span></code> method for an object that can be
coerced to a vector over a ring <span class="math notranslate nohighlight">\(R\)</span>. Then the Sage function <a class="reference external" href="../reference/modules/sage/modules/free_module_element.html#sage.modules.free_module_element.vector" title="(in Modules v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">vector()</span></code></a>
will work for this object. The following is from the file
<a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/sage/modules/free_module_element.pyx">SAGE_ROOT/src/sage/modules/free_module_element.pyx</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cdef</span> <span class="k">class</span> <span class="nc">FreeModuleElement</span><span class="p">(</span><span class="n">element_Vector</span><span class="p">):</span>   <span class="c1"># abstract base class</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">_vector_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sage-preparsing">
<span id="section-preparsing"></span><h2>Sage preparsing<a class="headerlink" href="#sage-preparsing" title="Link to this heading">¶</a></h2>
<p>To make Python even more usable interactively, there are a number of
tweaks to the syntax made when you use Sage from the commandline or
via the notebook (but not for Python code in the Sage
library). Technically, this is implemented by a <a class="reference external" href="../reference/repl/sage/repl/preparse.html#sage.repl.preparse.preparse" title="(in The Sage Command Line v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">preparse()</span></code></a>
function that rewrites the input string. Most notably, the following
replacements are made:</p>
<ul>
<li><p class="with-sage-tab with-python-tab">Sage supports a special syntax for generating rings or, more
generally, parents with named generators:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage:</span> <span class="n">preparse</span><span class="p">(</span><span class="s1">&#39;R.&lt;x,y&gt; = QQ[]&#39;</span><span class="p">)</span>
<span class="go">&quot;R = QQ[&#39;x, y&#39;]; (x, y,) = R._first_ngens(2)&quot;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x, y&#39;</span><span class="p">];</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,)</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">preparse</span><span class="p">(</span><span class="s1">&#39;R.&lt;x,y&gt; = QQ[]&#39;</span><span class="p">)</span>
<span class="go">&quot;R = QQ[&#39;x, y&#39;]; (x, y,) = R._first_ngens(2)&quot;</span>
</pre></div>
</div>
</div>
</div>
</li>
<li><p class="with-sage-tab with-python-tab">Integer and real literals are Sage integers and Sage floating point
numbers. For example, in pure Python these would be an attribute
error:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="mf">16.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage:</span> <span class="mf">87.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">3 * 29</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">87</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">3 * 29</span>
</pre></div>
</div>
</div>
</div>
</li>
<li><p class="with-sage-tab with-python-tab">Raw literals are not preparsed, which can be useful from an
efficiency point of view. In Sage raw integer and floating
literals are followed by an “r” (or “R”) for raw, meaning
not preparsed. For example:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">393939</span><span class="n">r</span>
<span class="gp">sage:</span> <span class="n">a</span>
<span class="go">393939</span>
<span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;... &#39;int&#39;&gt;</span>
<span class="gp">sage:</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">393939</span>
<span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.integer.Integer&#39;&gt;</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">393939</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="go">393939</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;... &#39;int&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">393939</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.integer.Integer&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</li>
<li><p>Raw literals can be very useful in certain cases. For instance,
Python integers can be more efficient than Sage integers when they
are very small.  Large Sage integers are much more efficient than
Python integers since they are implemented using the GMP C library.</p></li>
</ul>
<p>Consult <a class="reference external" href="../reference/repl/sage/repl/preparse.html#module-sage.repl.preparse" title="(in Reference Manual v10.6.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.repl.preparse</span></code></a> for more details about Sage
preparsing, more examples involving raw literals, etc.</p>
<p>When a file <code class="docutils literal notranslate"><span class="pre">foo.sage</span></code> is loaded or attached in a Sage session, a
preparsed version of <code class="docutils literal notranslate"><span class="pre">foo.sage</span></code> is created with the name
<code class="docutils literal notranslate"><span class="pre">foo.sage.py</span></code>. The beginning of the preparsed file states:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">This file was *autogenerated* from the file foo.sage.</span>
</pre></div>
</div>
<p>You can explicitly preparse a file with the <code class="docutils literal notranslate"><span class="pre">--preparse</span></code>
command-line option: running</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">sage --preparse foo.sage</span>
</pre></div>
</div>
<p>creates the file <code class="docutils literal notranslate"><span class="pre">foo.sage.py</span></code>.</p>
<p>The following files are relevant to preparsing in Sage:</p>
<ol class="arabic simple">
<li><p><a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/bin/sage">SAGE_ROOT/src/bin/sage</a></p></li>
<li><p><a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/bin/sage-preparse">SAGE_ROOT/src/bin/sage-preparse</a></p></li>
<li><p><a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/sage/repl/preparse.py">SAGE_ROOT/src/sage/repl/preparse.py</a></p></li>
</ol>
<p>In particular, the file <code class="docutils literal notranslate"><span class="pre">preparse.py</span></code> contains the Sage preparser
code.</p>
</section>
<section id="the-sage-coercion-model">
<h2>The Sage coercion model<a class="headerlink" href="#the-sage-coercion-model" title="Link to this heading">¶</a></h2>
<p>The primary goal of coercion is to be able to transparently do
arithmetic, comparisons, etc. between elements of distinct sets. For
example, when one writes <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">+</span> <span class="pre">1/2</span></code>, one wants to perform arithmetic on
the operands as rational numbers, despite the left term being an
integer.  This makes sense given the obvious and natural inclusion of
the integers into the rational numbers. The goal of the coercion
system is to facilitate this (and more complicated arithmetic) without
having to explicitly map everything over into the same domain, and at
the same time being strict enough to not resolve ambiguity or accept
nonsense.</p>
<p>The coercion model for Sage is described in detail, with examples, in
the Coercion section of the Sage Reference Manual.</p>
</section>
<section id="mutability">
<h2>Mutability<a class="headerlink" href="#mutability" title="Link to this heading">¶</a></h2>
<p>Parent structures (e.g. rings, fields, matrix spaces, etc.) should be
immutable and globally unique whenever possible. Immutability means,
among other things, that properties like generator labels and default
coercion precision cannot be changed.</p>
<p>Global uniqueness while not wasting memory is best implemented using
the standard Python weakref module, a factory function, and module
scope variable.</p>
<p>Certain objects, e.g. matrices, may start out mutable and become
immutable later. See <a class="reference external" href="../reference/structure/sage/structure/mutability.html#module-sage.structure.mutability" title="(in Parents and Elements v10.6.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure.mutability</span></code></a>.</p>
</section>
<section id="the-hash-special-method">
<h2>The  __hash__ special method<a class="headerlink" href="#the-hash-special-method" title="Link to this heading">¶</a></h2>
<p>Here is the definition of <code class="xref py py-meth docutils literal notranslate"><span class="pre">__hash__()</span></code> from the Python reference
manual:</p>
<blockquote>
<div><p>Called by built-in function <a class="reference external" href="https://docs.python.org/library/functions.html#hash" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash()</span></code></a> and for operations on members
of hashed collections including <code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">frozenset</span></code>, and
<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>. <code class="xref py py-meth docutils literal notranslate"><span class="pre">__hash__()</span></code> should return an integer. The only required
property is that objects which compare equal have the same hash
value; it is advised to mix together the hash values of the
components of the object that also play a part in comparison of
objects by packing them into a tuple and hashing the tuple.</p>
<p>If a class does not define an <code class="xref py py-meth docutils literal notranslate"><span class="pre">__eq__()</span></code> method, it should not define
a <code class="xref py py-meth docutils literal notranslate"><span class="pre">__hash__()</span></code> operation either; if it defines <code class="xref py py-meth docutils literal notranslate"><span class="pre">__eq__()</span></code> but not
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__hash__()</span></code>, its instances will not be usable as items in hashable
collections. If a class defines mutable objects and implements an
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__eq__()</span></code> method, it should not implement <code class="xref py py-meth docutils literal notranslate"><span class="pre">__hash__()</span></code>, since the
implementation of hashable collections requires that a key’s hash
value is immutable (if the object’s hash value changes, it will be
in the wrong hash bucket).</p>
</div></blockquote>
<p>See <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__hash__">https://docs.python.org/3/reference/datamodel.html#object.__hash__</a> for more
information on the subject.</p>
<p class="with-sage-tab with-python-tab">Notice the phrase, “The only required property is that objects which
compare equal have the same hash value.” This is an assumption made by
the Python language, which in Sage we simply cannot make (!), and
violating it has consequences. Fortunately, the consequences are
pretty clearly defined and reasonably easy to understand, so if you
know about them they do not cause you trouble. The following example
illustrates them pretty well:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)]</span>
<span class="gp">sage:</span> <span class="mi">9</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage:</span> <span class="mi">9</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">w</span> <span class="o">=</span> <span class="p">{</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
<span class="gp">sage:</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">sage:</span> <span class="n">w</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: 9</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">Mod</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">Mod</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="p">{</span><span class="n">Mod</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)):</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">w</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">w</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: 9</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Here is another example:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">^-</span><span class="mi">100</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">==</span> <span class="n">RDF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># because the a gets coerced down to RDF</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">**-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">RDF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># because the a gets coerced down to RDF</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p>but <code class="docutils literal notranslate"><span class="pre">hash(a)</span></code> should not equal <code class="docutils literal notranslate"><span class="pre">hash(1)</span></code>.</p>
<p>Unfortunately, in Sage we simply cannot require</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(#)   &quot;a == b ==&gt; hash(a) == hash(b)&quot;
</pre></div>
</div>
<p>because serious mathematics is simply too complicated for this
rule. For example, the equalities <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">==</span> <span class="pre">Mod(z,</span> <span class="pre">2)</span></code> and
<code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">==</span> <span class="pre">Mod(z,</span> <span class="pre">3)</span></code> would force <a class="reference external" href="https://docs.python.org/library/functions.html#hash" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash()</span></code></a> to be constant on the
integers.</p>
<p>The only way we could “fix” this problem for good would be to abandon
using the <code class="docutils literal notranslate"><span class="pre">==</span></code> operator for “Sage equality”, and implement Sage
equality as a new method attached to each object. Then we could follow
Python rules for <code class="docutils literal notranslate"><span class="pre">==</span></code> and our rules for everything else, and all
Sage code would become completely unreadable (and for that matter
unwritable). So we just have to live with it.</p>
<p class="with-sage-tab with-python-tab">So what is done in Sage is to attempt to satisfy <code class="docutils literal notranslate"><span class="pre">(#)</span></code> when it is
reasonably easy to do so, but use judgment and not go overboard.
For example,</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="nb">hash</span><span class="p">(</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">hash</span><span class="p">(</span><span class="n">Mod</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
</div>
<p>The output 2 is better than some random hash that also involves the
moduli, but it is of course not right from the Python point of view,
since <code class="docutils literal notranslate"><span class="pre">9</span> <span class="pre">==</span> <span class="pre">Mod(2,7)</span></code>. The goal is to make a hash function that is
fast, but within reason respects any obvious natural inclusions and
coercions.</p>
</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading">¶</a></h2>
<p>Please avoid catch-all code like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">some_code</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>               <span class="c1"># bad</span>
    <span class="n">more_code</span><span class="p">()</span>
</pre></div>
</div>
<p>If you do not have any exceptions explicitly listed (as a tuple), your
code will catch absolutely anything, including <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">C</kbd>, typos in
the code, and alarms, and this will lead to confusion. Also, this
might catch real errors which should be propagated to the user.</p>
<p>To summarize, only catch specific exceptions as in the following
example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__coordinate_ring</span>
<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">OtherExceptions</span><span class="p">)</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>           <span class="c1"># good</span>
    <span class="n">more_code_to_compute_something</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that the syntax in <code class="docutils literal notranslate"><span class="pre">except</span></code> is to list all the exceptions that
are caught as a tuple, followed by an error message.</p>
<p>A method or a function accepts input described in the <code class="docutils literal notranslate"><span class="pre">INPUT</span></code> block of
<a class="reference internal" href="coding_basics.html#section-docstring-function"><span class="std std-ref">the docstring</span></a>. If the input cannot be
handled by the code, then it may raise an exception. The following aims to
guide you in choosing from the most relevant exceptions to Sage. Raise</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></a>: if the input belongs to a class of objects that is not
supported by the method. For example, a method works only with monic
polynomials over a finite field, but a polynomial over rationals was given.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a>: if the input has a value not supported by the method.
For example, the above method was given a non-monic polynomial.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ArithmeticError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArithmeticError</span></code></a>: if the method performs an arithmetic operation
(sum, product, quotient, and the like) but the input is not appropriate.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ZeroDivisionError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZeroDivisionError</span></code></a>: if the method performs division but the input is
zero. Note that for non-invertible input values, <a class="reference external" href="https://docs.python.org/library/exceptions.html#ArithmeticError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArithmeticError</span></code></a> is
more appropriate. As derived from <a class="reference external" href="https://docs.python.org/library/exceptions.html#ArithmeticError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArithmeticError</span></code></a>,
<a class="reference external" href="https://docs.python.org/library/exceptions.html#ZeroDivisionError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZeroDivisionError</span></code></a> can be caught as <a class="reference external" href="https://docs.python.org/library/exceptions.html#ArithmeticError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArithmeticError</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#NotImplementedError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a>: if the input is for a feature not yet
implemented by the method. Note that this exception is derived from
<a class="reference external" href="https://docs.python.org/library/exceptions.html#RuntimeError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>.</p></li>
</ul>
<p>If no specific error seems to apply for your situation, <a class="reference external" href="https://docs.python.org/library/exceptions.html#RuntimeError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>
can be used. In all cases, the string associated with the exception should
describe the details of what went wrong.</p>
</section>
<section id="integer-return-values">
<h2>Integer return values<a class="headerlink" href="#integer-return-values" title="Link to this heading">¶</a></h2>
<p>Many functions and methods in Sage return integer values.
Those should usually be returned as Sage integers of class
<a class="reference external" href="../reference/rings_standard/sage/rings/integer.html#sage.rings.integer.Integer" title="(in Standard Commutative Rings v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a> rather than
as Python integers of class <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, as users may want
to explore the resulting integers’ number-theoretic properties
such as prime factorization. Exceptions should be made when
there are good reasons such as performance or compatibility
with Python code, for instance in methods such as
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__hash__()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code>, and <code class="xref py py-meth docutils literal notranslate"><span class="pre">__int__()</span></code>.</p>
<p>To return a Python integer <code class="docutils literal notranslate"><span class="pre">i</span></code> as a Sage integer, use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.rings.integer</span> <span class="kn">import</span> <span class="n">Integer</span>
<span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>To return a Sage integer <code class="docutils literal notranslate"><span class="pre">i</span></code> as a Python integer, use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="importing">
<h2>Importing<a class="headerlink" href="#importing" title="Link to this heading">¶</a></h2>
<p>We mention two issues with importing: circular imports and importing
large third-party modules. See also <a class="reference internal" href="packaging_sage_library.html#section-dependencies-distributions"><span class="std std-ref">Dependencies and distribution packages</span></a>
for a discussion of imports from the viewpoint of modularization.</p>
<p>First, you must avoid circular imports. For example, suppose that the
file <a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/sage/algebras/steenrod_algebra.py">SAGE_ROOT/src/sage/algebras/steenrod_algebra.py</a>
started with a line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.sage.algebras.steenrod_algebra_bases</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>and that the file
<a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/sage/algebras/steenrod_algebra_bases.py">SAGE_ROOT/src/sage/algebras/steenrod_algebra_bases.py</a>
started with a line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.sage.algebras.steenrod_algebra</span> <span class="kn">import</span> <span class="n">SteenrodAlgebra</span>
</pre></div>
</div>
<p>This sets up a loop: loading one of these files requires the other,
which then requires the first, etc.</p>
<p>With this set-up, running Sage will produce an error:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Exception exceptions.ImportError: &#39;cannot import name SteenrodAlgebra&#39;
in &#39;sage.rings.polynomial.polynomial_element.
Polynomial_generic_dense.__normalize&#39; ignored
-------------------------------------------------------------------
ImportError                       Traceback (most recent call last)

...
ImportError: cannot import name SteenrodAlgebra
</pre></div>
</div>
<p>Instead, you might replace the <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span></code> line at the top of the
file by more specific imports where they are needed in the code. For
example, the <code class="docutils literal notranslate"><span class="pre">basis</span></code> method for the class <code class="docutils literal notranslate"><span class="pre">SteenrodAlgebra</span></code> might
look like this (omitting the documentation string):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">steenrod_algebra_bases</span> <span class="kn">import</span> <span class="n">steenrod_algebra_basis</span>
    <span class="k">return</span> <span class="n">steenrod_algebra_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis_name</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prime</span><span class="p">)</span>
</pre></div>
</div>
<p>Second, do not import at the top level of your module a third-party
module that will take a long time to initialize (e.g. <a class="reference external" href="https://matplotlib.org/stable/index.html#module-matplotlib" title="(in Matplotlib v3.8.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code></a>). As
above, you might instead import specific components of the module when
they are needed, rather than at the top level of your file.</p>
<p>It is important to try to make <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">sage.all</span> <span class="pre">import</span> <span class="pre">*</span></code> as fast as
possible, since this is what dominates the Sage startup time, and
controlling the top-level imports helps to do this. One important
mechanism in Sage are lazy imports, which don’t actually perform the
import but delay it until the object is actually used. See
<a class="reference external" href="../reference/misc/sage/misc/lazy_import.html#module-sage.misc.lazy_import" title="(in Reference Manual v10.6.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.lazy_import</span></code></a> for more details of lazy imports, and
<a class="reference internal" href="coding_basics.html#chapter-directory-structure"><span class="std std-ref">Files and directory structure</span></a> for an example using lazy imports
for a new module.</p>
<p>If your module needs to make some precomputed data available at the top level,
you can reduce its load time (and thus startup time, unless your module is
imported using <a class="reference external" href="../reference/misc/sage/misc/lazy_import.html#module-sage.misc.lazy_import" title="(in Reference Manual v10.6.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.lazy_import</span></code></a>) by using the decorator
<a class="reference external" href="../reference/misc/sage/misc/cachefunc.html#sage.misc.cachefunc.cached_function" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sage.misc.cachefunc.cached_function()</span></code></a> instead. For example, replace</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">big_data</span> <span class="o">=</span> <span class="n">initialize_big_data</span><span class="p">()</span>  <span class="c1"># bad: runs at module load time</span>
</pre></div>
</div>
<p>by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.cachefunc</span> <span class="kn">import</span> <span class="n">cached_function</span>

<span class="nd">@cached_function</span>                  <span class="c1"># good: runs on first use</span>
<span class="k">def</span> <span class="nf">big_data</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">initialize_big_data</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="static-typing">
<h2>Static typing<a class="headerlink" href="#static-typing" title="Link to this heading">¶</a></h2>
<p>Python libraries are increasingly annotated with static typing information;
see the <a class="reference external" href="https://docs.python.org/3/library/typing.html">Python reference on typing</a>.</p>
<p>For typechecking the Sage library, the project uses <a class="reference internal" href="tools.html#section-tools-pyright"><span class="std std-ref">pyright</span></a>;
it automatically runs in the GitHub Actions CI and can also be run locally.</p>
<p>As of Sage 10.2, the Sage library only contains a minimal set of such type
annotations. Pull requests that add more annotations are generally welcome.</p>
<p>The Sage library makes very extensive use of Cython (see chapter <a class="reference internal" href="coding_in_cython.html#chapter-cython"><span class="std std-ref">Coding in Cython</span></a>).
Although Cython source code often declares static types for the purpose of
compilation to efficient machine code, this typing information is unfortunately
not visible to static checkers such as Pyright. It is necessary to create <a class="reference external" href="https://github.com/microsoft/pyright/blob/main/docs/type-stubs.md">type stub
files (“.pyi”)</a>
that provide this information. Although various
<a class="reference external" href="https://typing.readthedocs.io/en/latest/source/writing_stubs.html#writing-and-maintaining-stub-files">tools for writing and maintaining type stub files</a>
are available, creating stub files for Cython files involves manual work.
There is hope that better tools become available soon, see for example
<a class="reference external" href="https://github.com/cython/cython/pull/5744">cython/cython #5744</a>.
Contributing to the development and testing of such tools likely will have a
greater impact than writing the typestub files manually.</p>
<p>For Cython modules of the Sage library, these type stub files would be placed
next to the <code class="docutils literal notranslate"><span class="pre">.pyx</span></code> and <code class="docutils literal notranslate"><span class="pre">.pxd</span></code> files.</p>
<p>When importing from other Python libraries that do not provide sufficient typing
information, it is possible to augment the library’s typing information for
the purposes of typechecking the Sage library:</p>
<ul class="simple">
<li><p>Create typestub files and place them in the directory <code class="file docutils literal notranslate"><span class="pre">SAGE_ROOT/src/typings</span></code>.
For example, the distribution <strong>pplpy</strong> provides the top-level package <a class="reference external" href="/Users/mkoeppe/s/sage/sage-rebasing/local/share/doc/pplpy/index.html#module-ppl" title="(in pplpy v0.8.10.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ppl</span></code></a>,
which publishes no typing information. We can create a typestub file
<code class="file docutils literal notranslate"><span class="pre">SAGE_ROOT/src/typings/ppl.pyi</span></code> or <code class="file docutils literal notranslate"><span class="pre">SAGE_ROOT/src/typings/ppl/__init__.pyi</span></code>.</p></li>
<li><p>When these typestub files are working well, it is preferable from the viewpoint
of the Sage project that they are “upstreamed”, i.e., contributed to the
project that maintains the library. If a new version of the upstream library
becomes available that provides the necessary typing information, we can
update the package in the Sage distribution and remove the typestub files again
from <code class="file docutils literal notranslate"><span class="pre">SAGE_ROOT/src/typings</span></code>.</p></li>
<li><p>As a fallback, when neither adding typing annotations to source files
nor adding typestub files is welcomed by the upstream project, it is possible
to <a class="reference external" href="https://github.com/python/typeshed/blob/main/CONTRIBUTING.md">contribute typestubs files instead to the typeshed community project</a>.</p></li>
</ul>
</section>
<section id="deprecation">
<h2>Deprecation<a class="headerlink" href="#deprecation" title="Link to this heading">¶</a></h2>
<p>When making a <strong>backward-incompatible</strong> modification in Sage, the old code should
keep working and a message indicating how the code should be updated/written
in the future should be displayed somewhere. We call this <em>deprecation</em>. We explain
how to do the deprecation, the deprecation policy, below.</p>
<p>Any class, function, method, or attribute defined in a file under
<a class="extlink-sage_root reference external" href="https://github.com/passagemath/passagemath/tree/main/src/sage">SAGE_ROOT/src/sage</a> is subject to the deprecation policy. If its name starts
with an underscore, then it is considered internal, and exempt from the
deprecation policy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A deprecated class, function, method, or attribute can only be removed one
year after the first stable release in which it appeared.</p>
</div>
<p>When a deprecated function, method, or attribute is used, a deprecation warning
is issued. The warning message contains the number of the GitHub PR that
implemented the deprecation. We use 12345 in the examples below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For deprecation tools used in the examples, consult the tool’s documentation for more
information on its behaviour and optional arguments.</p>
</div>
<ul>
<li><p><strong>Rename a keyword:</strong> by decorating a function/method with
<a class="reference external" href="../reference/misc/sage/misc/decorators.html#sage.misc.decorators.rename_keyword" title="(in Utilities v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">rename_keyword</span></code></a>, any user calling
<code class="docutils literal notranslate"><span class="pre">my_function(my_old_keyword=5)</span></code> will see a warning:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.decorators</span> <span class="kn">import</span> <span class="n">rename_keyword</span>
<span class="nd">@rename_keyword</span><span class="p">(</span><span class="n">deprecation</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span> <span class="n">my_old_keyword</span><span class="o">=</span><span class="s1">&#39;my_new_keyword&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">my_new_keyword</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">my_new_keyword</span>
</pre></div>
</div>
</li>
<li><p><strong>Rename a function/method:</strong> call
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.deprecated_function_alias" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deprecated_function_alias()</span></code></a> to obtain a copy of a
function that raises a deprecation warning:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="kn">import</span> <span class="n">deprecated_function_alias</span>
<span class="k">def</span> <span class="nf">my_new_function</span><span class="p">():</span>
    <span class="o">...</span>

<span class="n">my_old_function</span> <span class="o">=</span> <span class="n">deprecated_function_alias</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="n">my_new_function</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Moving an object to a different module:</strong>
if you rename a source file or move some function (or class) to a
different file, it should still be possible to import that function
from the old module. This can be done using a
<a class="reference external" href="../reference/misc/sage/misc/lazy_import.html#sage.misc.lazy_import.lazy_import" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lazy_import()</span></code></a> with deprecation.
In the old module, you would write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.lazy_import</span> <span class="kn">import</span> <span class="n">lazy_import</span>
<span class="n">lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.new.module.name&#39;</span><span class="p">,</span> <span class="s1">&#39;name_of_the_function&#39;</span><span class="p">,</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also lazily import everything using <code class="docutils literal notranslate"><span class="pre">*</span></code> or a few functions
using a tuple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.lazy_import</span> <span class="kn">import</span> <span class="n">lazy_import</span>
<span class="n">lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.new.module.name&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.other.module&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;func1&#39;</span><span class="p">,</span> <span class="s1">&#39;func2&#39;</span><span class="p">),</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Remove a name from a global namespace:</strong> this is when you want to
remove a name from a global namespace (say, <code class="docutils literal notranslate"><span class="pre">sage.all</span></code> or some
other <code class="docutils literal notranslate"><span class="pre">all.py</span></code> file) but you want to keep the functionality
available with an explicit import.
This case is similar as the previous one: use a lazy import with
deprecation. One detail: in this case, you don’t want the name
<code class="docutils literal notranslate"><span class="pre">lazy_import</span></code> to be visible in the global namespace, so we add
a leading underscore:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.lazy_import</span> <span class="kn">import</span> <span class="n">lazy_import</span> <span class="k">as</span> <span class="n">_lazy_import</span>
<span class="n">_lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.some.package&#39;</span><span class="p">,</span> <span class="s1">&#39;some_function&#39;</span><span class="p">,</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Any other case:</strong> if none of the cases above apply, call
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.deprecation" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deprecation()</span></code></a> in the function that you want to
deprecate. It will display the message of your choice (and interact properly
with the doctest framework):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="kn">import</span> <span class="n">deprecation</span>
<span class="n">deprecation</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="s2">&quot;Do not use your computer to compute 1 + 1. Use your brain.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These decorators only work for Python. There is no implementation
of decorators in Cython. Hence, when in need to rename a keyword/function/method/…
in a Cython (.pyx) file and/or to deprecate something, forget about decorators and
just use <a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.deprecation_cython" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deprecation_cython()</span></code></a> instead. The usage of
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.deprecation_cython" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deprecation_cython()</span></code></a> is exactly the same as
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.deprecation" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deprecation()</span></code></a>.</p>
</div>
<p>When a class is renamed or removed, it should be deprecated unless it is
internal. A class is internal if its name starts with an underscore, or experts
(authors and reviewers of a PR making changes to the class) agree that the
class is unlikely to be directly imported by user code. Otherwise, or if experts
disagree, it is public.</p>
<p>As a class is imported rather than run by user code, there are some technical
difficulties in using the above deprecation tools. Instead we follow
the procedure below:</p>
<ul>
<li><p><strong>Renaming a class:</strong> rename <code class="docutils literal notranslate"><span class="pre">OldClass</span></code> to <code class="docutils literal notranslate"><span class="pre">NewClass</span></code> and add an
alias <code class="docutils literal notranslate"><span class="pre">OldClass</span> <span class="pre">=</span> <span class="pre">NewClass</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NewClass</span><span class="p">:</span>
    <span class="o">...</span>

<span class="n">OldClass</span> <span class="o">=</span> <span class="n">NewClass</span>   <span class="c1"># OldClass is deprecated. See Issue #12345.</span>
</pre></div>
</div>
</li>
<li><p><strong>Removing a class:</strong>  add a comment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># OldClass is deprecated. See Issue #12345.</span>

<span class="k">class</span> <span class="nc">OldClass</span><span class="p">:</span>
</pre></div>
</div>
</li>
</ul>
<p>In both cases, make it sure to display the change in the “Deprecations”
section of the release notes of the next stable release.</p>
</section>
<section id="experimental-unstable-code">
<h2>Experimental/unstable code<a class="headerlink" href="#experimental-unstable-code" title="Link to this heading">¶</a></h2>
<p>You can mark your newly created code (classes/functions/methods) as
experimental/unstable. In this case, no deprecation warning is needed
when changing this code, its functionality or its interface.</p>
<p>This should allow you to put your stuff in Sage early, without worrying about
making (design) changes later.</p>
<p>When satisfied with the code (when stable for some time, say, one
year), you can delete this warning.</p>
<p>As usual, all code has to be fully doctested and go through our
reviewing process.</p>
<ul>
<li><p><strong>Experimental function/method:</strong> use the decorator
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental" title="(in Utilities v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">experimental</span></code></a>. Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="kn">import</span> <span class="n">experimental</span>
<span class="nd">@experimental</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">experimental_function</span><span class="p">():</span>
    <span class="c1"># do something</span>
</pre></div>
</div>
</li>
<li><p><strong>Experimental class:</strong> use the decorator
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental" title="(in Utilities v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">experimental</span></code></a> for its <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.
Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="kn">import</span> <span class="n">experimental</span>
<span class="k">class</span> <span class="nc">experimental_class</span><span class="p">(</span><span class="n">SageObject</span><span class="p">):</span>
    <span class="nd">@experimental</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">some</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
        <span class="c1"># do something</span>
</pre></div>
</div>
</li>
<li><p><strong>Any other case:</strong> if none of the cases above apply, call
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental_warning" title="(in Utilities v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">experimental_warning()</span></code></a> in the code where
you want to warn. It will display the message of your choice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="kn">import</span> <span class="n">experimental_warning</span>
<span class="n">experimental_warning</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="s1">&#39;This code is not foolproof.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="using-optional-packages">
<h2>Using optional packages<a class="headerlink" href="#using-optional-packages" title="Link to this heading">¶</a></h2>
<p>If a function requires an optional package, that function should fail
gracefully—perhaps using a <code class="docutils literal notranslate"><span class="pre">try</span></code>-<code class="docutils literal notranslate"><span class="pre">except</span></code> block—when the
optional package is not available, and should give a hint about how to
install it. For example, typing <code class="docutils literal notranslate"><span class="pre">sage</span> <span class="pre">-optional</span></code> gives a list of all
optional packages, so it might suggest to the user that they type
that. The command <code class="docutils literal notranslate"><span class="pre">optional_packages()</span></code> from within Sage also
returns this list.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="coding_in_cython.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Coding in Cython</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="sage_manuals.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">The Sage Manuals</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2025, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Coding in Python for Sage</a><ul>
<li><a class="reference internal" href="#python-language-standard">Python language standard</a></li>
<li><a class="reference internal" href="#design">Design</a></li>
<li><a class="reference internal" href="#special-sage-functions">Special Sage functions</a></li>
<li><a class="reference internal" href="#latex-representation">LaTeX representation</a></li>
<li><a class="reference internal" href="#print-representation">Print representation</a></li>
<li><a class="reference internal" href="#matrix-or-vector-from-object">Matrix or vector from object</a></li>
<li><a class="reference internal" href="#sage-preparsing">Sage preparsing</a></li>
<li><a class="reference internal" href="#the-sage-coercion-model">The Sage coercion model</a></li>
<li><a class="reference internal" href="#mutability">Mutability</a></li>
<li><a class="reference internal" href="#the-hash-special-method">The  __hash__ special method</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#integer-return-values">Integer return values</a></li>
<li><a class="reference internal" href="#importing">Importing</a></li>
<li><a class="reference internal" href="#static-typing">Static typing</a></li>
<li><a class="reference internal" href="#deprecation">Deprecation</a></li>
<li><a class="reference internal" href="#experimental-unstable-code">Experimental/unstable code</a></li>
<li><a class="reference internal" href="#using-optional-packages">Using optional packages</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5f573d00"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=8e571dd6"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "im": "\\mathop{\\operatorname{im}}", "rank": "\\mathop{\\operatorname{rank}}", "PP": "\\Bold{P}", "OO": "\\mathcal{O}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="_static/jupyter-sphinx-furo.js?v=77915cdd"></script>
    </body>
</html>