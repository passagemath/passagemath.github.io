<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Sparse integer matrices" href="matrix_integer_sparse.html" /><link rel="prev" title="Sparse Matrices over a general ring" href="matrix_generic_sparse.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Dense matrices over the integer ring - Matrices and Spaces of Matrices</title>
      <link rel="stylesheet" type="text/css" href="../../../%5fstatic/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-codemirror-monokai.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-tabs.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Matrices and Spaces of Matrices</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../%5fstatic/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../%5fstatic/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">passagemath 10.6.2 Reference Manual</span>
  
</a><div class="select-wrapper">
  <select id="versions-menu" onchange="changeVersion()">
    <option value="" selected>other version</option>
    <option value="https://doc-develop--sagemath.netlify.app">develop</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Matrices and Spaces of Matrices</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="matrix_space.html">Matrix Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">General matrix Constructor and display options</a></li>
<li class="toctree-l1"><a class="reference internal" href="special.html">Constructors for special matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="args.html">Helpers for creating matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Matrices over an arbitrary ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix0.html">Base class for matrices, part 0</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix1.html">Base class for matrices, part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix2.html">Base class for matrices, part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="strassen.html">Generic Asymptotically Fast Strassen Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="berlekamp_massey.html">Minimal Polynomials of Linear Recurrence Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_dense.html">Base class for dense matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_sparse.html">Base class for sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_generic_dense.html">Dense Matrices over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_generic_sparse.html">Sparse Matrices over a general ring</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Dense matrices over the integer ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_integer_sparse.html">Sparse integer matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_integer_dense_hnf.html">Modular algorithm to compute Hermite normal forms of integer matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_integer_dense_saturation.html">Saturation over ZZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_rational_dense.html">Dense matrices over the rational field</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_rational_sparse.html">Sparse rational matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_double_dense.html">Dense matrices using a NumPy backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_real_double_dense.html">Dense matrices over the Real Double Field using NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_mod2_dense.html">Dense matrices over GF(2) using the M4RI library</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_gf2e_dense.html">Dense matrices over <span class="math notranslate nohighlight">\(\GF{2^e}\)</span> for <span class="math notranslate nohighlight">\(2 \leq e \leq 16\)</span> using the M4RIE library</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_modn_dense_double.html">Dense matrices over <span class="math notranslate nohighlight">\(\ZZ/n\ZZ\)</span> for <span class="math notranslate nohighlight">\(n &lt; 94906266\)</span> using LinBox’s <code class="docutils literal notranslate"><span class="pre">Modular&lt;double&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_modn_dense_float.html">Dense matrices over <span class="math notranslate nohighlight">\(\ZZ/n\ZZ\)</span> for <span class="math notranslate nohighlight">\(n &lt; 2^{8}\)</span> using LinBox’s <code class="docutils literal notranslate"><span class="pre">Modular&lt;float&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_modn_sparse.html">Sparse matrices over <span class="math notranslate nohighlight">\(\ZZ/n\ZZ\)</span> for <span class="math notranslate nohighlight">\(n\)</span> small</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_symbolic_dense.html">Symbolic dense matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_symbolic_sparse.html">Symbolic sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_complex_double_dense.html">Dense matrices over the Complex Double Field using NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_complex_ball_dense.html">Arbitrary precision complex ball matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_polynomial_dense.html">Dense matrices over univariate polynomials over fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_mpolynomial_dense.html">Dense matrices over multivariate polynomials over fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_cyclo_dense.html">Matrices over Cyclotomic Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="operation_table.html">Operation Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="action.html">Actions used by the coercion model for matrix and vector multiplications</a></li>
<li class="toctree-l1"><a class="reference internal" href="change_ring.html">Functions for changing the base ring of matrices quickly</a></li>
<li class="toctree-l1"><a class="reference internal" href="echelon_matrix.html">Echelon matrices over finite fields.</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_misc.html">Miscellaneous matrix functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_window.html">Matrix windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc matrix algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc_mpfr.html">Misc matrix algorithms using MPFR</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc_flint.html">Misc matrix algorithms using FLINT</a></li>
<li class="toctree-l1"><a class="reference internal" href="symplectic_basis.html">Calculate symplectic bases for matrices over fields and the integers.</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_J_ideal.html"><span class="math notranslate nohighlight">\(J\)</span>-ideals of matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmarks for matrices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="seymour_decomposition.html">Seymour’s decomposition of totally unimodular matrices and regular matroids</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_cmr_sparse.html">Sparse Matrices from the Combinatorial Matrix Recognition Library</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/edit/main/src/sage/matrix/matrix_integer_dense.pyx" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="dense-matrices-over-the-integer-ring">
<span id="sage-matrix-matrix-integer-dense"></span><h1>Dense matrices over the integer ring<a class="headerlink" href="#dense-matrices-over-the-integer-ring" title="Link to this heading">¶</a></h1>
<p id="module-sage.matrix.matrix_integer_dense">AUTHORS:</p>
<ul class="simple">
<li><p>William Stein</p></li>
<li><p>Robert Bradshaw</p></li>
<li><p>Marc Masdeu (August 2014). Implemented using FLINT, see <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/16803">upstream Issue #16803</a>.</p></li>
<li><p>Jeroen Demeyer (October 2014): lots of fixes, see <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/17090">upstream Issue #17090</a> and
<a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/17094">upstream Issue #17094</a>.</p></li>
<li><p>Vincent Delecroix (February 2015): make it faster, see <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/17822">upstream Issue #17822</a>.</p></li>
<li><p>Vincent Delecroix (May 2017): removed duplication of entries and
cleaner linbox interface</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-30</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^3 - 22*x^2 + 102*x + 30</span>
<span class="gp">sage:</span> <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)));</span> <span class="n">a</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-30</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^3 - 22*x^2 + 102*x + 30</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.matrix.matrix_integer_dense.</span></span><span class="sig-name descname"><span class="pre">Matrix_integer_dense</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L121"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="matrix_dense.html#sage.matrix.matrix_dense.Matrix_dense" title="sage.matrix.matrix_dense.Matrix_dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix_dense</span></code></a></p>
<p>Matrix over the integers, implemented using FLINT.</p>
<p>On a 32-bit machine, they can have at most <span class="math notranslate nohighlight">\(2^{32}-1\)</span> rows or
columns.  On a 64-bit machine, matrices can have at most
<span class="math notranslate nohighlight">\(2^{64}-1\)</span> rows or columns.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[ 1  2 -3]</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: nonzero scalar matrix must be square</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)]);</span> <span class="n">a</span>
<span class="go">[ 1  2 -3]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">a</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: nonzero scalar matrix must be square</span>
</pre></div>
</div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ">
<span class="sig-name descname"><span class="pre">BKZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fpLLL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_givens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2661"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ" title="Link to this definition">¶</a></dt>
<dd><p>Return the result of running Block Korkin-Zolotarev reduction on
<code class="docutils literal notranslate"><span class="pre">self</span></code> interpreted as a lattice.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0.99</span></code>) LLL parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'fpLLL'</span></code>) <code class="docutils literal notranslate"><span class="pre">'fpLLL'</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;NTL&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fp</span></code> – floating point number implementation</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> – NTL’s exact reduction or fpLLL’s wrapper (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fp'</span></code> – double precision: NTL’s FP or fpLLL’s double</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ld'</span></code> – long doubles (fpLLL only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'qd'</span></code> – NTL’s QP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'qd1'</span></code> – quad doubles: Uses <code class="docutils literal notranslate"><span class="pre">quad_float</span></code> precision
to compute Gram-Schmidt, but uses double precision in
the search phase of the block reduction algorithm. This
seems adequate for most purposes, and is faster than
<code class="docutils literal notranslate"><span class="pre">'qd'</span></code>, which uses quad_float precision uniformly
throughout (NTL only).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'xd'</span></code> – extended exponent: NTL’s XD or fpLLL’s dpe</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rr'</span></code> – arbitrary precision: NTL’RR or fpLLL’s MPFR</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">block_size</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">10</span></code>) specifies the size
of the blocks in the reduction.  High values yield
shorter vectors, but the running time increases double
exponentially with <code class="docutils literal notranslate"><span class="pre">block_size</span></code>.  <code class="docutils literal notranslate"><span class="pre">block_size</span></code>
should be between 2 and the number of rows of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – (default: same as <code class="docutils literal notranslate"><span class="pre">proof.linear_algebra()</span></code>)
Insist on full BKZ reduction. If disabled and fplll is
called, reduction is much faster but the result is not fully
BKZ reduced.</p></li>
</ul>
<p>NTL SPECIFIC INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prune</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) the optional parameter
<code class="docutils literal notranslate"><span class="pre">prune</span></code> can be set to any positive number to invoke the
Volume Heuristic from <a class="reference internal" href="../../../references/index.html#sh1995" id="id1"><span>[SH1995]</span></a>. This can significantly reduce
the running time, and hence allow much bigger block size,
but the quality of the reduction is of course not as good in
general. Higher values of <code class="docutils literal notranslate"><span class="pre">prune</span></code> mean better quality, and
slower running time. When <code class="docutils literal notranslate"><span class="pre">prune</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code>, pruning is
disabled. Recommended usage: for <code class="docutils literal notranslate"><span class="pre">block_size==30</span></code>, set
<code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">&lt;=</span> <span class="pre">prune</span> <span class="pre">&lt;=15</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_givens</span></code> – use Givens orthogonalization.  Only
applies to approximate reduction using NTL.  This is a bit
slower, but generally much more stable, and is really the
preferred orthogonalization strategy.  For a nice
description of this, see Chapter 5 of <a class="reference internal" href="../../../references/index.html#gl1996" id="id2"><span>[GL1996]</span></a>.</p></li>
</ul>
<p>fpLLL SPECIFIC INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code> for automatic choice) bit
precision to use if <code class="docutils literal notranslate"><span class="pre">fp='rr'</span></code> is set</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> – keywords to be passed to <code class="xref py py-mod docutils literal notranslate"><span class="pre">fpylll</span></code>; see
<code class="xref py py-class docutils literal notranslate"><span class="pre">fpylll.BKZ.Param</span></code> for details</p></li>
</ul>
<p>Also, if the verbose level is at least <span class="math notranslate nohighlight">\(2\)</span>, some output
is printed during the computation.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs fpylll</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">()</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">use_givens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="s1">&#39;fp&#39;</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs fpylll</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">()</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">use_givens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="s1">&#39;fp&#39;</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
</div>
</div>
<p>ALGORITHM:</p>
<p>Calls either NTL or fpLLL.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL">
<span class="sig-name descname"><span class="pre">LLL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fpLLL:wrapper'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_red</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_givens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_siegel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2868"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL" title="Link to this definition">¶</a></dt>
<dd><p>Return LLL-reduced or approximated LLL reduced matrix <span class="math notranslate nohighlight">\(R\)</span> of the lattice
generated by the rows of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>A set of vectors <span class="math notranslate nohighlight">\((b_1, b_2, ..., b_d)\)</span> is <span class="math notranslate nohighlight">\((\delta, \eta)\)</span>-LLL-reduced
if the two following conditions hold:</p>
<ul class="simple">
<li><p>For any <span class="math notranslate nohighlight">\(i &gt; j\)</span>, we have <span class="math notranslate nohighlight">\(\lvert \mu_{i,j} \rvert \leq \eta\)</span>.</p></li>
<li><p>For any <span class="math notranslate nohighlight">\(i &lt; d\)</span>, we have <span class="math notranslate nohighlight">\(\delta \lvert b_i^* \rvert^2 \leq
\lvert b_{i + 1}^* + \mu_{i+1, i} b_i^* \rvert^2\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\mu_{i,j} = \langle b_i, b_j^* \rangle / \langle b_j^*, b_j^*
\rangle\)</span> and <span class="math notranslate nohighlight">\(b_i^*\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th vector of the Gram-Schmidt
orthogonalisation of <span class="math notranslate nohighlight">\((b_1, b_2, ..., b_d)\)</span>.</p>
<p>The default reduction parameters are <span class="math notranslate nohighlight">\(\delta = 0.99\)</span> and <span class="math notranslate nohighlight">\(\eta = 0.501\)</span>.
The parameters <span class="math notranslate nohighlight">\(\delta\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> must satisfy <span class="math notranslate nohighlight">\(0.25 &lt; \delta
\leq 1.0\)</span> and <span class="math notranslate nohighlight">\(0.5 \leq \eta &lt; \sqrt{\delta}\)</span>. Polynomial time
complexity is only guaranteed for <span class="math notranslate nohighlight">\(\delta &lt; 1\)</span>. Not every algorithm
admits the case <span class="math notranslate nohighlight">\(\delta = 1\)</span>.</p>
<p>If the matrix has a nonzero kernel, the LLL-reduced matrix will contain
zero rows, so that the output has the same dimensions as the input. The
transformation matrix is always invertible over the integers.</p>
<p>Also the rank of <code class="docutils literal notranslate"><span class="pre">self</span></code> is cached if it is computed during the
reduction. Note that in general this only happens when
<code class="docutils literal notranslate"><span class="pre">self.rank()</span> <span class="pre">==</span> <span class="pre">self.ncols()</span></code> and the exact algorithm is used.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0.99</span></code>) <span class="math notranslate nohighlight">\(\delta\)</span> parameter as described
above, ignored by pari</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eta</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0.501</span></code>) <span class="math notranslate nohighlight">\(\eta\)</span> parameter as described above,
ignored by NTL and pari</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string; one of the algorithms listed below
(default: <code class="docutils literal notranslate"><span class="pre">'fpLLL:wrapper'</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fp</span></code> – floating point number implementation, ignored by pari:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> – NTL’s exact reduction or fpLLL’s wrapper</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fp'</span></code> – double precision: NTL’s FP or fpLLL’s double</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ld'</span></code> – long doubles (fpLLL only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'qd'</span></code> – NTL’s QP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'xd'</span></code> – extended exponent: NTL’s XD or fpLLL’s dpe</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rr'</span></code> – arbitrary precision: NTL’s RR or fpLLL’s MPFR</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (default: auto choose) precision, ignored by NTL and pari</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">early_red</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); perform early reduction,
ignored by NTL and pari</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_givens</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); use Givens
orthogonalization.  Only applies to approximate reduction
using NTL.  This is slower but generally more stable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_siegel</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); use Siegel’s condition
instead of Lovász’s condition, ignored by NTL and pari</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); also return transformation
matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> – keywords to be passed to <code class="xref py py-mod docutils literal notranslate"><span class="pre">fpylll</span></code>; see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fpylll.LLL.reduction()</span></code> for details</p></li>
</ul>
<p>Also, if the verbose level is at least <span class="math notranslate nohighlight">\(2\)</span>, some output
is printed during the computation.</p>
<p>AVAILABLE ALGORITHMS:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'NTL:LLL'</span></code> – NTL’s LLL + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:heuristic'</span></code> – fpLLL’s heuristic + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:fast'</span></code> – fpLLL’s fast + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:proved'</span></code> – fpLLL’s proved + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:wrapper'</span></code> – fpLLL’s automatic choice (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> – pari’s qflll</p></li>
</ul>
<p>OUTPUT: a matrix over the integers</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>                                                               <span class="c1"># needs fpylll</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>                                                               <span class="c1"># needs fpylll</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We compute the extended GCD of a list of integers using LLL, this
example is from the Magma handbook:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs fpylll</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">67015143</span><span class="p">,</span> <span class="mi">248934363018</span><span class="p">,</span> <span class="mi">109210</span><span class="p">,</span> <span class="mi">25590011055</span><span class="p">,</span> <span class="mi">74631449</span><span class="p">,</span>
<span class="gp">....:</span>       <span class="mi">10230248</span><span class="p">,</span> <span class="mi">709487</span><span class="p">,</span> <span class="mi">68965012139</span><span class="p">,</span> <span class="mi">972065</span><span class="p">,</span> <span class="mi">864972271</span> <span class="p">]</span>
<span class="gp">sage:</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">sage:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span> <span class="o">*</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">sage:</span> <span class="n">M</span>
<span class="go">[-3, -1, 13, -1, -4, 2, 3, 4, 5, -1]</span>
<span class="gp">sage:</span> <span class="n">add</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs fpylll</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">67015143</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">248934363018</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">109210</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">25590011055</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">74631449</span><span class="p">),</span>
<span class="gp">...</span>       <span class="n">Integer</span><span class="p">(</span><span class="mi">10230248</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">709487</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">68965012139</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">972065</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">864972271</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">...</span>     <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">...</span>     <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">S</span> <span class="o">*</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">list</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">):]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span>
<span class="go">[-3, -1, 13, -1, -4, 2, 3, 4, 5, -1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">add</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The case <span class="math notranslate nohighlight">\(\delta = 1\)</span> is not always supported:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs fpylll</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: delta must be &lt;= 1</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>    <span class="c1"># not tested, will eat lots of ram</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">RuntimeError: infinite loop in LLL</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;NTL:LLL&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(-100, -3, -1, 13, -1, -4, 2, 3, 4, 5, -1)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs fpylll</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: delta must be &lt;= 1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>    <span class="c1"># not tested, will eat lots of ram</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">RuntimeError: infinite loop in LLL</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;NTL:LLL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">(-100, -3, -1, 13, -1, -4, 2, 3, 4, 5, -1)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We return the transformation matrix:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                     <span class="c1"># needs fpylll</span>
<span class="gp">sage:</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">==</span> <span class="n">R</span>                                                            <span class="c1"># needs fpylll</span>
<span class="go">True</span>

<span class="gp">sage:</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;NTL:LLL&#39;</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">==</span> <span class="n">R</span>
<span class="go">True</span>

<span class="gp">sage:</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">==</span> <span class="n">R</span>                                                            <span class="c1"># needs sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                     <span class="c1"># needs fpylll</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">==</span> <span class="n">R</span>                                                            <span class="c1"># needs fpylll</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;NTL:LLL&#39;</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">==</span> <span class="n">R</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">==</span> <span class="n">R</span>                                                            <span class="c1"># needs sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Example with a nonzero kernel:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>                                                          <span class="c1"># needs fpylll</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>

<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;NTL:LLL&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>

<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>                                         <span class="c1"># needs sage.libs.pari</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>                                                          <span class="c1"># needs fpylll</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;NTL:LLL&quot;</span><span class="p">)[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>                                         <span class="c1"># needs sage.libs.pari</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.libs.ntl.ntl_mat_ZZ.ntl_mat_ZZ.LLL</span></code> and
<a class="reference external" href="https://fpylll.readthedocs.io/en/latest/modules.html#module-fpylll.fplll.lll" title="(in fpylll v0.5.2dev)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fpylll.fplll.lll</span></code></a> for details on the algorithms used.</p>
<p>Although LLL is a deterministic algorithm, the output for
different implementations and CPUs (32-bit vs. 64-bit) may
vary, while still being correct.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose">
<span class="sig-name descname"><span class="pre">antitranspose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5513"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose" title="Link to this definition">¶</a></dt>
<dd><p>Return the antitranspose of <code class="docutils literal notranslate"><span class="pre">self</span></code>, without changing <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5 2]</span>
<span class="go">[4 1]</span>
<span class="go">[3 0]</span>
<span class="gp">sage:</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>

<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[0 1|2]</span>
<span class="go">[---+-]</span>
<span class="go">[3 4|5]</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5|2]</span>
<span class="go">[-+-]</span>
<span class="go">[4|1]</span>
<span class="go">[3|0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5 2]</span>
<span class="go">[4 1]</span>
<span class="go">[3 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1|2]</span>
<span class="go">[---+-]</span>
<span class="go">[3 4|5]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5|2]</span>
<span class="go">[-+-]</span>
<span class="go">[4|1]</span>
<span class="go">[3|0]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdivide</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5130"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment" title="Link to this definition">¶</a></dt>
<dd><p>Return a new matrix formed by appending the matrix
(or vector) <code class="docutils literal notranslate"><span class="pre">right</span></code> on the right side of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">right</span></code> – a matrix, vector or free module element, whose
dimensions are compatible with <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) request the resulting
matrix to have a new subdivision, separating <code class="docutils literal notranslate"><span class="pre">self</span></code> from <code class="docutils literal notranslate"><span class="pre">right</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<p>A new matrix formed by appending <code class="docutils literal notranslate"><span class="pre">right</span></code> onto the right side of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
If <code class="docutils literal notranslate"><span class="pre">right</span></code> is a vector (or free module element) then in this context
it is appropriate to consider it as a column vector.  (The code first
converts a vector to a 1-column matrix.)</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0  1  2]</span>
<span class="go">[ 5  6  7  8  9  3  4  5]</span>
<span class="go">[10 11 12 13 14  6  7  8]</span>
<span class="go">[15 16 17 18 19  9 10 11]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0  1  2]</span>
<span class="go">[ 5  6  7  8  9  3  4  5]</span>
<span class="go">[10 11 12 13 14  6  7  8]</span>
<span class="go">[15 16 17 18 19  9 10 11]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">A vector may be augmented to a matrix.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0]</span>
<span class="go">[ 5  6  7  8  9  1]</span>
<span class="go">[10 11 12 13 14  2]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0]</span>
<span class="go">[ 5  6  7  8  9  1]</span>
<span class="go">[10 11 12 13 14  2]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The <code class="docutils literal notranslate"><span class="pre">subdivide</span></code> option will add a natural subdivision between
<code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code>.  For more details about how subdivisions
are managed when augmenting, see
<a class="reference internal" href="matrix1.html#sage.matrix.matrix1.Matrix.augment" title="sage.matrix.matrix1.Matrix.augment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.matrix.matrix1.Matrix.augment()</span></code></a>.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4| 0  1  2]</span>
<span class="go">[ 5  6  7  8  9| 3  4  5]</span>
<span class="go">[10 11 12 13 14| 6  7  8]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4| 0  1  2]</span>
<span class="go">[ 5  6  7  8  9| 3  4  5]</span>
<span class="go">[10 11 12 13 14| 6  7  8]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Errors are raised if the sizes are incompatible.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: number of rows must be the same, not 2 != 3</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">40</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">60</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: number of rows must be the same, not 2 != 3</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly">
<span class="sig-name descname"><span class="pre">charpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L1206"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly" title="Link to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The characteristic polynomial is defined as <span class="math notranslate nohighlight">\(\det(xI-A)\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – a variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'linbox'</span></code>) either <code class="docutils literal notranslate"><span class="pre">'generic'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'flint'</span></code> or <code class="docutils literal notranslate"><span class="pre">'linbox'</span></code></p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^6 - 105*x^5 - 630*x^4</span>
<span class="gp">sage:</span> <span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;flint&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">f</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^20 - 3990*x^19 - 266000*x^18</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>                                                           <span class="c1"># needs sage.libs.pari</span>
<span class="go">x^3 - 3990*x^2 - 266000*x</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">36</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^6 - 105*x^5 - 630*x^4</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;flint&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">n</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^20 - 3990*x^19 - 266000*x^18</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>                                                           <span class="c1"># needs sage.libs.pari</span>
<span class="go">x^3 - 3990*x^2 - 266000*x</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">On non square matrices, this method raises an ArithmeticError:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: only valid for square matrix</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: only valid for square matrix</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.column">
<span class="sig-name descname"><span class="pre">column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5032"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.column" title="Link to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(i\)</span>-th column of this matrix as a dense vector.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_list</span></code> – ignored</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">from_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 3, -1)</span>

<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: column index out of range</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: column index out of range</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">from_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(1, 3, -1)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: column index out of range</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: column index out of range</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition">
<span class="sig-name descname"><span class="pre">decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L4598"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition" title="Link to this definition">¶</a></dt>
<dd><p>Return the decomposition of the free module on which this matrix A
acts from the right (i.e., the action is x goes to x A), along with
whether this matrix acts irreducibly on each factor. The factors
are guaranteed to be sorted in the same way as the corresponding
factors of the characteristic polynomial, and are saturated as ZZ
modules.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a matrix over the integers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> – these are passed onto to the
decomposition over QQ command</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">t</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">w</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">w</span>
<span class="go">[ 3 -2]</span>
<span class="go">[ 0 -2]</span>
<span class="gp">sage:</span> <span class="n">w</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 3) * (x + 2)</span>
<span class="gp">sage:</span> <span class="n">w</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[(Free module of degree 2 and rank 1 over Integer Ring</span>
<span class="go">  Echelon basis matrix:</span>
<span class="go">  [ 5 -2],</span>
<span class="go">  True),</span>
<span class="go"> (Free module of degree 2 and rank 1 over Integer Ring</span>
<span class="go">  Echelon basis matrix:</span>
<span class="go">  [0 1],</span>
<span class="go">  True)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">sign</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">w</span>
<span class="go">[ 3 -2]</span>
<span class="go">[ 0 -2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 3) * (x + 2)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[(Free module of degree 2 and rank 1 over Integer Ring</span>
<span class="go">  Echelon basis matrix:</span>
<span class="go">  [ 5 -2],</span>
<span class="go">  True),</span>
<span class="go"> (Free module of degree 2 and rank 1 over Integer Ring</span>
<span class="go">  Echelon basis matrix:</span>
<span class="go">  [0 1],</span>
<span class="go">  True)]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant">
<span class="sig-name descname"><span class="pre">determinant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stabilize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L3600"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant" title="Link to this definition">¶</a></dt>
<dd><p>Return the determinant of this matrix.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> – use <code class="docutils literal notranslate"><span class="pre">flint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> – let flint do the determinant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'padic'</span></code> – uses a <span class="math notranslate nohighlight">\(p\)</span>-adic / multimodular
algorithm that relies on code in IML and linbox</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'linbox'</span></code> – calls linbox det (you <em>must</em> set
proof=False to use this!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ntl'</span></code> – calls NTL’s det function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> – uses PARI</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – boolean or <code class="docutils literal notranslate"><span class="pre">None</span></code>; if <code class="docutils literal notranslate"><span class="pre">None</span></code> use
proof.linear_algebra(); only relevant for the padic algorithm</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>It would be <em>VERY VERY</em> hard for det to fail even with
proof=False.</p>
</div>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">stabilize</span></code> – if proof is <code class="docutils literal notranslate"><span class="pre">False</span></code>, require det to be the same
for this many CRT primes in a row. Ignored if proof is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<p>ALGORITHM: The <span class="math notranslate nohighlight">\(p\)</span>-adic algorithm works by first finding a random
vector v, then solving <span class="math notranslate nohighlight">\(Ax = v\)</span> and taking the denominator
<span class="math notranslate nohighlight">\(d\)</span>. This gives a divisor of the determinant. Then we
compute <span class="math notranslate nohighlight">\(\det(A)/d\)</span> using a multimodular algorithm and the
Hadamard bound, skipping primes that divide <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,[</span><span class="mf">3..66</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">66</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">D2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D1</span> <span class="o">==</span> <span class="n">D2</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D1</span> <span class="o">==</span> <span class="n">D2</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We have a special-case algorithm for 4 x 4 determinants:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">270</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">270</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Next we try the Linbox det. Note that we must have proof=False.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.libs.linbox</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">RuntimeError: you must pass the proof=False option to the determinant command to use LinBox&#39;s det algorithm</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">-21</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.libs.linbox</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">RuntimeError: you must pass the proof=False option to the determinant command to use LinBox&#39;s det algorithm</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">-21</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Try the other algorithms on the same example:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.linbox</span>
<span class="go">-21</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>                     <span class="c1"># needs sage.libs.pari</span>
<span class="go">-21</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.linbox</span>
<span class="go">-21</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.linbox</span>
<span class="go">-21</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>                     <span class="c1"># needs sage.libs.pari</span>
<span class="go">-21</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.linbox</span>
<span class="go">-21</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">A bigger example:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">,</span><span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">,</span><span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form">
<span class="sig-name descname"><span class="pre">echelon_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_zero_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L1632"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form" title="Link to this definition">¶</a></dt>
<dd><p>Return the echelon form of this matrix over the integers, also known
as the hermite normal form (HNF).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string; the algorithm to use. Valid options are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> – let Sage pick an algorithm (default).
Up to 75 rows or columns with no transformation matrix,
use pari with flag 0; otherwise, use flint.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> – use flint</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ntl'</span></code> – use NTL (only works for square matrices of
full rank!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'padic'</span></code> – an asymptotically fast <span class="math notranslate nohighlight">\(p\)</span>-adic modular
algorithm, If your matrix has large coefficients and is
small, you may also want to try this.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> – use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari0'</span></code> – use PARI with flag 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari1'</span></code> – use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari4'</span></code> – use PARI with flag 4 (use heuristic LLL)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) if proof=False certain
determinants are computed using a randomized hybrid <span class="math notranslate nohighlight">\(p\)</span>-adic
multimodular strategy until it stabilizes twice (instead of up to
the Hadamard bound). It is <em>incredibly</em> unlikely that one would
ever get an incorrect result with proof=False.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_zero_rows</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>,
don’t include zero rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – if given, also compute
transformation matrix; only valid for flint and padic algorithm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) if given and the algorithm
is <code class="docutils literal notranslate"><span class="pre">'ntl'</span></code>, then D must be a multiple of the determinant and this
function will use that fact</p></li>
</ul>
<p>OUTPUT:</p>
<p>The Hermite normal form (=echelon form over <span class="math notranslate nohighlight">\(\ZZ\)</span>) of <code class="docutils literal notranslate"><span class="pre">self</span></code> as
an immutable matrix.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">25</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Getting a transformation matrix in the nonsquare case:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..15</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">sage:</span> <span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">sage:</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If ‘ntl’ is chosen for a non square matrix this function
raises a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>.</p>
</div>
<p class="with-sage-tab with-python-tab">Special cases: 0 or 1 rows:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--25-input--1" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--25-input--2" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Illustrate using various algorithms.:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--26-input--1" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari0&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari4&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--26-input--2" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari0&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari4&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The ‘ntl’ algorithm doesn’t work on matrices that do not have full rank.:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--27-input--1" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="mf">2..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--27-input--2" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">+</span><span class="p">(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors">
<span class="sig-name descname"><span class="pre">elementary_divisors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="Link to this definition">¶</a></dt>
<dd><p>Return the elementary divisors of self, in order.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is MUCH faster than the <a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a> function.</p>
</div>
<p>The elementary divisors are the invariants of the finite abelian
group that is the cokernel of <em>left</em> multiplication of this matrix.
They are ordered in reverse by divisibility.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'pari'</span></code>)</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> – works robustly, but is slower.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'linbox'</span></code> – use linbox (currently off, broken)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>OUTPUT: list of integers</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="with-sage-tab with-python-tab">These are the invariants of the cokernel of <em>left</em> multiplication:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--28-input--1" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">M</span>
<span class="go">[3 0 1]</span>
<span class="go">[0 1 0]</span>
<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                                <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1]</span>
<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                    <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1, 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--28-input--2" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span>
<span class="go">[3 0 1]</span>
<span class="go">[0 1 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                                <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                    <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1, 0]</span>
</pre></div>
</div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--29-input--1" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">sage:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">)([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">C</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 1, 687]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--29-input--2" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">C</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 1, 687]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--30-input--1" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                               <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--30-input--2" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                               <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">This returns a copy, which is safe to change:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--31-input--1" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">edivs</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                       <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">edivs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>                                                           <span class="c1"># needs sage.libs.pari</span>
<span class="go">6</span>
<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                               <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--31-input--2" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">edivs</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                       <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">edivs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>                                                           <span class="c1"># needs sage.libs.pari</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>                                               <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius">
<span class="sig-name descname"><span class="pre">frobenius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L343"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius" title="Link to this definition">¶</a></dt>
<dd><p>Deprecated: Use <a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">frobenius_form()</span></code></a> instead.
See <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/36396">upstream Issue #36396</a> for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius_form">
<span class="sig-name descname"><span class="pre">frobenius_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2378"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius_form" title="Link to this definition">¶</a></dt>
<dd><p>Return the Frobenius form (rational canonical form) of this
matrix.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">flag</span></code> – 0 (default), 1 or 2 as follows:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">0</span></code> – (default) return the Frobenius form of this</dt><dd><p>matrix</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">1</span></code> – return only the elementary divisor</dt><dd><p>polynomials, as polynomials in var</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">2</span></code> – return a two-components vector [F,B] where F</dt><dd><p>is the Frobenius form and B is the basis change so that
<span class="math notranslate nohighlight">\(M=B^{-1}FB\)</span></p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">'x'</span></code>)</p></li>
</ul>
<p>ALGORITHM: uses PARI’s <a class="extlink-pari reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/matfrobenius">pari:matfrobenius</a></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--32-input--1" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 1  0 18]</span>
<span class="go">[ 0  1 12]</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[x^3 - 12*x^2 - 18*x]</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="go">[y^3 - 12*y^2 - 18*y]</span>
<span class="gp">sage:</span> <span class="n">F</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">==</span> <span class="n">B</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">B</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">([])</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([], [])</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: frobenius matrix of non-square matrix not defined.</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--32-input--2" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 1  0 18]</span>
<span class="go">[ 0  1 12]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[x^3 - 12*x^2 - 18*x]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="go">[y^3 - 12*y^2 - 18*y]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">==</span> <span class="n">B</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">B</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">([], [])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">frobenius_form</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: frobenius matrix of non-square matrix not defined.</span>
</pre></div>
</div>
</div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Martin Albrecht (2006-04-02)</p></li>
</ul>
<p>TODO: - move this to work for more general matrices than just over
Z. This will require fixing how PARI polynomials are coerced to
Sage polynomials.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd">
<span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5388"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd" title="Link to this definition">¶</a></dt>
<dd><p>Return the gcd of all entries of self; very fast.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--33-input--1" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--33-input--2" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">150</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.height">
<span class="sig-name descname"><span class="pre">height</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L1416"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.height" title="Link to this definition">¶</a></dt>
<dd><p>Return the height of this matrix, i.e., the max absolute value of
the entries of the matrix.</p>
<p>OUTPUT: nonnegative integer</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--34-input--1" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)([</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">389</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[ -17    3 -389]</span>
<span class="go">[  15   -1    0]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--34-input--2" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))([</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">389</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]);</span> <span class="n">a</span>
<span class="go">[ -17    3 -389]</span>
<span class="go">[  15   -1    0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form">
<span class="sig-name descname"><span class="pre">hermite_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_zero_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L1632"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form" title="Link to this definition">¶</a></dt>
<dd><p>Return the echelon form of this matrix over the integers, also known
as the hermite normal form (HNF).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string; the algorithm to use. Valid options are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> – let Sage pick an algorithm (default).
Up to 75 rows or columns with no transformation matrix,
use pari with flag 0; otherwise, use flint.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> – use flint</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ntl'</span></code> – use NTL (only works for square matrices of
full rank!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'padic'</span></code> – an asymptotically fast <span class="math notranslate nohighlight">\(p\)</span>-adic modular
algorithm, If your matrix has large coefficients and is
small, you may also want to try this.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> – use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari0'</span></code> – use PARI with flag 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari1'</span></code> – use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari4'</span></code> – use PARI with flag 4 (use heuristic LLL)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) if proof=False certain
determinants are computed using a randomized hybrid <span class="math notranslate nohighlight">\(p\)</span>-adic
multimodular strategy until it stabilizes twice (instead of up to
the Hadamard bound). It is <em>incredibly</em> unlikely that one would
ever get an incorrect result with proof=False.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_zero_rows</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>,
don’t include zero rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – if given, also compute
transformation matrix; only valid for flint and padic algorithm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) if given and the algorithm
is <code class="docutils literal notranslate"><span class="pre">'ntl'</span></code>, then D must be a multiple of the determinant and this
function will use that fact</p></li>
</ul>
<p>OUTPUT:</p>
<p>The Hermite normal form (=echelon form over <span class="math notranslate nohighlight">\(\ZZ\)</span>) of <code class="docutils literal notranslate"><span class="pre">self</span></code> as
an immutable matrix.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--35-input--1" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--35-input--2" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">25</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Getting a transformation matrix in the nonsquare case:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--36-input--1" name="tab-set--36" type="radio"><label class="tab-label" for="tab-set--36-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..15</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">sage:</span> <span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">sage:</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--36-input--2" name="tab-set--36" type="radio"><label class="tab-label" for="tab-set--36-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If ‘ntl’ is chosen for a non square matrix this function
raises a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>.</p>
</div>
<p class="with-sage-tab with-python-tab">Special cases: 0 or 1 rows:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--37-input--1" name="tab-set--37" type="radio"><label class="tab-label" for="tab-set--37-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--37-input--2" name="tab-set--37" type="radio"><label class="tab-label" for="tab-set--37-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Illustrate using various algorithms.:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--38-input--1" name="tab-set--38" type="radio"><label class="tab-label" for="tab-set--38-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari0&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari4&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--38-input--2" name="tab-set--38" type="radio"><label class="tab-label" for="tab-set--38-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>                    <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari0&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari4&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.linbox</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The ‘ntl’ algorithm doesn’t work on matrices that do not have full rank.:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--39-input--1" name="tab-set--39" type="radio"><label class="tab-label" for="tab-set--39-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="mf">2..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--39-input--2" name="tab-set--39" type="radio"><label class="tab-label" for="tab-set--39-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">+</span><span class="p">(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))))</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation">
<span class="sig-name descname"><span class="pre">index_in_saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation" title="Link to this definition">¶</a></dt>
<dd><p>Return the index of <code class="docutils literal notranslate"><span class="pre">self</span></code> in its saturation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – (default: use proof.linear_algebra());
if <code class="docutils literal notranslate"><span class="pre">False</span></code>, the determinant calculations are done with
<code class="docutils literal notranslate"><span class="pre">proof=False</span></code></p></li>
</ul>
<p>OUTPUT: positive integer; the index of the row span of
this matrix in its saturation</p>
<p>ALGORITHM:</p>
<p>Use Hermite normal form twice to find an invertible matrix whose
inverse transforms a matrix with the same row span as <code class="docutils literal notranslate"><span class="pre">self</span></code> to its
saturation, then compute the determinant of that matrix.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--40-input--1" name="tab-set--40" type="radio"><label class="tab-label" for="tab-set--40-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">()</span>
<span class="go">[1 2 3]</span>
<span class="go">[1 1 1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--40-input--2" name="tab-set--40" type="radio"><label class="tab-label" for="tab-set--40-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))));</span> <span class="n">A</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">()</span>
<span class="go">[1 2 3]</span>
<span class="go">[1 1 1]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row">
<span class="sig-name descname"><span class="pre">insert_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5216"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row" title="Link to this definition">¶</a></dt>
<dd><p>Create a new matrix from <code class="docutils literal notranslate"><span class="pre">self</span></code> with.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> – integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row</span></code> – a vector</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--41-input--1" name="tab-set--41" type="radio"><label class="tab-label" for="tab-set--41-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">X</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="go">[  1   5 -10]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--41-input--2" name="tab-set--41" type="radio"><label class="tab-label" for="tab-set--41-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)));</span> <span class="n">X</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="go">[  1   5 -10]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.integer_valued_polynomials_generators">
<span class="sig-name descname"><span class="pre">integer_valued_polynomials_generators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5749"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.integer_valued_polynomials_generators" title="Link to this definition">¶</a></dt>
<dd><p>Determine the generators of the ring of integer valued polynomials on this
matrix.</p>
<p>OUTPUT:</p>
<p>A pair <code class="docutils literal notranslate"><span class="pre">(mu_B,</span> <span class="pre">P)</span></code> where <code class="docutils literal notranslate"><span class="pre">P</span></code> is a list of polynomials in <span class="math notranslate nohighlight">\(\QQ[X]\)</span>
such that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\{f \in \QQ[X] \mid f(B) \in M_n(\ZZ)\}
    = \mu_B \QQ[X] + \sum_{g\in P} g \ZZ[X]\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is this matrix.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--42-input--1" name="tab-set--42" type="radio"><label class="tab-label" for="tab-set--42-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">integer_valued_polynomials_generators</span><span class="p">()</span>                             <span class="c1"># needs sage.libs.pari</span>
<span class="go">(x^3 + x^2 - 12*x - 20, [1, 1/4*x^2 + 3/4*x + 1/2])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--42-input--2" name="tab-set--42" type="radio"><label class="tab-label" for="tab-set--42-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">integer_valued_polynomials_generators</span><span class="p">()</span>                             <span class="c1"># needs sage.libs.pari</span>
<span class="go">(x^3 + x^2 - 12*x - 20, [1, 1/4*x^2 + 3/4*x + 1/2])</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="compute_J_ideal.html#module-sage.matrix.compute_J_ideal" title="sage.matrix.compute_J_ideal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">compute_J_ideal</span></code></a>,
<a class="reference internal" href="compute_J_ideal.html#sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.integer_valued_polynomials_generators" title="sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.integer_valued_polynomials_generators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integer_valued_polynomials_generators()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.inverse_of_unit">
<span class="sig-name descname"><span class="pre">inverse_of_unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L4032"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.inverse_of_unit" title="Link to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> is a matrix with determinant <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span> return the inverse of
<code class="docutils literal notranslate"><span class="pre">self</span></code> as a matrix over <span class="math notranslate nohighlight">\(ZZ\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--43-input--1" name="tab-set--43" type="radio"><label class="tab-label" for="tab-set--43-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">m</span>
<span class="go">[ 1 -1]</span>
<span class="go">[-1  2]</span>
<span class="gp">sage:</span> <span class="n">parent</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Integer Ring</span>

<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: non-invertible matrix</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--43-input--2" name="tab-set--43" type="radio"><label class="tab-label" for="tab-set--43-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="go">[ 1 -1]</span>
<span class="go">[-1  2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">parent</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Integer Ring</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: non-invertible matrix</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced">
<span class="sig-name descname"><span class="pre">is_LLL_reduced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fpLLL'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L3226"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this lattice is <span class="math notranslate nohighlight">\((\delta, \eta)\)</span>-LLL reduced.
See <code class="docutils literal notranslate"><span class="pre">self.LLL</span></code> for a definition of LLL reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – (default: <span class="math notranslate nohighlight">\(0.99\)</span>) parameter <span class="math notranslate nohighlight">\(\delta\)</span> as described above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eta</span></code> – (default: <span class="math notranslate nohighlight">\(0.501\)</span>) parameter <span class="math notranslate nohighlight">\(\eta\)</span> as described above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – either <code class="docutils literal notranslate"><span class="pre">'fpLLL'</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">'sage'</span></code></p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--44-input--1" name="tab-set--44" type="radio"><label class="tab-label" for="tab-set--44-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs fpylll</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--44-input--2" name="tab-set--44" type="radio"><label class="tab-label" for="tab-set--44-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs fpylll</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The <code class="docutils literal notranslate"><span class="pre">'sage'</span></code> algorithm currently does not work for matrices with
linearly dependent rows:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--45-input--1" name="tab-set--45" type="radio"><label class="tab-label" for="tab-set--45-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: linearly dependent input for module version of Gram-Schmidt</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--45-input--2" name="tab-set--45" type="radio"><label class="tab-label" for="tab-set--45-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: linearly dependent input for module version of Gram-Schmidt</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_one">
<span class="sig-name descname"><span class="pre">is_one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L649"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_one" title="Link to this definition">¶</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is the identity matrix.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--46-input--1" name="tab-set--46" type="radio"><label class="tab-label" for="tab-set--46-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--46-input--2" name="tab-set--46" type="radio"><label class="tab-label" for="tab-set--46-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_primitive">
<span class="sig-name descname"><span class="pre">is_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L1046"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_primitive" title="Link to this definition">¶</a></dt>
<dd><p>Test whether the matrix is primitive.</p>
<p>An integral matrix <span class="math notranslate nohighlight">\(A\)</span> is primitive if all its entries are nonnegative
and for some positive integer <span class="math notranslate nohighlight">\(n\)</span> the matrix <span class="math notranslate nohighlight">\(A^n\)</span> has all its
entries positive.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--47-input--1" name="tab-set--47" type="radio"><label class="tab-label" for="tab-set--47-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">**</span><span class="mi">4</span>
<span class="go">[3 2 1]</span>
<span class="go">[1 1 1]</span>
<span class="go">[2 1 1]</span>

<span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">**</span><span class="mi">6</span>
<span class="go">[4 3 2 1]</span>
<span class="go">[1 1 1 1]</span>
<span class="go">[2 1 1 1]</span>
<span class="go">[3 2 1 1]</span>

<span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--47-input--2" name="tab-set--47" type="radio"><label class="tab-label" for="tab-set--47-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[3 2 1]</span>
<span class="go">[1 1 1]</span>
<span class="go">[2 1 1]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[4 3 2 1]</span>
<span class="go">[1 1 1 1]</span>
<span class="go">[2 1 1 1]</span>
<span class="go">[3 2 1 1]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Testing extremal matrices:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--48-input--1" name="tab-set--48" type="radio"><label class="tab-label" for="tab-set--48-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="k">def</span> <span class="nf">matrix1</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....:</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....:</span>         <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....:</span>     <span class="k">return</span> <span class="n">m</span>
<span class="gp">sage:</span> <span class="nb">all</span><span class="p">(</span><span class="n">matrix1</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage:</span> <span class="k">def</span> <span class="nf">matrix2</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....:</span>         <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....:</span>     <span class="n">m</span><span class="p">[</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....:</span>     <span class="k">return</span> <span class="n">m</span>
<span class="gp">sage:</span> <span class="nb">all</span><span class="p">(</span><span class="n">matrix2</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--48-input--2" name="tab-set--48" type="radio"><label class="tab-label" for="tab-set--48-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">matrix1</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">...</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">...</span>     <span class="n">m</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
<span class="gp">...</span>         <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>     <span class="k">return</span> <span class="n">m</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">all</span><span class="p">(</span><span class="n">matrix1</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">matrix2</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">...</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">...</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
<span class="gp">...</span>         <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>     <span class="n">m</span><span class="p">[</span><span class="n">d</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">d</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>     <span class="k">return</span> <span class="n">m</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">all</span><span class="p">(</span><span class="n">matrix2</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Non-primitive families:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--49-input--1" name="tab-set--49" type="radio"><label class="tab-label" for="tab-set--49-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="k">def</span> <span class="nf">matrix3</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....:</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....:</span>         <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....:</span>     <span class="k">return</span> <span class="n">m</span>
<span class="gp">sage:</span> <span class="nb">any</span><span class="p">(</span><span class="n">matrix3</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--49-input--2" name="tab-set--49" type="radio"><label class="tab-label" for="tab-set--49-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">matrix3</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">...</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">...</span>     <span class="n">m</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
<span class="gp">...</span>         <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>     <span class="k">return</span> <span class="n">m</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">any</span><span class="p">(</span><span class="n">matrix3</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly">
<span class="sig-name descname"><span class="pre">minpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L1330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly" title="Link to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – a variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – either <code class="docutils literal notranslate"><span class="pre">'linbox'</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">'generic'</span></code></p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--50-input--1" name="tab-set--50" type="radio"><label class="tab-label" for="tab-set--50-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>                                                           <span class="c1"># needs sage.libs.pari</span>
<span class="go">x^3 - 105*x^2 - 630*x</span>

<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">6</span><span class="p">)([</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">)])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">)</span>                                         <span class="c1"># needs sage.libs.linbox</span>
<span class="go">x^4 - 2695*x^3 - 257964*x^2 + 1693440*x</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">)</span>                                        <span class="c1"># needs sage.libs.pari</span>
<span class="go">x^4 - 2695*x^3 - 257964*x^2 + 1693440*x</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--50-input--2" name="tab-set--50" type="radio"><label class="tab-label" for="tab-set--50-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">36</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>                                                           <span class="c1"># needs sage.libs.pari</span>
<span class="go">x^3 - 105*x^2 - 630*x</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))([</span><span class="n">k</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">36</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">)</span>                                         <span class="c1"># needs sage.libs.linbox</span>
<span class="go">x^4 - 2695*x^3 - 257964*x^2 + 1693440*x</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">)</span>                                        <span class="c1"># needs sage.libs.pari</span>
<span class="go">x^4 - 2695*x^3 - 257964*x^2 + 1693440*x</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">On non square matrices, this method raises an ArithmeticError:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--51-input--1" name="tab-set--51" type="radio"><label class="tab-label" for="tab-set--51-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: only valid for square matrix</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--51-input--2" name="tab-set--51" type="radio"><label class="tab-label" for="tab-set--51-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ArithmeticError: only valid for square matrix</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.null_ideal">
<span class="sig-name descname"><span class="pre">null_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5710"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.null_ideal" title="Link to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\((b)\)</span>-ideal of this matrix.</p>
<p>Let <span class="math notranslate nohighlight">\(B\)</span> be a <span class="math notranslate nohighlight">\(n \times n\)</span> matrix. The <em>null ideal</em> modulo <span class="math notranslate nohighlight">\(b\)</span>,
or <span class="math notranslate nohighlight">\((b)\)</span>-ideal, is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[N_{(b)}(B) = \{f \in \ZZ[X] \mid f(B) \in M_n(b\ZZ)\}.\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> – an element of <span class="math notranslate nohighlight">\(\ZZ\)</span> (default: 0)</p></li>
</ul>
<p>OUTPUT: an ideal in <span class="math notranslate nohighlight">\(\ZZ[X]\)</span></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--52-input--1" name="tab-set--52" type="radio"><label class="tab-label" for="tab-set--52-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (x^3 + x^2 - 12*x - 20) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Ideal (8, x^3 + x^2 - 12*x - 20, 2*x^2 + 6*x + 4) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">Ideal (6, 2*x^3 + 2*x^2 - 24*x - 40, 3*x^2 + 3*x) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--52-input--2" name="tab-set--52" type="radio"><label class="tab-label" for="tab-set--52-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (x^3 + x^2 - 12*x - 20) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">Ideal (8, x^3 + x^2 - 12*x - 20, 2*x^2 + 6*x + 4) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="go">Ideal (6, 2*x^3 + 2*x^2 - 24*x - 40, 3*x^2 + 3*x) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="compute_J_ideal.html#module-sage.matrix.compute_J_ideal" title="sage.matrix.compute_J_ideal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">compute_J_ideal</span></code></a>,
<a class="reference internal" href="compute_J_ideal.html#sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.null_ideal" title="sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.null_ideal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">null_ideal()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.p_minimal_polynomials">
<span class="sig-name descname"><span class="pre">p_minimal_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5657"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.p_minimal_polynomials" title="Link to this definition">¶</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials <span class="math notranslate nohighlight">\(\nu_s\)</span> of this matrix.</p>
<p>For <span class="math notranslate nohighlight">\(s  \ge 0\)</span>, a <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomial of
a matrix <span class="math notranslate nohighlight">\(B\)</span> is a monic polynomial <span class="math notranslate nohighlight">\(f \in \ZZ[X]\)</span> of
minimal degree such that all entries of <span class="math notranslate nohighlight">\(f(B)\)</span> are divisible
by <span class="math notranslate nohighlight">\(p^s\)</span>.</p>
<p>Compute a finite subset <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> of the positive
integers and <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials
<span class="math notranslate nohighlight">\(\nu_s\)</span> for <span class="math notranslate nohighlight">\(s \in \mathcal{S}\)</span>.</p>
<p>For <span class="math notranslate nohighlight">\(0 &lt; t \le \max \mathcal{S}\)</span>, a <span class="math notranslate nohighlight">\((p^t)\)</span>-minimal polynomial is
given by <span class="math notranslate nohighlight">\(\nu_s\)</span> where
<span class="math notranslate nohighlight">\(s = \min\{ r \in \mathcal{S} \mid r\ge t \}\)</span>.
For <span class="math notranslate nohighlight">\(t &gt; \max\mathcal{S}\)</span>, the minimal polynomial of <span class="math notranslate nohighlight">\(B\)</span> is
also a <span class="math notranslate nohighlight">\((p^t)\)</span>-minimal polynomial.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime in <span class="math notranslate nohighlight">\(\ZZ\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s_max</span></code> – positive integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if set, only
<span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials for <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">&lt;=</span> <span class="pre">s_max</span></code> are computed
(see below for details)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A dictionary. Keys are the finite set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, the
values are the associated <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials <span class="math notranslate nohighlight">\(\nu_s\)</span>,
<span class="math notranslate nohighlight">\(s\in\mathcal{S}\)</span>.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">s_max</span></code> only affects the output if <code class="docutils literal notranslate"><span class="pre">s_max</span></code> is at
most <span class="math notranslate nohighlight">\(\max\mathcal{S}\)</span> where <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> denotes the full
set. In that case, only those <span class="math notranslate nohighlight">\(\nu_s\)</span> with <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">&lt;=</span> <span class="pre">s_max</span></code> are
returned where <code class="docutils literal notranslate"><span class="pre">s_max</span></code> is always included even if it is not
included in the full set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--53-input--1" name="tab-set--53" type="radio"><label class="tab-label" for="tab-set--53-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">p_minimal_polynomials</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                            <span class="c1"># needs sage.libs.pari</span>
<span class="go">{2: x^2 + 3*x + 2}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--53-input--2" name="tab-set--53" type="radio"><label class="tab-label" for="tab-set--53-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">p_minimal_polynomials</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>                                            <span class="c1"># needs sage.libs.pari</span>
<span class="go">{2: x^2 + 3*x + 2}</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="compute_J_ideal.html#module-sage.matrix.compute_J_ideal" title="sage.matrix.compute_J_ideal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">compute_J_ideal</span></code></a>,
<a class="reference internal" href="compute_J_ideal.html#sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.p_minimal_polynomials" title="sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.p_minimal_polynomials"><code class="xref py py-meth docutils literal notranslate"><span class="pre">p_minimal_polynomials()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots">
<span class="sig-name descname"><span class="pre">pivots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2140"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots" title="Link to this definition">¶</a></dt>
<dd><p>Return the pivot column positions of this matrix.</p>
<p>OUTPUT: a tuple of Python integers: the position of the
first nonzero entry in each row of the echelon form.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--54-input--1" name="tab-set--54" type="radio"><label class="tab-label" for="tab-set--54-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 3  0 -3]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--54-input--2" name="tab-set--54" type="radio"><label class="tab-label" for="tab-set--54-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 3  0 -3]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums">
<span class="sig-name descname"><span class="pre">prod_of_row_sums</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L3293"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums" title="Link to this definition">¶</a></dt>
<dd><p>Return the product of the sums of the entries in the submatrix of
<code class="docutils literal notranslate"><span class="pre">self</span></code> with given columns.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cols</span></code> – list (or set) of integers representing columns
of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>OUTPUT: integer</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--55-input--1" name="tab-set--55" type="radio"><label class="tab-label" for="tab-set--55-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..6</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">40</span>
<span class="gp">sage:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<span class="go">40</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">40</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--55-input--2" name="tab-set--55" type="radio"><label class="tab-label" for="tab-set--55-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))));</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">40</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="go">40</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]))</span>
<span class="go">40</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize">
<span class="sig-name descname"><span class="pre">randomize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonzero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L3384"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize" title="Link to this definition">¶</a></dt>
<dd><p>Randomize <code class="docutils literal notranslate"><span class="pre">density</span></code> proportion of the entries of this matrix,
leaving the rest unchanged.</p>
<p>The parameters are the same as the ones for the integer ring’s
<code class="docutils literal notranslate"><span class="pre">random_element</span></code> function.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are given, randomized entries of this matrix have
to be between <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and have density 1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a mutable matrix over ZZ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">density</span></code> – a float between 0 and 1</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> – if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, these are passed to the</dt><dd><p><code class="docutils literal notranslate"><span class="pre">ZZ.random_element</span></code> function as the upper and lower endpoints in
the  uniform distribution</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">distribution</span></code> – would also be passed into <code class="docutils literal notranslate"><span class="pre">ZZ.random_element</span></code>
if given</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nonzero</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether the new entries
are guaranteed to be zero</p></li>
</ul>
<p>OUTPUT: None, the matrix is modified in-place</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--56-input--1" name="tab-set--56" type="radio"><label class="tab-label" for="tab-set--56-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>
<span class="gp">....:</span>    <span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">()</span>
<span class="gp">....:</span>    <span class="n">ranks</span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">rank</span><span class="p">()]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="gp">sage:</span> <span class="n">mini</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage:</span> <span class="n">maxi</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage:</span> <span class="k">while</span> <span class="n">mini</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">30</span> <span class="ow">and</span> <span class="n">maxi</span> <span class="o">!=</span> <span class="mi">30</span><span class="p">:</span>
<span class="gp">....:</span>     <span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="n">mini</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">list</span><span class="p">()),</span> <span class="n">mini</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="n">maxi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">list</span><span class="p">()),</span> <span class="n">maxi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--56-input--2" name="tab-set--56" type="radio"><label class="tab-label" for="tab-set--56-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>
<span class="gp">...</span>    <span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">()</span>
<span class="gp">...</span>    <span class="n">ranks</span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">rank</span><span class="p">()]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">mini</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">maxi</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="n">mini</span> <span class="o">!=</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="ow">and</span> <span class="n">maxi</span> <span class="o">!=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
<span class="gp">...</span>     <span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="gp">...</span>     <span class="n">mini</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">list</span><span class="p">()),</span> <span class="n">mini</span><span class="p">)</span>
<span class="gp">...</span>     <span class="n">maxi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">list</span><span class="p">()),</span> <span class="n">maxi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'modp'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L3494"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank" title="Link to this definition">¶</a></dt>
<dd><p>Return the rank of this matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – either <code class="docutils literal notranslate"><span class="pre">'modp'</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">'flint'</span></code>
or <code class="docutils literal notranslate"><span class="pre">'linbox'</span></code></p></li>
</ul>
<p>OUTPUT: nonnegative integer – the rank</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The rank is cached.</p>
</div>
<p>ALGORITHM:</p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">'modp'</span></code>, first check if the matrix has maximum
possible rank by working modulo one random prime. If not, call
LinBox’s rank function.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--57-input--1" name="tab-set--57" type="radio"><label class="tab-label" for="tab-set--57-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..6</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="go">[7 8 9]</span>
<span class="gp">sage:</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--57-input--2" name="tab-set--57" type="radio"><label class="tab-label" for="tab-set--57-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))));</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))));</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="go">[7 8 9]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Here is a bigger example - the rank is of course still 2:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--58-input--1" name="tab-set--58" type="radio"><label class="tab-label" for="tab-set--58-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">100</span><span class="p">,[</span><span class="mf">1..100</span><span class="o">^</span><span class="mi">2</span><span class="p">]);</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--58-input--2" name="tab-set--58" type="radio"><label class="tab-label" for="tab-set--58-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">),(</span><span class="n">ellipsis_range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">Ellipsis</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))));</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction">
<span class="sig-name descname"><span class="pre">rational_reconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L3337"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction" title="Link to this definition">¶</a></dt>
<dd><p>Use rational reconstruction to lift <code class="docutils literal notranslate"><span class="pre">self</span></code> to a matrix over the
rational numbers (if possible), where we view <code class="docutils literal notranslate"><span class="pre">self</span></code> as a matrix
modulo N.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> – integer</p></li>
</ul>
<p>OUTPUT: matrix over <span class="math notranslate nohighlight">\(\QQ\)</span> or raise a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a></p>
<p class="with-sage-tab with-python-tab">EXAMPLES: We create a random 4x4 matrix over ZZ.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--59-input--1" name="tab-set--59" type="radio"><label class="tab-label" for="tab-set--59-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--59-input--2" name="tab-set--59" type="radio"><label class="tab-label" for="tab-set--59-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">There isn’t a unique rational reconstruction of it:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--60-input--1" name="tab-set--60" type="radio"><label class="tab-label" for="tab-set--60-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: rational reconstruction does not exist</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--60-input--2" name="tab-set--60" type="radio"><label class="tab-label" for="tab-set--60-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: rational reconstruction does not exist</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We throw in a denominator and reduce the matrix modulo 389 - it
does rationally reconstruct.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--61-input--1" name="tab-set--61" type="radio"><label class="tab-label" for="tab-set--61-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="mi">3</span> <span class="o">%</span> <span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">/</span><span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--61-input--2" name="tab-set--61" type="radio"><label class="tab-label" for="tab-set--61-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">389</span><span class="p">))</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">389</span><span class="p">))</span> <span class="o">==</span> <span class="n">A</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.row">
<span class="sig-name descname"><span class="pre">row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L4989"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.row" title="Link to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(i\)</span>-th row of this matrix as a dense vector.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_list</span></code> – ignored</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--62-input--1" name="tab-set--62" type="radio"><label class="tab-label" for="tab-set--62-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1, -2)</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(3, 4)</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">from_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(3, 4)</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, -2)</span>

<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: row index out of range</span>
<span class="gp">sage:</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: row index out of range</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--62-input--2" name="tab-set--62" type="radio"><label class="tab-label" for="tab-set--62-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">(1, -2)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(3, 4)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">from_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(3, 4)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(1, -2)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: row index out of range</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">IndexError: row index out of range</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation">
<span class="sig-name descname"><span class="pre">saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2025"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation" title="Link to this definition">¶</a></dt>
<dd><p>Return a saturation matrix of self, which is a matrix whose rows
span the saturation of the row span of <code class="docutils literal notranslate"><span class="pre">self</span></code>. This is not unique.</p>
<p>The saturation of a <span class="math notranslate nohighlight">\(\ZZ\)</span> module <span class="math notranslate nohighlight">\(M\)</span>
embedded in <span class="math notranslate nohighlight">\(\ZZ^n\)</span> is a module <span class="math notranslate nohighlight">\(S\)</span> that
contains <span class="math notranslate nohighlight">\(M\)</span> with finite index such that
<span class="math notranslate nohighlight">\(\ZZ^n/S\)</span> is torsion free. This function takes the
row span <span class="math notranslate nohighlight">\(M\)</span> of self, and finds another matrix of full rank
with row span the saturation of <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – (default: 0) if nonzero given, saturate
only at the prime <span class="math notranslate nohighlight">\(p\)</span>, i.e., return a matrix whose row span
is a <span class="math notranslate nohighlight">\(\ZZ\)</span>-module <span class="math notranslate nohighlight">\(S\)</span> that contains <code class="docutils literal notranslate"><span class="pre">self</span></code> and
such that the index of <span class="math notranslate nohighlight">\(S\)</span> in its saturation is coprime to
<span class="math notranslate nohighlight">\(p\)</span>. If <span class="math notranslate nohighlight">\(p\)</span> is None, return full saturation of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – (default: use proof.linear_algebra());
if <code class="docutils literal notranslate"><span class="pre">False</span></code>, the determinant calculations are done with
<code class="docutils literal notranslate"><span class="pre">proof=False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_dets</span></code> – (default: 5) technical parameter -
max number of determinant to compute when bounding prime divisor of
<code class="docutils literal notranslate"><span class="pre">self</span></code> in its saturation.</p></li>
</ul>
<p>OUTPUT: matrix over ZZ</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The result is <em>not</em> cached.</p>
</div>
<p>ALGORITHM: 1. Replace input by a matrix of full rank got from a
subset of the rows. 2. Divide out any common factors from rows. 3.
Check max_dets random dets of submatrices to see if their GCD
(with p) is 1 - if so matrix is saturated and we’re done. 4.
Finally, use that if A is a matrix of full rank, then
<span class="math notranslate nohighlight">\(hnf(transpose(A))^{-1}*A\)</span> is a saturation of A.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--63-input--1" name="tab-set--63" type="radio"><label class="tab-label" for="tab-set--63-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">51</span><span class="p">,</span> <span class="o">-</span><span class="mi">1509</span><span class="p">,</span> <span class="o">-</span><span class="mi">71</span><span class="p">,</span> <span class="o">-</span><span class="mi">109</span><span class="p">,</span> <span class="o">-</span><span class="mi">593</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">341</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">246</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">217</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[      1       5    2262   20364   56576]</span>
<span class="go">[      0       6   35653  320873  891313]</span>
<span class="go">[      0       0   42993  386937 1074825]</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">();</span> <span class="n">S</span>
<span class="go">[  -51 -1509   -71  -109  -593]</span>
<span class="go">[  -19  -341     4    86    98]</span>
<span class="go">[   35   994    43    51   347]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--63-input--2" name="tab-set--63" type="radio"><label class="tab-label" for="tab-set--63-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">51</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1509</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">71</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">109</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">593</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">341</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">86</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">98</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">246</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">65</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">217</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[      1       5    2262   20364   56576]</span>
<span class="go">[      0       6   35653  320873  891313]</span>
<span class="go">[      0       0   42993  386937 1074825]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">();</span> <span class="n">S</span>
<span class="go">[  -51 -1509   -71  -109  -593]</span>
<span class="go">[  -19  -341     4    86    98]</span>
<span class="go">[   35   994    43    51   347]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Notice that the saturation spans a different module than A.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--64-input--1" name="tab-set--64" type="radio"><label class="tab-label" for="tab-set--64-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  2  0  8 32]</span>
<span class="go">[ 0  3  0 -2 -6]</span>
<span class="go">[ 0  0  1  9 25]</span>
<span class="gp">sage:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">();</span> <span class="n">W</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">V</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">V</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">85986</span>
<span class="gp">sage:</span> <span class="n">V</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">85986</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--64-input--2" name="tab-set--64" type="radio"><label class="tab-label" for="tab-set--64-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  2  0  8 32]</span>
<span class="go">[ 0  3  0 -2 -6]</span>
<span class="go">[ 0  0  1  9 25]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">();</span> <span class="n">W</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">85986</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">85986</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We illustrate each option:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--65-input--1" name="tab-set--65" type="radio"><label class="tab-label" for="tab-set--65-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">max_dets</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--65-input--2" name="tab-set--65" type="radio"><label class="tab-label" for="tab-set--65-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">max_dets</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form">
<span class="sig-name descname"><span class="pre">smith_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L2270"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="Link to this definition">¶</a></dt>
<dd><p>Return the smith normal form of this matrix, that is the diagonal
matrix <span class="math notranslate nohighlight">\(S\)</span> with diagonal entries the ordered elementary divisors of
this matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to
return the transformation matrices <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> such that <span class="math notranslate nohighlight">\(S=U\cdot
self\cdot V\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">integral</span></code> – a subring of the base ring or <code class="docutils literal notranslate"><span class="pre">True</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>); ignored for matrices with integer entries</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">elementary_divisors()</span></code></a> function, which returns the diagonal
entries of <span class="math notranslate nohighlight">\(S\)</span>, is VASTLY faster than this function.</p>
</div>
<p>The elementary divisors are the invariants of the finite abelian
group that is the cokernel of this matrix. They are ordered in
reverse by divisibility.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--66-input--1" name="tab-set--66" type="radio"><label class="tab-label" for="tab-set--66-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">D</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage:</span> <span class="n">U</span>
<span class="go">[ 0  2 -1]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage:</span> <span class="n">V</span>
<span class="go">[ 0  0  1]</span>
<span class="go">[-1  2 -2]</span>
<span class="go">[ 1 -1  1]</span>
<span class="gp">sage:</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">V</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--66-input--2" name="tab-set--66" type="radio"><label class="tab-label" for="tab-set--66-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span>
<span class="go">[ 0  2 -1]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span>
<span class="go">[ 0  0  1]</span>
<span class="go">[-1  2 -2]</span>
<span class="go">[ 1 -1  1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">V</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">It also makes sense for nonsquare matrices:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--67-input--1" name="tab-set--67" type="radio"><label class="tab-label" for="tab-set--67-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">D</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
<span class="gp">sage:</span> <span class="n">U</span>
<span class="go">[ 0  2 -1]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage:</span> <span class="n">V</span>
<span class="go">[-1  1]</span>
<span class="go">[ 1  0]</span>
<span class="gp">sage:</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">V</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--67-input--2" name="tab-set--67" type="radio"><label class="tab-label" for="tab-set--67-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span>
<span class="go">[ 0  2 -1]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">V</span>
<span class="go">[-1  1]</span>
<span class="go">[ 1  0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">V</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Empty matrices are handled sensibly (see <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/3068">upstream Issue #3068</a>):</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--68-input--1" name="tab-set--68" type="radio"><label class="tab-label" for="tab-set--68-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--68-input--2" name="tab-set--68" type="radio"><label class="tab-label" for="tab-set--68-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.libs.pari</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">elementary_divisors()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form">
<span class="sig-name descname"><span class="pre">symplectic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L1568"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form" title="Link to this definition">¶</a></dt>
<dd><p>Find a symplectic basis for <code class="docutils literal notranslate"><span class="pre">self</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is an anti-symmetric,
alternating matrix.</p>
<p>Return a pair (F, C) such that the rows of C form a symplectic
basis for <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">F</span> <span class="pre">=</span> <span class="pre">C</span> <span class="pre">*</span> <span class="pre">self</span> <span class="pre">*</span> <span class="pre">C.transpose()</span></code>.</p>
<p>Raise a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is not anti-symmetric,
or <code class="docutils literal notranslate"><span class="pre">self</span></code> is not alternating.</p>
<p>Anti-symmetric means that <span class="math notranslate nohighlight">\(M = -M^t\)</span>. Alternating means
that the diagonal of <span class="math notranslate nohighlight">\(M\)</span> is identically zero.</p>
<p>A symplectic basis is a basis of the form
<span class="math notranslate nohighlight">\(e_1, \ldots, e_j, f_1, \ldots f_j, z_1, \dots, z_k\)</span>
such that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z_i M v^t = 0\)</span> for all vectors <span class="math notranslate nohighlight">\(v\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(e_i M {e_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i, j\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_i M {f_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i, j\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(e_i M {f_i}^t = 1\)</span> for all <span class="math notranslate nohighlight">\(i\)</span></p></li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(e_i M {f_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i\)</span> not equal</dt><dd><p><span class="math notranslate nohighlight">\(j\)</span>.</p>
</dd>
</dl>
</li>
</ul>
<p>The ordering for the factors <span class="math notranslate nohighlight">\(d_{i} | d_{i+1}\)</span> and for
the placement of zeroes was chosen to agree with the output of
<a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a>.</p>
<p>See the example for a pictorial description of such a basis.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--69-input--1" name="tab-set--69" type="radio"><label class="tab-label" for="tab-set--69-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">[  0  14   0  -8  -2]</span>
<span class="go">[-14   0  -3 -11   4]</span>
<span class="go">[  0   3   0   0   0]</span>
<span class="go">[  8  11   0   0   8]</span>
<span class="go">[  2  -4   0  -8   0]</span>
<span class="gp">sage:</span> <span class="n">F</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">symplectic_form</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">F</span>
<span class="go">[ 0  0  1  0  0]</span>
<span class="go">[ 0  0  0  2  0]</span>
<span class="go">[-1  0  0  0  0]</span>
<span class="go">[ 0 -2  0  0  0]</span>
<span class="go">[ 0  0  0  0  0]</span>
<span class="gp">sage:</span> <span class="n">F</span> <span class="o">==</span> <span class="n">C</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>                                                     <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 2 0 0]</span>
<span class="go">[0 0 0 2 0]</span>
<span class="go">[0 0 0 0 0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--69-input--2" name="tab-set--69" type="radio"><label class="tab-label" for="tab-set--69-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]);</span> <span class="n">E</span>
<span class="go">[  0  14   0  -8  -2]</span>
<span class="go">[-14   0  -3 -11   4]</span>
<span class="go">[  0   3   0   0   0]</span>
<span class="go">[  8  11   0   0   8]</span>
<span class="go">[  2  -4   0  -8   0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">symplectic_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span>
<span class="go">[ 0  0  1  0  0]</span>
<span class="go">[ 0  0  0  2  0]</span>
<span class="go">[-1  0  0  0  0]</span>
<span class="go">[ 0 -2  0  0  0]</span>
<span class="go">[ 0  0  0  0  0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">==</span> <span class="n">C</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>                                                     <span class="c1"># needs sage.libs.pari</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 2 0 0]</span>
<span class="go">[0 0 0 2 0]</span>
<span class="go">[0 0 0 0 0]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/matrix/matrix_integer_dense.pyx#L5462"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose" title="Link to this definition">¶</a></dt>
<dd><p>Return the transpose of self, without changing <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">We create a matrix, compute its transpose, and note that the
original matrix is not changed.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--70-input--1" name="tab-set--70" type="radio"><label class="tab-label" for="tab-set--70-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
<span class="gp">sage:</span> <span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--70-input--2" name="tab-set--70" type="radio"><label class="tab-label" for="tab-set--70-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"><code class="docutils literal notranslate"><span class="pre">.T</span></code> is a convenient shortcut for the transpose:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--71-input--1" name="tab-set--71" type="radio"><label class="tab-label" for="tab-set--71-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--71-input--2" name="tab-set--71" type="radio"><label class="tab-label" for="tab-set--71-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--72-input--1" name="tab-set--72" type="radio"><label class="tab-label" for="tab-set--72-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[0|1 2]</span>
<span class="go">[3|4 5]</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[0 3]</span>
<span class="go">[---]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--72-input--2" name="tab-set--72" type="radio"><label class="tab-label" for="tab-set--72-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0|1 2]</span>
<span class="go">[3|4 5]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[0 3]</span>
<span class="go">[---]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="matrix_integer_sparse.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Sparse integer matrices</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="matrix_generic_sparse.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Sparse Matrices over a general ring</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2025, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Dense matrices over the integer ring</a><ul>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense"><code class="docutils literal notranslate"><span class="pre">Matrix_integer_dense</span></code></a><ul>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ"><code class="docutils literal notranslate"><span class="pre">BKZ()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL"><code class="docutils literal notranslate"><span class="pre">LLL()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose"><code class="docutils literal notranslate"><span class="pre">antitranspose()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment"><code class="docutils literal notranslate"><span class="pre">augment()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly"><code class="docutils literal notranslate"><span class="pre">charpoly()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.column"><code class="docutils literal notranslate"><span class="pre">column()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition"><code class="docutils literal notranslate"><span class="pre">decomposition()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant"><code class="docutils literal notranslate"><span class="pre">determinant()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form"><code class="docutils literal notranslate"><span class="pre">echelon_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors"><code class="docutils literal notranslate"><span class="pre">elementary_divisors()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius"><code class="docutils literal notranslate"><span class="pre">frobenius()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius_form"><code class="docutils literal notranslate"><span class="pre">frobenius_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.height"><code class="docutils literal notranslate"><span class="pre">height()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form"><code class="docutils literal notranslate"><span class="pre">hermite_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation"><code class="docutils literal notranslate"><span class="pre">index_in_saturation()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row"><code class="docutils literal notranslate"><span class="pre">insert_row()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.integer_valued_polynomials_generators"><code class="docutils literal notranslate"><span class="pre">integer_valued_polynomials_generators()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.inverse_of_unit"><code class="docutils literal notranslate"><span class="pre">inverse_of_unit()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced"><code class="docutils literal notranslate"><span class="pre">is_LLL_reduced()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_one"><code class="docutils literal notranslate"><span class="pre">is_one()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_primitive"><code class="docutils literal notranslate"><span class="pre">is_primitive()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly"><code class="docutils literal notranslate"><span class="pre">minpoly()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.null_ideal"><code class="docutils literal notranslate"><span class="pre">null_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.p_minimal_polynomials"><code class="docutils literal notranslate"><span class="pre">p_minimal_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots"><code class="docutils literal notranslate"><span class="pre">pivots()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums"><code class="docutils literal notranslate"><span class="pre">prod_of_row_sums()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize"><code class="docutils literal notranslate"><span class="pre">randomize()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank"><code class="docutils literal notranslate"><span class="pre">rank()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction"><code class="docutils literal notranslate"><span class="pre">rational_reconstruction()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.row"><code class="docutils literal notranslate"><span class="pre">row()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation"><code class="docutils literal notranslate"><span class="pre">saturation()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="docutils literal notranslate"><span class="pre">smith_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form"><code class="docutils literal notranslate"><span class="pre">symplectic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose"><code class="docutils literal notranslate"><span class="pre">transpose()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../%5fstatic/documentation_options.js"></script>
    <script src="../../../%5fstatic/doctools.js"></script>
    <script src="../../../%5fstatic/sphinx_highlight.js"></script>
    <script src="../../../%5fstatic/scripts/furo.js"></script>
    <script src="../../../%5fstatic/clipboard.min.js"></script>
    <script src="../../../%5fstatic/copybutton.js"></script>
    <script src="../../../%5fstatic/tabs.js"></script>
    <script src="../../../%5fstatic/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "im": "\\mathop{\\operatorname{im}}", "rank": "\\mathop{\\operatorname{rank}}", "PP": "\\Bold{P}", "OO": "\\mathcal{O}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../%5fstatic/jupyter-sphinx-furo.js"></script>
    </body>
</html>