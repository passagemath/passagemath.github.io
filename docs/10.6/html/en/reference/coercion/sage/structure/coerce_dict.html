<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Exceptions raised by the coercion model" href="coerce_exceptions.html" /><link rel="prev" title="Group, ring, etc. actions on objects" href="../categories/action.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Containers for storing coercion data - Coercion</title>
      <link rel="stylesheet" type="text/css" href="../../../%5fstatic/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-codemirror-monokai.css" />
    <link rel="stylesheet" type="text/css" href="../../../%5fstatic/custom-tabs.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Coercion</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../%5fstatic/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../%5fstatic/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">passagemath 10.6.2 Reference Manual</span>
  
</a><div class="select-wrapper">
  <select id="versions-menu" onchange="changeVersion()">
    <option value="" selected>other version</option>
    <option value="https://passagemath.org/docs/10.6">passagemath-10.6.x</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Coercion</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="coerce.html">The coercion model</a></li>
<li class="toctree-l1"><a class="reference internal" href="coerce_actions.html">Coerce actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="coerce_maps.html">Coerce maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../categories/pushout.html">Coercion via construction functors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../categories/action.html">Group, ring, etc. actions on objects</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Containers for storing coercion data</a></li>
<li class="toctree-l1"><a class="reference internal" href="coerce_exceptions.html">Exceptions raised by the coercion model</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/edit/main/src/sage/structure/coerce_dict.pyx" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="containers-for-storing-coercion-data">
<span id="sage-structure-coerce-dict"></span><h1>Containers for storing coercion data<a class="headerlink" href="#containers-for-storing-coercion-data" title="Link to this heading">¶</a></h1>
<p id="module-sage.structure.coerce_dict">This module provides <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a> and <a class="reference internal" href="#sage.structure.coerce_dict.MonoDict" title="sage.structure.coerce_dict.MonoDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoDict</span></code></a>. These are
structures similar to <a class="reference external" href="https://docs.python.org/library/weakref.html#weakref.WeakKeyDictionary" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeakKeyDictionary</span></code></a> in Python’s weakref
module, and are optimized for lookup speed. The keys for <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a>
consist of triples (k1,k2,k3) and are looked up by identity rather than
equality. The keys are stored by weakrefs if possible. If any one of the
components k1, k2, k3 gets garbage collected, then the entry is removed from
the <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a>.</p>
<p>Key components that do not allow for weakrefs are stored via a normal
refcounted reference. That means that any entry stored using a triple
(k1,k2,k3) so that none of the k1,k2,k3 allows a weak reference behaves
as an entry in a normal dictionary: Its existence in <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a>
prevents it from being garbage collected.</p>
<p>That container currently is used to store coercion and conversion maps between
two parents (<a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/715">upstream Issue #715</a>) and to store homsets of pairs of objects of a
category (<a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/11521">upstream Issue #11521</a>). In both cases, it is essential that the parent
structures remain garbage collectable, it is essential that the data access is
faster than with a usual <a class="reference external" href="https://docs.python.org/library/weakref.html#weakref.WeakKeyDictionary" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeakKeyDictionary</span></code></a>, and we enforce
the “unique parent condition” in Sage (parent structures should be identical
if they are equal).</p>
<p><a class="reference internal" href="#sage.structure.coerce_dict.MonoDict" title="sage.structure.coerce_dict.MonoDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoDict</span></code></a> behaves similarly, but it takes a single item as a key. It
is used for caching the parents which allow a coercion map into a fixed other
parent (<a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/12313">upstream Issue #12313</a>).</p>
<p>By <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/14159">upstream Issue #14159</a>, <a class="reference internal" href="#sage.structure.coerce_dict.MonoDict" title="sage.structure.coerce_dict.MonoDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoDict</span></code></a> and <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a> can be optionally
used with weak references on the values.</p>
<p class="with-sage-tab with-python-tab">Note that this kind of dictionary is also used for caching actions and
coerce maps. In previous versions of Sage, the cache was by strong
references and resulted in a memory leak in the following example.
However, this leak was fixed by <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/715">upstream Issue #715</a>, using weak references:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.combinat sage.modules sage.rings.finite_rings</span>
<span class="gp">sage:</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">55</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">....:</span>     <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">....:</span>     <span class="n">Q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">P</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">Partitions</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]</span>  <span class="c1"># purge strong cache in CachedRepresentation</span>
<span class="gp">sage:</span> <span class="kn">import</span> <span class="nn">gc</span>
<span class="gp">sage:</span> <span class="n">n</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_finite_field</span> <span class="kn">import</span> <span class="n">EllipticCurve_finite_field</span>
<span class="gp">sage:</span> <span class="n">LE</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gc</span><span class="o">.</span><span class="n">get_objects</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EllipticCurve_finite_field</span><span class="p">)]</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">LE</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.combinat sage.modules sage.rings.finite_rings</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">55</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">t</span><span class="p">,)</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)):</span>
<span class="gp">...</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">...</span>     <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="gp">...</span>     <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">...</span>     <span class="n">Q</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">P</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">Partitions</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">200</span><span class="p">))]</span>  <span class="c1"># purge strong cache in CachedRepresentation</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">gc</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_finite_field</span> <span class="kn">import</span> <span class="n">EllipticCurve_finite_field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">LE</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gc</span><span class="o">.</span><span class="n">get_objects</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EllipticCurve_finite_field</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">LE</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.MonoDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.structure.coerce_dict.</span></span><span class="sig-name descname"><span class="pre">MonoDict</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L252"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.MonoDict" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<blockquote>
<div><p>This is a hashtable specifically designed for (read) speed in
the coercion model.</p>
<p>It differs from a python WeakKeyDictionary in the following important ways:</p>
<blockquote>
<div><ul class="simple">
<li><p>Comparison is done using the ‘is’ rather than ‘==’ operator.</p></li>
<li><p>Only weak references to the keys are stored if at all possible.
Keys that do not allow for weak references are stored with a normal
refcounted reference.</p></li>
<li><p>The callback of the weak references is safe against recursion, see below.</p></li>
</ul>
</div></blockquote>
<p>There are special cdef set/get methods for faster access.
It is bare-bones in the sense that not all dictionary methods are
implemented.</p>
<p>IMPLEMENTATION:</p>
<p>It is implemented as a hash table with open addressing, similar to python’s
dict.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> – (optional) iterable defining initial data, as dict or
iterable of (key, value) pairs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weak_values</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if it is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, weak references to the values in this dictionary will be used,
when possible</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;ab&#39;</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;-15&#39;</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;ab&#39;</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;-15&#39;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The key is expected to be a unique object. Hence, the item stored for <code class="docutils literal notranslate"><span class="pre">c</span></code>
cannot be obtained by providing another equal string:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="go">3</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;-15&#39;</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;-15&#39;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;-15&#39;</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;-15&#39;</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Not all features of Python dictionaries are available, but iteration over
the dictionary items is possible:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;-15&#39;, 3), (&#39;a&#39;, 1), (&#39;ab&#39;, 2)]</span>
<span class="gp">sage:</span> <span class="k">del</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 1), (&#39;ab&#39;, 2)]</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">1002</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;c&#39;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;-15&#39;, 3), (&#39;a&#39;, 1), (&#39;ab&#39;, 2)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 1), (&#39;ab&#39;, 2)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1000</span><span class="p">)):</span>
<span class="gp">...</span>     <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">1002</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;c&#39;</span>
</pre></div>
</div>
</div>
</div>
</div></blockquote>
<p>Note that <code class="docutils literal notranslate"><span class="pre">MW</span></code> also accepts values that do not allow for weak references:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">    sage: MW[k] = int(5)</span>
<span class="go">    sage: MW[k]</span>
<span class="go">    5</span>

<span class="go">The following demonstrates that :class:`MonoDict` is safer than</span>
<span class="go">:class:`~weakref.WeakKeyDictionary` against recursions created by nested</span>
<span class="go">callbacks; compare :issue:`15069` (the mechanism used now is different, though)::</span>

<span class="go">    sage: M = MonoDict()</span>
<span class="go">    sage: class A: pass</span>
<span class="go">    sage: a = A()</span>
<span class="go">    sage: prev = a</span>
<span class="go">    sage: for i in range(1000):</span>
<span class="go">    ....:     newA = A()</span>
<span class="go">    ....:     M[prev] = newA</span>
<span class="go">    ....:     prev = newA</span>
<span class="go">    sage: len(M)</span>
<span class="go">    1000</span>
<span class="go">    sage: del a</span>
<span class="go">    sage: len(M)</span>
<span class="go">    0</span>

<span class="go">The corresponding example with a Python :class:`weakref.WeakKeyDictionary`</span>
<span class="go">would result in a too deep recursion during deletion of the dictionary</span>
<span class="go">items::</span>

<span class="go">    sage: import weakref</span>
<span class="go">    sage: M = weakref.WeakKeyDictionary()</span>
<span class="go">    sage: a = A()</span>
<span class="go">    sage: prev = a</span>
<span class="go">    sage: for i in range(1000):</span>
<span class="go">    ....:     newA = A()</span>
<span class="go">    ....:     M[prev] = newA</span>
<span class="go">    ....:     prev = newA</span>
<span class="go">    sage: len(M)</span>
<span class="go">    1000</span>

<span class="go">Check that also in the presence of circular references, :class:`MonoDict`</span>
<span class="go">gets properly collected::</span>

<span class="go">    sage: import gc</span>
<span class="go">    sage: def count_type(T):</span>
<span class="go">    ....:     return len([c for c in gc.get_objects() if isinstance(c,T)])</span>
<span class="go">    sage: gc.freeze()  # so that gc.collect() only deals with our trash</span>
<span class="go">    sage: N = count_type(MonoDict)</span>
<span class="go">    sage: for i in range(100):</span>
<span class="go">    ....:     V = [MonoDict({&quot;id&quot;:j+100*i}) for j in range(100)]</span>
<span class="go">    ....:     n = len(V)</span>
<span class="go">    ....:     for i in range(n): V[i][V[(i+1)%n]] = (i+1)%n</span>
<span class="go">    ....:     del V</span>
<span class="go">    ....:     _ = gc.collect()</span>
<span class="go">    ....:     assert count_type(MonoDict) == N</span>
<span class="go">    sage: count_type(MonoDict) == N</span>
<span class="go">    True</span>
<span class="go">    sage: gc.unfreeze()</span>

<span class="go">AUTHORS:</span>

<span class="go">- Simon King (2012-01)</span>
<span class="go">- Nils Bruin (2012-08)</span>
<span class="go">- Simon King (2013-02)</span>
<span class="go">- Nils Bruin (2013-11)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.MonoDict.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L810"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.MonoDict.copy" title="Link to this definition">¶</a></dt>
<dd><p>Return a copy of this <a class="reference internal" href="#sage.structure.coerce_dict.MonoDict" title="sage.structure.coerce_dict.MonoDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoDict</span></code></a> as Python dict.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="go">{1: 42}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="go">{1: 42}</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.MonoDict.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L769"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.MonoDict.items" title="Link to this definition">¶</a></dt>
<dd><p>Iterate over the <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> pairs of this <a class="reference internal" href="#sage.structure.coerce_dict.MonoDict" title="sage.structure.coerce_dict.MonoDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoDict</span></code></a>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">&lt;...generator object at ...&gt;</span>
<span class="gp">sage:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(1, None), (2, True)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">&lt;...generator object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(1, None), (2, True)]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.MonoDictEraser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.structure.coerce_dict.</span></span><span class="sig-name descname"><span class="pre">MonoDictEraser</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.MonoDictEraser" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Erase items from a <a class="reference internal" href="#sage.structure.coerce_dict.MonoDict" title="sage.structure.coerce_dict.MonoDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoDict</span></code></a> when a weak reference becomes
invalid.</p>
<p>This is of internal use only. Instances of this class will be passed as a
callback function when creating a weak reference.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">sage:</span> <span class="k">class</span> <span class="nc">A</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">M</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="k">del</span> <span class="n">a</span>
<span class="gp">sage:</span> <span class="kn">import</span> <span class="nn">gc</span>
<span class="gp">sage:</span> <span class="n">n</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>    <span class="c1"># indirect doctest</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">MonoDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">A</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">MonoDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">gc</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>    <span class="c1"># indirect doctest</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Simon King (2012-01)</p></li>
<li><p>Nils Bruin (2013-11)</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.ObjectWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.structure.coerce_dict.</span></span><span class="sig-name descname"><span class="pre">ObjectWrapper</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.ObjectWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A simple fast wrapper around a Python object. This is like a
1-element tuple except that it does not keep a reference to the
wrapped object.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.TripleDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.structure.coerce_dict.</span></span><span class="sig-name descname"><span class="pre">TripleDict</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L983"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.TripleDict" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is a hashtable specifically designed for (read) speed in
the coercion model.</p>
<p>It differs from a python dict in the following important ways:</p>
<blockquote>
<div><ul class="simple">
<li><p>All keys must be sequence of exactly three elements. All sequence
types (tuple, list, etc.) map to the same item.</p></li>
<li><p>Any of the three key components that support weak-refs are stored
via a weakref. If any of these components gets garbage collected
then the entire entry is removed. In that sense, this structure
behaves like a nested <a class="reference external" href="https://docs.python.org/library/weakref.html#weakref.WeakKeyDictionary" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeakKeyDictionary</span></code></a>.</p></li>
<li><p>Comparison is done using the ‘is’ rather than ‘==’ operator.</p></li>
</ul>
</div></blockquote>
<p>There are special cdef set/get methods for faster access.
It is bare-bones in the sense that not all dictionary methods are
implemented.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> – (optional) iterable defining initial data, as dict or
iterable of (key, value) pairs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weak_values</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if it is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, weak references to the values in this dictionary will be used,
when possible</p></li>
</ul>
<p>IMPLEMENTATION:</p>
<p>It is implemented as a hash table with open addressing, similar to python’s
dict.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((&#39;a&#39;, &#39;b&#39;, &#39;c&#39;), 1), ((&#39;c&#39;, &#39;b&#39;, &#39;a&#39;), -1)]</span>
<span class="gp">sage:</span> <span class="k">del</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((&#39;c&#39;, &#39;b&#39;, &#39;a&#39;), -1)]</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
<span class="gp">....:</span>     <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">1001</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span>
<span class="go">-1</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;)</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;a&#39;</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;a&#39;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((&#39;a&#39;, &#39;b&#39;, &#39;c&#39;), 1), ((&#39;c&#39;, &#39;b&#39;, &#39;a&#39;), -1)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((&#39;c&#39;, &#39;b&#39;, &#39;a&#39;), -1)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1000</span><span class="p">)):</span>
<span class="gp">...</span>     <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">1001</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span>
<span class="go">-1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">KeyError: &#39;a&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Robert Bradshaw, 2007-08</p></li>
<li><p>Simon King, 2012-01</p></li>
<li><p>Nils Bruin, 2012-08</p></li>
<li><p>Simon King, 2013-02</p></li>
<li><p>Nils Bruin, 2013-11</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.TripleDict.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L1485"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.TripleDict.copy" title="Link to this definition">¶</a></dt>
<dd><p>Return a copy of this <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a> as Python dict.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="go">{(1, 2, 3): 42}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="go">{(1, 2, 3): 42}</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.TripleDict.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L1440"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.TripleDict.items" title="Link to this definition">¶</a></dt>
<dd><p>Iterate over the <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> pairs of this <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">&lt;...generator object at ...&gt;</span>
<span class="gp">sage:</span> <span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((1, 2, 3), None)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">&lt;...generator object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((1, 2, 3), None)]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.structure.coerce_dict.TripleDictEraser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.structure.coerce_dict.</span></span><span class="sig-name descname"><span class="pre">TripleDictEraser</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/structure/coerce_dict.pyx#L890"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.structure.coerce_dict.TripleDictEraser" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Erases items from a <a class="reference internal" href="#sage.structure.coerce_dict.TripleDict" title="sage.structure.coerce_dict.TripleDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleDict</span></code></a> when a weak reference becomes
invalid.</p>
<p>This is of internal use only. Instances of this class will be passed as a
callback function when creating a weak reference.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">sage:</span> <span class="k">class</span> <span class="nc">A</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">T</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">ZZ</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage:</span> <span class="n">T</span><span class="p">[</span><span class="n">ZZ</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage:</span> <span class="n">T</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">ZZ</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage:</span> <span class="k">del</span> <span class="n">a</span>
<span class="gp">sage:</span> <span class="kn">import</span> <span class="nn">gc</span>
<span class="gp">sage:</span> <span class="n">n</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.structure.coerce_dict</span> <span class="kn">import</span> <span class="n">TripleDict</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">A</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">TripleDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">T</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">ZZ</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">T</span><span class="p">[</span><span class="n">ZZ</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">T</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">ZZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">gc</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Simon King (2012-01)</p></li>
<li><p>Nils Bruin (2013-11)</p></li>
</ul>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="coerce_exceptions.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Exceptions raised by the coercion model</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../categories/action.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Group, ring, etc. actions on objects</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2025, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Containers for storing coercion data</a><ul>
<li><a class="reference internal" href="#sage.structure.coerce_dict.MonoDict"><code class="docutils literal notranslate"><span class="pre">MonoDict</span></code></a><ul>
<li><a class="reference internal" href="#sage.structure.coerce_dict.MonoDict.copy"><code class="docutils literal notranslate"><span class="pre">copy()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.coerce_dict.MonoDict.items"><code class="docutils literal notranslate"><span class="pre">items()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.structure.coerce_dict.MonoDictEraser"><code class="docutils literal notranslate"><span class="pre">MonoDictEraser</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.coerce_dict.ObjectWrapper"><code class="docutils literal notranslate"><span class="pre">ObjectWrapper</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.coerce_dict.TripleDict"><code class="docutils literal notranslate"><span class="pre">TripleDict</span></code></a><ul>
<li><a class="reference internal" href="#sage.structure.coerce_dict.TripleDict.copy"><code class="docutils literal notranslate"><span class="pre">copy()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.coerce_dict.TripleDict.items"><code class="docutils literal notranslate"><span class="pre">items()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.structure.coerce_dict.TripleDictEraser"><code class="docutils literal notranslate"><span class="pre">TripleDictEraser</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../%5fstatic/documentation_options.js"></script>
    <script src="../../../%5fstatic/doctools.js"></script>
    <script src="../../../%5fstatic/sphinx_highlight.js"></script>
    <script src="../../../%5fstatic/scripts/furo.js"></script>
    <script src="../../../%5fstatic/clipboard.min.js"></script>
    <script src="../../../%5fstatic/copybutton.js"></script>
    <script src="../../../%5fstatic/tabs.js"></script>
    <script src="../../../%5fstatic/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../../%5fstatic/jupyter-sphinx-furo.js"></script>
    </body>
</html>