<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Elements of Quaternion Algebras" href="quaternion_algebra_element.html" /><link rel="prev" title="Quaternion Algebras" href="../../../index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Quaternion Algebras - Quaternion Algebras</title>
      <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-codemirror-monokai.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-tabs.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Quaternion Algebras</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../%5fstatic/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../%5fstatic/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">passagemath 10.6.1 Reference Manual</span>
  
</a><div class="select-wrapper">
  <select id="versions-menu" onchange="changeVersion()">
    <option value="" selected>other version</option>
    <option value="https://doc-develop--sagemath.netlify.app">develop</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Quaternion Algebras</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Quaternion Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="quaternion_algebra_element.html">Elements of Quaternion Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="quaternion_algebra_cython.html">Optimized Cython code needed by quaternion algebras</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/edit/main/src/sage/algebras/quatalg/quaternion_algebra.py" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="quaternion-algebras">
<span id="sage-algebras-quatalg-quaternion-algebra"></span><h1>Quaternion Algebras<a class="headerlink" href="#quaternion-algebras" title="Link to this heading">¶</a></h1>
<p id="module-sage.algebras.quatalg.quaternion_algebra">AUTHORS:</p>
<ul class="simple">
<li><p>Jon Bobber (2009): rewrite</p></li>
<li><p>William Stein (2009): rewrite</p></li>
<li><p>Julian Rueth (2014-03-02): use UniqueFactory for caching</p></li>
<li><p>Peter Bruin (2021): do not require the base ring to be a field</p></li>
<li><p>Lorenz Panny (2022): <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.isomorphism_to" title="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.isomorphism_to"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionOrder.isomorphism_to()</span></code></a>,
<a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.minimal_element" title="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.minimal_element"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal_rational.minimal_element()</span></code></a></p></li>
<li><p>Sebastian A. Spindler (2024): extend ramification functionality to number fields,
adapt <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order" title="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionAlgebra_ab.maximal_order()</span></code></a> to allow for extension of an order</p></li>
<li><p>Eloi Torrents (2024): construct quaternion algebras over number fields from ramification</p></li>
</ul>
<p>This code is partly based on Sage code by David Kohel from 2005.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionAlgebraFactory</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/factory.html#sage.structure.factory.UniqueFactory" title="(in Parents and Elements v10.6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a></p>
<p>Construct a quaternion algebra.</p>
<p>INPUT:</p>
<p>There are four input formats:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(a,</span> <span class="pre">b)</span></code>, where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> can be coerced to
units in a common field <span class="math notranslate nohighlight">\(K\)</span> of characteristic different from 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(K,</span> <span class="pre">a,</span> <span class="pre">b)</span></code>, where <span class="math notranslate nohighlight">\(K\)</span> is a ring in which 2
is a unit and <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are units of <span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(D)</span></code>, where <span class="math notranslate nohighlight">\(D \ge 1\)</span> is a squarefree
integer.  This constructs a quaternion algebra of discriminant
<span class="math notranslate nohighlight">\(D\)</span> over <span class="math notranslate nohighlight">\(K = \QQ\)</span>.  Suitable nonzero rational numbers <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>
as above are deduced from <span class="math notranslate nohighlight">\(D\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(K,</span> <span class="pre">primes,</span> <span class="pre">inv_archimedean)</span></code>, where <span class="math notranslate nohighlight">\(K\)</span> is a
number field or <span class="math notranslate nohighlight">\(\QQ\)</span>, <code class="docutils literal notranslate"><span class="pre">primes</span></code> is a list of prime ideals of <span class="math notranslate nohighlight">\(K\)</span>
and <code class="docutils literal notranslate"><span class="pre">inv_archimedean</span></code> is a list of local invariants (<span class="math notranslate nohighlight">\(0\)</span> or
<span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>) specifying the ramification at the (infinite) real
places of <span class="math notranslate nohighlight">\(K\)</span>. This constructs a quaternion algebra ramified exactly
at the places given by <code class="docutils literal notranslate"><span class="pre">primes</span></code> and those (algebraic) real
embeddings of <span class="math notranslate nohighlight">\(K\)</span> indexed in <code class="docutils literal notranslate"><span class="pre">K.embeddings(AA)</span></code> by <code class="docutils literal notranslate"><span class="pre">l</span></code> with
<code class="docutils literal notranslate"><span class="pre">inv_archimedean[l]</span> <span class="pre">=</span> <span class="pre">1/2</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The quaternion algebra <span class="math notranslate nohighlight">\((a, b)_K\)</span> over <span class="math notranslate nohighlight">\(K\)</span> generated by <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>
subject to <span class="math notranslate nohighlight">\(i^2 = a\)</span>, <span class="math notranslate nohighlight">\(j^2 = b\)</span>, and <span class="math notranslate nohighlight">\(ji = -ij\)</span>.</p>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(a,</span> <span class="pre">b)</span></code> – return the quaternion algebra
<span class="math notranslate nohighlight">\((a, b)_K\)</span>, where the base ring <span class="math notranslate nohighlight">\(K\)</span> is a suitably chosen field
containing <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-2, -3) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)](</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>                                    <span class="c1"># needs sage.symbolic</span>
<span class="go">Quaternion Algebra (-1, -5) with base ring Number Field in sqrt2</span>
<span class="go"> with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>                                     <span class="c1"># needs sage.symbolic</span>
<span class="go">Quaternion Algebra (I, sqrt(-3)) with base ring Symbolic Ring</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, t) with base ring</span>
<span class="go"> Fraction Field of Univariate Polynomial Ring in t over Integer Ring</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Quaternion Algebra (-2, -3) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))](</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>                                    <span class="c1"># needs sage.symbolic</span>
<span class="go">Quaternion Algebra (-1, -5) with base ring Number Field in sqrt2</span>
<span class="go"> with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>                                     <span class="c1"># needs sage.symbolic</span>
<span class="go">Quaternion Algebra (I, sqrt(-3)) with base ring Symbolic Ring</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">];</span> <span class="p">(</span><span class="n">t</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, t) with base ring</span>
<span class="go"> Fraction Field of Univariate Polynomial Ring in t over Integer Ring</span>
</pre></div>
</div>
</div>
</div>
<p>Python ints and floats may be passed to the
<code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(a,</span> <span class="pre">b)</span></code> constructor, as may all pairs of
nonzero elements of a domain not of characteristic 2.</p>
<p class="with-sage-tab with-python-tab">The following tests address the issues raised in <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/10601">Issue #10601</a>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.0</span><span class="n">r</span><span class="p">)</span>
<span class="go">Quaternion Algebra (1.00000000000000, 1.00000000000000) with base ring</span>
<span class="go"> Real Field with 53 bits of precision</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: defining elements of quaternion algebra (0, 0)</span>
<span class="go">are not invertible in Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: 2 is not invertible in Finite Field of size 2</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">PermutationGroupElement</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>                                      <span class="c1"># needs sage.groups</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>                                                   <span class="c1"># needs sage.groups</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: a and b must be elements of a ring with characteristic not 2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mf">1.0</span><span class="p">)</span>
<span class="go">Quaternion Algebra (1.00000000000000, 1.00000000000000) with base ring</span>
<span class="go"> Real Field with 53 bits of precision</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: defining elements of quaternion algebra (0, 0)</span>
<span class="go">are not invertible in Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: 2 is not invertible in Finite Field of size 2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">PermutationGroupElement</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>                                      <span class="c1"># needs sage.groups</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>                                                   <span class="c1"># needs sage.groups</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: a and b must be elements of a ring with characteristic not 2</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(K,</span> <span class="pre">a,</span> <span class="pre">b)</span></code> – return the quaternion algebra
defined by <span class="math notranslate nohighlight">\((a, b)\)</span> over the ring <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-7, -21) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>                                     <span class="c1"># needs sage.rings.number_field sage.symbolic</span>
<span class="go">Quaternion Algebra (-2, -3) with base ring Number Field in sqrt2</span>
<span class="go"> with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="go">Quaternion Algebra (-7, -21) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))],</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>                                     <span class="c1"># needs sage.rings.number_field sage.symbolic</span>
<span class="go">Quaternion Algebra (-2, -3) with base ring Number Field in sqrt2</span>
<span class="go"> with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(D)</span></code> – <span class="math notranslate nohighlight">\(D\)</span> is a squarefree integer; return a
rational quaternion algebra of discriminant <span class="math notranslate nohighlight">\(D\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, 1) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, -1) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-22, 210) with base ring Rational Field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Quaternion Algebra (-1, 1) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Quaternion Algebra (-1, -1) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">Quaternion Algebra (-22, 210) with base ring Rational Field</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(K,</span> <span class="pre">primes,</span> <span class="pre">inv_archimedean)</span></code> – return the
quaternion algebra over <span class="math notranslate nohighlight">\(K\)</span> with the ramification specified by
<code class="docutils literal notranslate"><span class="pre">primes</span></code> and <code class="docutils literal notranslate"><span class="pre">inv_archimedean</span></code>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Quaternion Algebra (-1, 3) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra over the rationals must have an even number of ramified places</span>

<span class="gp">sage:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (6)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra over a number field must have an even number of ramified places</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="go">Quaternion Algebra (-1, 3) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra over the rationals must have an even number of ramified places</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">w</span><span class="p">,)</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (6)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra over a number field must have an even number of ramified places</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The construction via ramification fails if the base field is not
a number field:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra construction via ramification only works over a number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra construction via ramification only works over a number field</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The list of local invariants must specify the ramification data
at all real places of the number field <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: must specify ramification at all real places of the number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="p">[],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: must specify ramification at all real places of the number field</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The list of local invariants specifying the ramification at the
real places may only contain <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: list of local invariants specifying ramification should contain only 0 and 1/2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="p">[],</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: list of local invariants specifying ramification should contain only 0 and 1/2</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Similarly, the list of finite ramified places must consist
of primes or prime ideals of the number field <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra constructor requires a list of primes specifying the ramification</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: quaternion algebra constructor requires a list of primes specifying the ramification</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">If the coefficients <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> in the definition of the quaternion
algebra are not integral, then a slower generic type is used for
arithmetic:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="mf">.0</span><span class="p">)</span>
<span class="go">&lt;... &#39;sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_rational_field&#39;&gt;</span>
<span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="mf">.0</span><span class="p">)</span>
<span class="go">&lt;... &#39;sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_generic&#39;&gt;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;... &#39;sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_rational_field&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;... &#39;sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_generic&#39;&gt;</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Make sure caching is sane:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">A</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">));</span> <span class="n">B</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -1) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span> <span class="n">Q</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;ii&#39;, &#39;jj&#39;, &#39;kk&#39;)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;i&#39;, &#39;j&#39;, &#39;k&#39;)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="n">A</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)));</span> <span class="n">B</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -1) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;jj&#39;</span><span class="p">,</span> <span class="s1">&#39;kk&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">Q</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;ii&#39;, &#39;jj&#39;, &#39;kk&#39;)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;i&#39;, &#39;j&#39;, &#39;k&#39;)</span>
</pre></div>
</div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_key">
<span class="sig-name descname"><span class="pre">create_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'i,j,k'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L327"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_key" title="Link to this definition">¶</a></dt>
<dd><p>Create a key that uniquely determines a quaternion algebra.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_object">
<span class="sig-name descname"><span class="pre">create_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_args</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L448"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_object" title="Link to this definition">¶</a></dt>
<dd><p>Create the object from the key (extra arguments are ignored). This is
only called if the object was not found in the cache.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionAlgebra_ab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'i,j,k'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L824"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract" title="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuaternionAlgebra_abstract</span></code></a></p>
<p>A quaternion algebra of the form <span class="math notranslate nohighlight">\((a, b)_K\)</span>.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra</span></code> for many more examples.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – a commutative ring <span class="math notranslate nohighlight">\(K\)</span> in which 2 is invertible</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> – units of <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">'i,j,k'</span></code>); names of the generators</p></li>
</ul>
<p>OUTPUT:</p>
<p>The quaternion algebra <span class="math notranslate nohighlight">\((a, b)\)</span> over <span class="math notranslate nohighlight">\(K\)</span> generated by <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>
subject to <span class="math notranslate nohighlight">\(i^2 = a\)</span>, <span class="math notranslate nohighlight">\(j^2 = b\)</span>, and <span class="math notranslate nohighlight">\(ji = -ij\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">)</span>  <span class="c1"># indirect doctest</span>
<span class="go">Quaternion Algebra (-7, -21) with base ring Rational Field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>  <span class="c1"># indirect doctest</span>
<span class="go">Quaternion Algebra (-7, -21) with base ring Rational Field</span>
</pre></div>
</div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1637"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.discriminant" title="Link to this definition">¶</a></dt>
<dd><p>Return the discriminant of this quaternion algebra.</p>
<p>The discriminant of a quaternion algebra over a number field is the
product of the finite places at which the algebra ramifies.</p>
<p>OUTPUT:</p>
<p>The discriminant of this quaternion algebra, given as</p>
<ul class="simple">
<li><p>an element of <span class="math notranslate nohighlight">\(\ZZ\)</span> if the algebra is defined over <span class="math notranslate nohighlight">\(\QQ\)</span>,</p></li>
<li><p>an integral fractional ideal of the base number field, otherwise.</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">210</span><span class="p">,</span> <span class="o">-</span><span class="mi">22</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">210</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">19</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">210</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">210</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">19</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Some examples over number fields:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (2)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (2)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We can also use number field elements as invariants:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (2)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (2)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The method does not make sense over an arbitrary base ring:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gen">
<span class="sig-name descname"><span class="pre">gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1293"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gen" title="Link to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(i\)</span>-th generator of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – integer (default: 0)</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -2) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">ii</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">jj</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">kk</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(ii, jj, kk)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;jj&#39;</span><span class="p">,</span> <span class="s1">&#39;kk&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -2) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">ii</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">jj</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">kk</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(ii, jj, kk)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1316"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gens" title="Link to this definition">¶</a></dt>
<dd><p>Return the generators of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -2) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(ii, jj, kk)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;jj&#39;</span><span class="p">,</span> <span class="s1">&#39;kk&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -2) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(ii, jj, kk)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ideal">
<span class="sig-name descname"><span class="pre">ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1801"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ideal" title="Link to this definition">¶</a></dt>
<dd><p>Return the quaternion ideal with given gens over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>Neither a left or right order structure need be specified.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – list of elements of this quaternion order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="go">Fractional ideal (2, 2*i, 2*j, 2*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="go">Fractional ideal (2, 2*i, 2*j, 2*k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.inner_product_matrix">
<span class="sig-name descname"><span class="pre">inner_product_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1349"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.inner_product_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Return the inner product matrix associated to <code class="docutils literal notranslate"><span class="pre">self</span></code>, i.e. the
Gram matrix of the reduced norm as a quadratic form on <code class="docutils literal notranslate"><span class="pre">self</span></code>.
The standard basis <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span> is orthogonal, so this matrix
is just the diagonal matrix with diagonal entries <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(ab\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[  2   0   0   0]</span>
<span class="go">[  0  10   0   0]</span>
<span class="go">[  0   0  38   0]</span>
<span class="go">[  0   0   0 190]</span>

<span class="gp">sage:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[];</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Frac</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[    2     0     0     0]</span>
<span class="go">[    0  -2*a     0     0]</span>
<span class="go">[    0     0  -2*b     0]</span>
<span class="go">[    0     0     0 2*a*b]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[  2   0   0   0]</span>
<span class="go">[  0  10   0   0]</span>
<span class="go">[  0   0  38   0]</span>
<span class="go">[  0   0   0 190]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;a, b&#39;</span><span class="p">];</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,)</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Frac</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[    2     0     0     0]</span>
<span class="go">[    0  -2*a     0     0]</span>
<span class="go">[    0     0  -2*b     0]</span>
<span class="go">[    0     0     0 2*a*b]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.invariants">
<span class="sig-name descname"><span class="pre">invariants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1232"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.invariants" title="Link to this definition">¶</a></dt>
<dd><p>Return the structural invariants <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> of this quaternion
algebra: <code class="docutils literal notranslate"><span class="pre">self</span></code> is generated by <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span> subject to
<span class="math notranslate nohighlight">\(i^2 = a\)</span>, <span class="math notranslate nohighlight">\(j^2 = b\)</span> and <span class="math notranslate nohighlight">\(ji = -ij\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">(-3, 5)</span>
<span class="gp">sage:</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-3</span>
<span class="gp">sage:</span> <span class="n">j</span><span class="o">^</span><span class="mi">2</span>
<span class="go">5</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">(-3, 5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">j</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_definite">
<span class="sig-name descname"><span class="pre">is_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1375"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_definite" title="Link to this definition">¶</a></dt>
<dd><p>Check whether this quaternion algebra is definite.</p>
<p>A quaternion algebra over <span class="math notranslate nohighlight">\(\QQ\)</span> is definite if it ramifies at the
unique real place of <span class="math notranslate nohighlight">\(\QQ\)</span>, which happens if and only if both of
its invariants are negative (see Exercise 2.4(c) in <a class="reference internal" href="../../../../references/index.html#voi2021" id="id1"><span>[Voi2021]</span></a>).</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The method does not make sense over an arbitrary base ring:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_isomorphic">
<span class="sig-name descname"><span class="pre">is_isomorphic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1691"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_isomorphic" title="Link to this definition">¶</a></dt>
<dd><p>Check whether this quaternion algebra is isomorphic to <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>Currently only implemented for quaternion algebras defined over
a number field; based on Main Theorem 14.6.1 in <a class="reference internal" href="../../../../references/index.html#voi2021" id="id2"><span>[Voi2021]</span></a>,
noting that <span class="math notranslate nohighlight">\(\QQ\)</span> has a unique infinite place.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> – a quaternion algebra defined over a number field</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">69</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">46</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">87</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">58</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">69</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Checking ramification at both finite and infinite places, the method
correctly distinguishes isomorphism classes of quaternion algebras
that the discriminant can not distinguish:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_totally_definite">
<span class="sig-name descname"><span class="pre">is_totally_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1402"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_totally_definite" title="Link to this definition">¶</a></dt>
<dd><p>Check whether this quaternion algebra is totally definite.</p>
<p>A quaternion algebra defined over a number field is
totally definite if it ramifies at all Archimedean
places of its base field. In particular, the base number
field has to be totally real (see 14.5.8 in <a class="reference internal" href="../../../../references/index.html#voi2021" id="id3"><span>[Voi2021]</span></a>).</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--25-input--1" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage:</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--25-input--2" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We can also use number field elements as invariants:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--26-input--1" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--26-input--2" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The method does not make sense over an arbitrary base ring:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--27-input--1" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--27-input--2" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_totally_definite</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order">
<span class="sig-name descname"><span class="pre">maximal_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">take_shortcuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L899"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order" title="Link to this definition">¶</a></dt>
<dd><p>Return a maximal order in this quaternion algebra.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">order_basis</span></code> is specified, the resulting maximal order
will contain the order of the quaternion algebra given by this
basis. The algorithm used is from <a class="reference internal" href="../../../../references/index.html#voi2012" id="id4"><span>[Voi2012]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">take_shortcuts</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if the discriminant is
prime and the invariants of the algebra are of a nice form, use
Proposition 5.2 of <a class="reference internal" href="../../../../references/index.html#piz1980" id="id5"><span>[Piz1980]</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">order_basis</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) a basis of an
order of this quaternion algebra</p></li>
</ul>
<p>OUTPUT: a maximal order in this quaternion algebra</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--28-input--1" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i + 1/2*j + 1/2*k, i, j, k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i - 1/2*k, 1/2*i + 1/4*j - 1/4*k, i, -k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, -1/3*j - 1/3*k, k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, -1/3*i + 1/3*k, -k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="o">*</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, 1/3*i, 1/6*i + 1/2*j, 1/2 + 1/3*j + 1/18*k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--28-input--2" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i + 1/2*j + 1/2*k, i, j, k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i - 1/2*k, 1/2*i + 1/4*j - 1/4*k, i, -k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, -1/3*j - 1/3*k, k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, -1/3*i + 1/3*k, -k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, 1/3*i, 1/6*i + 1/2*j, 1/2 + 1/3*j + 1/18*k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">389</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">If you want bases containing 1, switch off <code class="docutils literal notranslate"><span class="pre">take_shortcuts</span></code>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--29-input--1" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">89</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-3, -89) with base ring Rational Field</span>
<span class="go"> with basis (1, 1/2 + 1/2*i, j, 1/2 + 1/6*i + 1/2*j + 1/6*k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>    <span class="c1"># Matrix ring</span>
<span class="go">Order of Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="go"> with basis (1, 1/2 + 1/2*i, j, 1/2*j + 1/2*k)</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">22</span><span class="p">,</span><span class="mi">210</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-22, 210) with base ring Rational Field</span>
<span class="go"> with basis (1, i, 1/2*i + 1/2*j, 1/2 + 17/22*i + 1/44*k)</span>

<span class="gp">sage:</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_squarefree</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="p">):</span>        <span class="c1"># long time (3s)</span>
<span class="gp">....:</span>     <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="k">assert</span> <span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--29-input--2" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">89</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-3, -89) with base ring Rational Field</span>
<span class="go"> with basis (1, 1/2 + 1/2*i, j, 1/2 + 1/6*i + 1/2*j + 1/6*k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>    <span class="c1"># Matrix ring</span>
<span class="go">Order of Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="go"> with basis (1, 1/2 + 1/2*i, j, 1/2*j + 1/2*k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">22</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">210</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-22, 210) with base ring Rational Field</span>
<span class="go"> with basis (1, i, 1/2*i + 1/2*j, 1/2 + 17/22*i + 1/44*k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">750</span><span class="p">))</span> <span class="k">if</span> <span class="n">is_squarefree</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="p">):</span>        <span class="c1"># long time (3s)</span>
<span class="gp">...</span>     <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">...</span>     <span class="k">assert</span> <span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Specifying an order basis gives an extension of orders:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--30-input--1" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">292</span><span class="p">,</span> <span class="o">-</span><span class="mi">732</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="k">while</span> <span class="n">alpha</span><span class="o">.</span><span class="n">is_zero</span><span class="p">():</span>
<span class="gp">....:</span>     <span class="n">alpha</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">conj</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">alpha</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span>
<span class="gp">sage:</span> <span class="n">order_basis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">conj</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">one</span><span class="p">(),)</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">order_basis</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">order_basis</span><span class="o">=</span><span class="n">order_basis</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">&lt;=</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">R</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--30-input--2" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">292</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">732</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="n">alpha</span><span class="o">.</span><span class="n">is_zero</span><span class="p">():</span>
<span class="gp">...</span>     <span class="n">alpha</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">conj</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">alpha</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">order_basis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">conj</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">one</span><span class="p">(),)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">order_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">order_basis</span><span class="o">=</span><span class="n">order_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">&lt;=</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">R</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We do not support number fields other than the rationals yet:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--31-input--1" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: maximal order only implemented</span>
<span class="go">for rational quaternion algebras</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--31-input--2" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: maximal order only implemented</span>
<span class="go">for rational quaternion algebras</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_data">
<span class="sig-name descname"><span class="pre">modp_splitting_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1829"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_data" title="Link to this definition">¶</a></dt>
<dd><p>Return mod <span class="math notranslate nohighlight">\(p\)</span> splitting data for this quaternion algebra at
the unramified prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This is <span class="math notranslate nohighlight">\(2\times 2\)</span>
matrices <span class="math notranslate nohighlight">\(I\)</span>, <span class="math notranslate nohighlight">\(J\)</span>, <span class="math notranslate nohighlight">\(K\)</span> over the finite field <span class="math notranslate nohighlight">\(\GF{p}\)</span> such that if
the quaternion algebra has generators <span class="math notranslate nohighlight">\(i, j, k\)</span>, then <span class="math notranslate nohighlight">\(I^2 =
i^2\)</span>, <span class="math notranslate nohighlight">\(J^2 = j^2\)</span>, <span class="math notranslate nohighlight">\(IJ=K\)</span> and <span class="math notranslate nohighlight">\(IJ=-JI\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only implemented when <span class="math notranslate nohighlight">\(p\)</span> is odd and the base
ring is <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – unramified odd prime</p></li>
</ul>
<p>OUTPUT: 2-tuple of matrices over finite field</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--32-input--1" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[0 6]  [6 1]  [6 6]</span>
<span class="go">[1 0], [1 1], [6 1]</span>
<span class="go">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span>
<span class="go">(</span>
<span class="go">[    0 99988]  [97311     4]  [99999 59623]</span>
<span class="go">[    1     0], [13334  2692], [97311     4]</span>
<span class="go">)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">K</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I</span>
<span class="go">[0 8]</span>
<span class="go">[1 0]</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[8 0]</span>
<span class="go">[0 8]</span>
<span class="gp">sage:</span> <span class="n">J</span>
<span class="go">[19  2]</span>
<span class="go">[17  4]</span>
<span class="gp">sage:</span> <span class="n">J</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[4 0]</span>
<span class="go">[0 4]</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">I</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--32-input--2" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">(</span>
<span class="go">[0 6]  [6 1]  [6 6]</span>
<span class="go">[1 0], [1 1], [6 1]</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="go">(</span>
<span class="go">[    0 99988]  [97311     4]  [99999 59623]</span>
<span class="go">[    1     0], [13334  2692], [97311     4]</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">K</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span>
<span class="go">[0 8]</span>
<span class="go">[1 0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[8 0]</span>
<span class="go">[0 8]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">J</span>
<span class="go">[19  2]</span>
<span class="go">[17  4]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">J</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[4 0]</span>
<span class="go">[0 4]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">I</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The following is a good test because of the asserts in the code:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--33-input--1" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">1000</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--33-input--2" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1000</span><span class="p">))]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Proper error handling:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--34-input--1" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: algorithm for computing local splittings</span>
<span class="go">not implemented in general (currently require the first invariant</span>
<span class="go">to be coprime to p)</span>

<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: p must be odd</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--34-input--2" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: algorithm for computing local splittings</span>
<span class="go">not implemented in general (currently require the first invariant</span>
<span class="go">to be coprime to p)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: p must be odd</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_map">
<span class="sig-name descname"><span class="pre">modp_splitting_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1941"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_map" title="Link to this definition">¶</a></dt>
<dd><p>Return Python map from the (<span class="math notranslate nohighlight">\(p\)</span>-integral) quaternion algebra to
the set of <span class="math notranslate nohighlight">\(2\times 2\)</span> matrices over <span class="math notranslate nohighlight">\(\GF{p}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--35-input--1" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_map</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">7</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">k</span>
<span class="gp">sage:</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
<span class="gp">sage:</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--35-input--2" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_map</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.order_with_level">
<span class="sig-name descname"><span class="pre">order_with_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1162"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.order_with_level" title="Link to this definition">¶</a></dt>
<dd><p>Return an order in this quaternion algebra with given level.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">level</span></code> – positive integer</p></li>
</ul>
<p>Currently this is only implemented when the base field is the
rational numbers and the level is divisible by at most one
power of a prime that ramifies in this quaternion algebra.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--36-input--1" name="tab-set--36" type="radio"><label class="tab-label" for="tab-set--36-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">level</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">17</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">order_with_level</span><span class="p">(</span><span class="n">level</span><span class="p">);</span> <span class="n">O</span>
<span class="go">Order of Quaternion Algebra (-2, -5) with base ring Rational Field with basis (1/2 + 1/2*j + 7/2*k, 1/2*i + 19/2*k, j + 7*k, 17*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--36-input--2" name="tab-set--36" type="radio"><label class="tab-label" for="tab-set--36-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">level</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">order_with_level</span><span class="p">(</span><span class="n">level</span><span class="p">);</span> <span class="n">O</span>
<span class="go">Order of Quaternion Algebra (-2, -5) with base ring Rational Field with basis (1/2 + 1/2*j + 7/2*k, 1/2*i + 19/2*k, j + 7*k, 17*k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Check that the order has the right index in the maximal order:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--37-input--1" name="tab-set--37" type="radio"><label class="tab-label" for="tab-set--37-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">L</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="n">level</span> <span class="o">/</span> <span class="mi">5</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--37-input--2" name="tab-set--37" type="radio"><label class="tab-label" for="tab-set--37-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="n">level</span> <span class="o">/</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.quaternion_order">
<span class="sig-name descname"><span class="pre">quaternion_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1774"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.quaternion_order" title="Link to this definition">¶</a></dt>
<dd><p>Return the order of this quaternion order with given basis.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">basis</span></code> – list of 4 elements of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--38-input--1" name="tab-set--38" type="radio"><label class="tab-label" for="tab-set--38-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1, i, j, k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--38-input--2" name="tab-set--38" type="radio"><label class="tab-label" for="tab-set--38-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1, i, j, k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We test out <code class="docutils literal notranslate"><span class="pre">check=False</span></code>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--39-input--1" name="tab-set--39" type="radio"><label class="tab-label" for="tab-set--39-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1, i, j, k)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (i, j, k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--39-input--2" name="tab-set--39" type="radio"><label class="tab-label" for="tab-set--39-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1, i, j, k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (i, j, k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_places">
<span class="sig-name descname"><span class="pre">ramified_places</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1450"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_places" title="Link to this definition">¶</a></dt>
<dd><p>Return the places of the base number field at which this
quaternion algebra ramifies.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inf</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>The non-Archimedean (AKA finite) places at which this quaternion
algebra ramifies, given as</p>
<ul class="simple">
<li><p>elements of <span class="math notranslate nohighlight">\(\ZZ\)</span> (sorted small to large) if the base field is <span class="math notranslate nohighlight">\(\QQ\)</span>,</p></li>
<li><p>integral fractional ideals of the base number field, otherwise.</p></li>
</ul>
<p>Additionally, if <code class="docutils literal notranslate"><span class="pre">inf</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the Archimedean
(AKA infinite) places at which the quaternion algebra ramifies are
also returned, given as</p>
<ul class="simple">
<li><p>the embeddings of <span class="math notranslate nohighlight">\(\QQ\)</span> into <span class="math notranslate nohighlight">\(\RR\)</span> if the base field is <span class="math notranslate nohighlight">\(\QQ\)</span>, or</p></li>
<li><p>the embeddings of the base number field into the Algebraic Real Field.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any Archimedean place at which a quaternion algebra ramifies
has to be real (see 14.5.8 in <a class="reference internal" href="../../../../references/index.html#voi2021" id="id6"><span>[Voi2021]</span></a>).</p>
</div>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--40-input--1" name="tab-set--40" type="radio"><label class="tab-label" for="tab-set--40-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">210</span><span class="p">,</span><span class="o">-</span><span class="mi">22</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([2, 3, 5, 7], [])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--40-input--2" name="tab-set--40" type="radio"><label class="tab-label" for="tab-set--40-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">210</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([2, 3, 5, 7], [])</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">For a definite quaternion algebra we get ramification at the
unique infinite place of <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--41-input--1" name="tab-set--41" type="radio"><label class="tab-label" for="tab-set--41-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([2],</span>
<span class="go"> [Ring morphism:</span>
<span class="go">    From: Rational Field</span>
<span class="go">    To:   Real Field with 53 bits of precision</span>
<span class="go">    Defn: 1 |--&gt; 1.00000000000000])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--41-input--2" name="tab-set--41" type="radio"><label class="tab-label" for="tab-set--41-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([2],</span>
<span class="go"> [Ring morphism:</span>
<span class="go">    From: Rational Field</span>
<span class="go">    To:   Real Field with 53 bits of precision</span>
<span class="go">    Defn: 1 |--&gt; 1.00000000000000])</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Extending the base field can resolve all ramification:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--42-input--1" name="tab-set--42" type="radio"><label class="tab-label" for="tab-set--42-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([], [])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--42-input--2" name="tab-set--42" type="radio"><label class="tab-label" for="tab-set--42-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([], [])</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Extending the base field can also resolve all ramification at finite
places while still leaving some ramification at infinite places:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--43-input--1" name="tab-set--43" type="radio"><label class="tab-label" for="tab-set--43-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([],</span>
<span class="go"> [Ring morphism:</span>
<span class="go">    From: Number Field in a with defining polynomial x^2 - 3 with a = 1.732050807568878?</span>
<span class="go">    To:   Algebraic Real Field</span>
<span class="go">    Defn: a |--&gt; -1.732050807568878?,</span>
<span class="go">  Ring morphism:</span>
<span class="go">    From: Number Field in a with defining polynomial x^2 - 3 with a = 1.732050807568878?</span>
<span class="go">    To:   Algebraic Real Field</span>
<span class="go">    Defn: a |--&gt; 1.732050807568878?])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--43-input--2" name="tab-set--43" type="radio"><label class="tab-label" for="tab-set--43-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([],</span>
<span class="go"> [Ring morphism:</span>
<span class="go">    From: Number Field in a with defining polynomial x^2 - 3 with a = 1.732050807568878?</span>
<span class="go">    To:   Algebraic Real Field</span>
<span class="go">    Defn: a |--&gt; -1.732050807568878?,</span>
<span class="go">  Ring morphism:</span>
<span class="go">    From: Number Field in a with defining polynomial x^2 - 3 with a = 1.732050807568878?</span>
<span class="go">    To:   Algebraic Real Field</span>
<span class="go">    Defn: a |--&gt; 1.732050807568878?])</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Extending the base field can also get rid of ramification at infinite
places while still leaving some ramification at finite places:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--44-input--1" name="tab-set--44" type="radio"><label class="tab-label" for="tab-set--44-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([Fractional ideal (2, 1/2*a + 1/2), Fractional ideal (2, 1/2*a - 1/2)], [])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--44-input--2" name="tab-set--44" type="radio"><label class="tab-label" for="tab-set--44-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([Fractional ideal (2, 1/2*a + 1/2), Fractional ideal (2, 1/2*a - 1/2)], [])</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We can use number field elements as invariants as well:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--45-input--1" name="tab-set--45" type="radio"><label class="tab-label" for="tab-set--45-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([Fractional ideal (2)],</span>
<span class="go"> [Ring morphism:</span>
<span class="go">    From: Number Field in a with defining polynomial x^2 - x - 1</span>
<span class="go">    To: Algebraic Real Field</span>
<span class="go">    Defn: a |--&gt; -0.618033988749895?])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--45-input--2" name="tab-set--45" type="radio"><label class="tab-label" for="tab-set--45-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">([Fractional ideal (2)],</span>
<span class="go"> [Ring morphism:</span>
<span class="go">    From: Number Field in a with defining polynomial x^2 - x - 1</span>
<span class="go">    To: Algebraic Real Field</span>
<span class="go">    Defn: a |--&gt; -0.618033988749895?])</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The method does not make sense over an arbitrary base ring:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--46-input--1" name="tab-set--46" type="radio"><label class="tab-label" for="tab-set--46-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--46-input--2" name="tab-set--46" type="radio"><label class="tab-label" for="tab-set--46-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_places</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_primes">
<span class="sig-name descname"><span class="pre">ramified_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1589"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_primes" title="Link to this definition">¶</a></dt>
<dd><p>Return the (finite) primes of the base number field at
which this quaternion algebra ramifies.</p>
<p>OUTPUT:</p>
<p>The list of finite primes at which this quaternion algebra ramifies,
given as</p>
<ul class="simple">
<li><p>elements of <span class="math notranslate nohighlight">\(\ZZ\)</span> (sorted small to large) if the base field is <span class="math notranslate nohighlight">\(\QQ\)</span>,</p></li>
<li><p>integral fractional ideals of the base number field, otherwise.</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--47-input--1" name="tab-set--47" type="radio"><label class="tab-label" for="tab-set--47-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">69</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[3, 23, 29]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--47-input--2" name="tab-set--47" type="radio"><label class="tab-label" for="tab-set--47-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">58</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">69</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[3, 23, 29]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Under field extensions, the number of ramified primes can increase
or decrease:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--48-input--1" name="tab-set--48" type="radio"><label class="tab-label" for="tab-set--48-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, 1/2*a + 1/2), Fractional ideal (2, 1/2*a - 1/2)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--48-input--2" name="tab-set--48" type="radio"><label class="tab-label" for="tab-set--48-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, 1/2*a + 1/2), Fractional ideal (2, 1/2*a - 1/2)]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We can also use number field elements as invariants:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--49-input--1" name="tab-set--49" type="radio"><label class="tab-label" for="tab-set--49-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--49-input--2" name="tab-set--49" type="radio"><label class="tab-label" for="tab-set--49-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2)]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The method does not make sense over an arbitrary base ring:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--50-input--1" name="tab-set--50" type="radio"><label class="tab-label" for="tab-set--50-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--50-input--2" name="tab-set--50" type="radio"><label class="tab-label" for="tab-set--50-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: base field must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionAlgebra_abstract</span></span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L489"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Parents and Elements v10.6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parent</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L517"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.basis" title="Link to this definition">¶</a></dt>
<dd><p>Return the fixed basis of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which is <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span>, where
<span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span> are the generators of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--51-input--1" name="tab-set--51" type="radio"><label class="tab-label" for="tab-set--51-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, i, j, k)</span>

<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">xyz</span><span class="p">,</span><span class="n">abc</span><span class="p">,</span><span class="n">theta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">),</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, xyz, abc, theta)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--51-input--2" name="tab-set--51" type="radio"><label class="tab-label" for="tab-set--51-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, i, j, k)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;a&#39;</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;theta&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">abc</span><span class="p">,</span> <span class="n">theta</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, xyz, abc, theta)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The basis is cached:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--52-input--1" name="tab-set--52" type="radio"><label class="tab-label" for="tab-set--52-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="ow">is</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--52-input--2" name="tab-set--52" type="radio"><label class="tab-label" for="tab-set--52-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="ow">is</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L786"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module" title="Link to this definition">¶</a></dt>
<dd><p>Return the free module associated to <code class="docutils literal notranslate"><span class="pre">self</span></code> with inner
product given by the reduced norm.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--53-input--1" name="tab-set--53" type="radio"><label class="tab-label" for="tab-set--53-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">LaurentPolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Ambient free quadratic module of rank 4 over the principal ideal domain</span>
<span class="go"> Univariate Laurent Polynomial Ring in t over Finite Field of size 3</span>
<span class="go"> Inner product matrix:</span>
<span class="go">  [2 0 0 0]</span>
<span class="go">  [0 2 0 0]</span>
<span class="go">  [0 0 t 0]</span>
<span class="go">  [0 0 0 t]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--53-input--2" name="tab-set--53" type="radio"><label class="tab-label" for="tab-set--53-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">LaurentPolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">t</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Ambient free quadratic module of rank 4 over the principal ideal domain</span>
<span class="go"> Univariate Laurent Polynomial Ring in t over Finite Field of size 3</span>
<span class="go"> Inner product matrix:</span>
<span class="go">  [2 0 0 0]</span>
<span class="go">  [0 2 0 0]</span>
<span class="go">  [0 0 t 0]</span>
<span class="go">  [0 0 0 t]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.inner_product_matrix">
<span class="sig-name descname"><span class="pre">inner_product_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L541"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.inner_product_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Return the inner product matrix associated to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This is the
Gram matrix of the reduced norm as a quadratic form on <code class="docutils literal notranslate"><span class="pre">self</span></code>.
The standard basis <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span> is orthogonal, so this matrix
is just the diagonal matrix with diagonal entries <span class="math notranslate nohighlight">\(2\)</span>, <span class="math notranslate nohighlight">\(-2a\)</span>, <span class="math notranslate nohighlight">\(-2b\)</span>,
<span class="math notranslate nohighlight">\(2ab\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--54-input--1" name="tab-set--54" type="radio"><label class="tab-label" for="tab-set--54-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[  2   0   0   0]</span>
<span class="go">[  0  10   0   0]</span>
<span class="go">[  0   0  38   0]</span>
<span class="go">[  0   0   0 190]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--54-input--2" name="tab-set--54" type="radio"><label class="tab-label" for="tab-set--54-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[  2   0   0   0]</span>
<span class="go">[  0  10   0   0]</span>
<span class="go">[  0   0  38   0]</span>
<span class="go">[  0   0   0 190]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_commutative">
<span class="sig-name descname"><span class="pre">is_commutative</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L566"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_commutative" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> always, since all quaternion algebras are
noncommutative.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--55-input--1" name="tab-set--55" type="radio"><label class="tab-label" for="tab-set--55-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--55-input--2" name="tab-set--55" type="radio"><label class="tab-label" for="tab-set--55-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_division_algebra">
<span class="sig-name descname"><span class="pre">is_division_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L579"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_division_algebra" title="Link to this definition">¶</a></dt>
<dd><p>Check whether this quaternion algebra is a division algebra,
i.e. whether every nonzero element in it is invertible.</p>
<p>Currently only implemented for quaternion algebras
defined over a number field.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--56-input--1" name="tab-set--56" type="radio"><label class="tab-label" for="tab-set--56-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="p">,</span> <span class="mi">3</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--56-input--2" name="tab-set--56" type="radio"><label class="tab-label" for="tab-set--56-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">z</span><span class="p">,)</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">z</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">By checking ramification, the method correctly recognizes division
quaternion algebras over a number field even if they have trivial
discriminant:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--57-input--1" name="tab-set--57" type="radio"><label class="tab-label" for="tab-set--57-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--57-input--2" name="tab-set--57" type="radio"><label class="tab-label" for="tab-set--57-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The method is not implemented over arbitrary base rings yet:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--58-input--1" name="tab-set--58" type="radio"><label class="tab-label" for="tab-set--58-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: base ring must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--58-input--2" name="tab-set--58" type="radio"><label class="tab-label" for="tab-set--58-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: base ring must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_exact">
<span class="sig-name descname"><span class="pre">is_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L661"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_exact" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if elements of this quaternion algebra are represented
exactly, i.e. there is no precision loss when doing arithmetic. A
quaternion algebra is exact if and only if its base field is
exact.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--59-input--1" name="tab-set--59" type="radio"><label class="tab-label" for="tab-set--59-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--59-input--2" name="tab-set--59" type="radio"><label class="tab-label" for="tab-set--59-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_field">
<span class="sig-name descname"><span class="pre">is_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L679"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_field" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> always, since all quaternion algebras are
noncommutative and all fields are commutative.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--60-input--1" name="tab-set--60" type="radio"><label class="tab-label" for="tab-set--60-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--60-input--2" name="tab-set--60" type="radio"><label class="tab-label" for="tab-set--60-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_finite">
<span class="sig-name descname"><span class="pre">is_finite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L692"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_finite" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the quaternion algebra is finite as a set.</p>
<p>Algorithm: A quaternion algebra is finite if and only if the
base field is finite.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--61-input--1" name="tab-set--61" type="radio"><label class="tab-label" for="tab-set--61-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--61-input--2" name="tab-set--61" type="radio"><label class="tab-label" for="tab-set--61-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_integral_domain">
<span class="sig-name descname"><span class="pre">is_integral_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L710"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_integral_domain" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> always, since all quaternion algebras are
noncommutative and integral domains are commutative (in Sage).</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--62-input--1" name="tab-set--62" type="radio"><label class="tab-label" for="tab-set--62-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_integral_domain</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--62-input--2" name="tab-set--62" type="radio"><label class="tab-label" for="tab-set--62-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_integral_domain</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_matrix_ring">
<span class="sig-name descname"><span class="pre">is_matrix_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L620"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_matrix_ring" title="Link to this definition">¶</a></dt>
<dd><p>Check whether this quaternion algebra is isomorphic to the
2x2 matrix ring over the base ring.</p>
<p>Currently only implemented for quaternion algebras
defined over a number field.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--63-input--1" name="tab-set--63" type="radio"><label class="tab-label" for="tab-set--63-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="p">,</span> <span class="mi">3</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--63-input--2" name="tab-set--63" type="radio"><label class="tab-label" for="tab-set--63-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">z</span><span class="p">,)</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">z</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">By checking ramification, the method is able to recognize that
quaternion algebras (defined over a number field) with trivial
discriminant need not be matrix rings:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--64-input--1" name="tab-set--64" type="radio"><label class="tab-label" for="tab-set--64-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--64-input--2" name="tab-set--64" type="radio"><label class="tab-label" for="tab-set--64-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The method is not implemented over arbitrary base rings yet:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--65-input--1" name="tab-set--65" type="radio"><label class="tab-label" for="tab-set--65-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: base ring must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--65-input--2" name="tab-set--65" type="radio"><label class="tab-label" for="tab-set--65-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: base ring must be rational numbers or a number field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_noetherian">
<span class="sig-name descname"><span class="pre">is_noetherian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L723"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_noetherian" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> always, since any quaternion algebra is a Noetherian
ring (because it is a finitely generated module over a field).</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--66-input--1" name="tab-set--66" type="radio"><label class="tab-label" for="tab-set--66-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_noetherian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--66-input--2" name="tab-set--66" type="radio"><label class="tab-label" for="tab-set--66-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_noetherian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.ngens">
<span class="sig-name descname"><span class="pre">ngens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L499"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.ngens" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of generators of the quaternion algebra as a K-vector
space, not including 1.</p>
<p>This value is always 3: the algebra is spanned
by the standard basis <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--67-input--1" name="tab-set--67" type="radio"><label class="tab-label" for="tab-set--67-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(i, j, k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--67-input--2" name="tab-set--67" type="radio"><label class="tab-label" for="tab-set--67-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(i, j, k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L736"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.order" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of elements of the quaternion algebra, or
<code class="docutils literal notranslate"><span class="pre">+Infinity</span></code> if the algebra is not finite.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--68-input--1" name="tab-set--68" type="radio"><label class="tab-label" for="tab-set--68-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">625</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--68-input--2" name="tab-set--68" type="radio"><label class="tab-label" for="tab-set--68-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">625</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L752"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.random_element" title="Link to this definition">¶</a></dt>
<dd><p>Return a random element of this quaternion algebra.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">args</span></code> and <code class="docutils literal notranslate"><span class="pre">kwds</span></code> are passed to the <code class="docutils literal notranslate"><span class="pre">random_element</span></code> method
of the base ring.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--69-input--1" name="tab-set--69" type="radio"><label class="tab-label" for="tab-set--69-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>            <span class="c1"># needs sage.symbolic</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>                   <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--69-input--2" name="tab-set--69" type="radio"><label class="tab-label" for="tab-set--69-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))],</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>            <span class="c1"># needs sage.symbolic</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))],</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>                   <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">))(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Specify the numerator and denominator bounds:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--70-input--1" name="tab-set--70" type="radio"><label class="tab-label" for="tab-set--70-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
<span class="gp">....:</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
<span class="gp">....:</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--70-input--2" name="tab-set--70" type="radio"><label class="tab-label" for="tab-set--70-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
<span class="gp">...</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
<span class="gp">...</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>     <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.vector_space">
<span class="sig-name descname"><span class="pre">vector_space</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L807"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.vector_space" title="Link to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module" title="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module"><code class="xref py py-meth docutils literal notranslate"><span class="pre">free_module()</span></code></a>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--71-input--1" name="tab-set--71" type="radio"><label class="tab-label" for="tab-set--71-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">vector_space</span><span class="p">()</span>
<span class="go">Ambient quadratic space of dimension 4 over Rational Field</span>
<span class="go">Inner product matrix:</span>
<span class="go">  [   2    0    0    0]</span>
<span class="go">  [   0    6    0    0]</span>
<span class="go">  [   0    0  -38    0]</span>
<span class="go">  [   0    0    0 -114]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--71-input--2" name="tab-set--71" type="radio"><label class="tab-label" for="tab-set--71-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">.</span><span class="n">vector_space</span><span class="p">()</span>
<span class="go">Ambient quadratic space of dimension 4 over Rational Field</span>
<span class="go">Inner product matrix:</span>
<span class="go">  [   2    0    0    0]</span>
<span class="go">  [   0    6    0    0]</span>
<span class="go">  [   0    0  -38    0]</span>
<span class="go">  [   0    0    0 -114]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionFractionalIdeal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coerce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3017"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ideal.html#sage.rings.ideal.Ideal_fractional" title="(in General Rings, Ideals, and Morphisms v10.6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ideal_fractional</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionFractionalIdeal_rational</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3021"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal" title="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal</span></code></a></p>
<p>A fractional ideal in a rational quaternion algebra.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basis</span></code> – tuple of length 4 of elements in of ambient
quaternion algebra whose <span class="math notranslate nohighlight">\(\ZZ\)</span>-span is an ideal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>, do no type
checking.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3325"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis" title="Link to this definition">¶</a></dt>
<dd><p>Return a basis for this fractional ideal.</p>
<p>OUTPUT: tuple</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--72-input--1" name="tab-set--72" type="radio"><label class="tab-label" for="tab-set--72-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--72-input--2" name="tab-set--72" type="radio"><label class="tab-label" for="tab-set--72-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis_matrix">
<span class="sig-name descname"><span class="pre">basis_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3409"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Return basis matrix <span class="math notranslate nohighlight">\(M\)</span> in Hermite normal form for <code class="docutils literal notranslate"><span class="pre">self</span></code> as a
matrix with rational entries.</p>
<p>If <span class="math notranslate nohighlight">\(Q\)</span> is the ambient quaternion algebra, then the <span class="math notranslate nohighlight">\(\ZZ\)</span>-span of
the rows of <span class="math notranslate nohighlight">\(M\)</span> viewed as linear combinations of Q.basis() =
<span class="math notranslate nohighlight">\([1,i,j,k]\)</span> is the fractional ideal <code class="docutils literal notranslate"><span class="pre">self</span></code>.  Also,
<code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">*</span> <span class="pre">M.denominator()</span></code> is an integer matrix in Hermite normal form.</p>
<p>OUTPUT: matrix over <span class="math notranslate nohighlight">\(\QQ\)</span></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--73-input--1" name="tab-set--73" type="radio"><label class="tab-label" for="tab-set--73-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--73-input--2" name="tab-set--73" type="radio"><label class="tab-label" for="tab-set--73-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.conjugate">
<span class="sig-name descname"><span class="pre">conjugate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3675"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.conjugate" title="Link to this definition">¶</a></dt>
<dd><p>Return the ideal with generators the conjugates of the generators for <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT: a quaternionic fractional ideal</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--74-input--1" name="tab-set--74" type="radio"><label class="tab-label" for="tab-set--74-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 40*i, 6 + 28*i + 2*j, 4 + 18*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Fractional ideal (2 + 2*j + 28*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--74-input--2" name="tab-set--74" type="radio"><label class="tab-label" for="tab-set--74-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 40*i, 6 + 28*i + 2*j, 4 + 18*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Fractional ideal (2 + 2*j + 28*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.cyclic_right_subideals">
<span class="sig-name descname"><span class="pre">cyclic_right_subideals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4263"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.cyclic_right_subideals" title="Link to this definition">¶</a></dt>
<dd><p>Let <span class="math notranslate nohighlight">\(I\)</span> = <code class="docutils literal notranslate"><span class="pre">self</span></code>. This function returns the right subideals
<span class="math notranslate nohighlight">\(J\)</span> of <span class="math notranslate nohighlight">\(I\)</span> such that <span class="math notranslate nohighlight">\(I/J\)</span> is an <span class="math notranslate nohighlight">\(\GF{p}\)</span>-vector space of
dimension 2.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number (see below)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) element of quaternion algebra,
which can be used to parameterize the order of the
ideals <span class="math notranslate nohighlight">\(J\)</span>.  More precisely the <span class="math notranslate nohighlight">\(J\)</span>’s are the right annihilators
of <span class="math notranslate nohighlight">\((1,0) \alpha^i\)</span> for <span class="math notranslate nohighlight">\(i=0,1,2,...,p\)</span></p></li>
</ul>
<p>OUTPUT: list of right ideals</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, <span class="math notranslate nohighlight">\(p\)</span> must satisfy a bunch of conditions, or a
<a class="reference external" href="https://docs.python.org/library/exceptions.html#NotImplementedError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> is raised.  In particular, <span class="math notranslate nohighlight">\(p\)</span> must
be odd and unramified in the quaternion algebra, must be
coprime to the index of the right order in the maximal
order, and also coprime to the normal of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  (The Brandt
modules code has a more general algorithm in some cases.)</p>
</div>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--75-input--1" name="tab-set--75" type="radio"><label class="tab-label" for="tab-set--75-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">37</span><span class="p">);</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Fractional ideal (12, 444*i, 8 + 404*i + 4*j, 2 + 150*i + 2*j + 2*k),</span>
<span class="go"> Fractional ideal (12, 444*i, 4 + 256*i + 4*j, 10 + 150*i + 2*j + 2*k),</span>
<span class="go"> Fractional ideal (12, 444*i, 8 + 256*i + 4*j, 6 + 298*i + 2*j + 2*k),</span>
<span class="go"> Fractional ideal (12, 444*i, 4 + 404*i + 4*j, 6 + 2*i + 2*j + 2*k)]</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">389</span><span class="p">);</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[Fractional ideal (12, 4668*i, 10 + 3426*i + 2*j, 6 + 379*i + k),</span>
<span class="go"> Fractional ideal (12, 4668*i, 2 + 3426*i + 2*j, 6 + 3491*i + k),</span>
<span class="go"> Fractional ideal (12, 4 + 1556*i, 6 + 942*i + 6*j, 693*i + 2*j + k),</span>
<span class="go"> Fractional ideal (12, 8 + 1556*i, 6 + 942*i + 6*j, 2 + 1007*i + 4*j + k)]</span>
<span class="gp">sage:</span> <span class="p">[(</span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">/</span><span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(3, 3), (3, 3), (3, 3), (3, 3)]</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Fractional ideal (36, 14004*i, 30 + 10278*i + 6*j, 18 + 1137*i + 3*k),</span>
<span class="go"> Fractional ideal (36, 14004*i, 6 + 10278*i + 6*j, 18 + 10473*i + 3*k),</span>
<span class="go"> Fractional ideal (36, 12 + 4668*i, 18 + 2826*i + 18*j, 2079*i + 6*j + 3*k),</span>
<span class="go"> Fractional ideal (36, 24 + 4668*i, 18 + 2826*i + 18*j, 6 + 3021*i + 12*j + 3*k)]</span>
<span class="gp">sage:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[Fractional ideal (4/3, 1556/3*i, 10/9 + 1142/3*i + 2/9*j, 2/3 + 379/9*i + 1/9*k),</span>
<span class="go"> Fractional ideal (4/3, 1556/3*i, 2/9 + 1142/3*i + 2/9*j, 2/3 + 3491/9*i + 1/9*k),</span>
<span class="go"> Fractional ideal (4/3, 4/9 + 1556/9*i, 2/3 + 314/3*i + 2/3*j, 77*i + 2/9*j + 1/9*k),</span>
<span class="go"> Fractional ideal (4/3, 8/9 + 1556/9*i, 2/3 + 314/3*i + 2/3*j, 2/9 + 1007/9*i + 4/9*j + 1/9*k)]</span>
<span class="gp">sage:</span> <span class="p">[(</span><span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">/</span><span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(3, 3), (3, 3), (3, 3), (3, 3)]</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Fractional ideal (3, 3*i, 2 + j, i + k),</span>
<span class="go"> Fractional ideal (3, 3*i, 1 + j, 2*i + k),</span>
<span class="go"> Fractional ideal (3, 2 + i, 3*j, 2*j + k),</span>
<span class="go"> Fractional ideal (3, 1 + i, 3*j, j + k)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--75-input--2" name="tab-set--75" type="radio"><label class="tab-label" for="tab-set--75-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">37</span><span class="p">));</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[Fractional ideal (12, 444*i, 8 + 404*i + 4*j, 2 + 150*i + 2*j + 2*k),</span>
<span class="go"> Fractional ideal (12, 444*i, 4 + 256*i + 4*j, 10 + 150*i + 2*j + 2*k),</span>
<span class="go"> Fractional ideal (12, 444*i, 8 + 256*i + 4*j, 6 + 298*i + 2*j + 2*k),</span>
<span class="go"> Fractional ideal (12, 444*i, 4 + 404*i + 4*j, 6 + 2*i + 2*j + 2*k)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">389</span><span class="p">));</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="n">C</span>
<span class="go">[Fractional ideal (12, 4668*i, 10 + 3426*i + 2*j, 6 + 379*i + k),</span>
<span class="go"> Fractional ideal (12, 4668*i, 2 + 3426*i + 2*j, 6 + 3491*i + k),</span>
<span class="go"> Fractional ideal (12, 4 + 1556*i, 6 + 942*i + 6*j, 693*i + 2*j + k),</span>
<span class="go"> Fractional ideal (12, 8 + 1556*i, 6 + 942*i + 6*j, 2 + 1007*i + 4*j + k)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">/</span><span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(3, 3), (3, 3), (3, 3), (3, 3)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[Fractional ideal (36, 14004*i, 30 + 10278*i + 6*j, 18 + 1137*i + 3*k),</span>
<span class="go"> Fractional ideal (36, 14004*i, 6 + 10278*i + 6*j, 18 + 10473*i + 3*k),</span>
<span class="go"> Fractional ideal (36, 12 + 4668*i, 18 + 2826*i + 18*j, 2079*i + 6*j + 3*k),</span>
<span class="go"> Fractional ideal (36, 24 + 4668*i, 18 + 2826*i + 18*j, 6 + 3021*i + 12*j + 3*k)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="n">C</span>
<span class="go">[Fractional ideal (4/3, 1556/3*i, 10/9 + 1142/3*i + 2/9*j, 2/3 + 379/9*i + 1/9*k),</span>
<span class="go"> Fractional ideal (4/3, 1556/3*i, 2/9 + 1142/3*i + 2/9*j, 2/3 + 3491/9*i + 1/9*k),</span>
<span class="go"> Fractional ideal (4/3, 4/9 + 1556/9*i, 2/3 + 314/3*i + 2/3*j, 77*i + 2/9*j + 1/9*k),</span>
<span class="go"> Fractional ideal (4/3, 8/9 + 1556/9*i, 2/3 + 314/3*i + 2/3*j, 2/9 + 1007/9*i + 4/9*j + 1/9*k)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">/</span><span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(3, 3), (3, 3), (3, 3), (3, 3)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Q</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[Fractional ideal (3, 3*i, 2 + j, i + k),</span>
<span class="go"> Fractional ideal (3, 3*i, 1 + j, 2*i + k),</span>
<span class="go"> Fractional ideal (3, 2 + i, 3*j, 2*j + k),</span>
<span class="go"> Fractional ideal (3, 1 + i, 3*j, j + k)]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The general algorithm is not yet implemented here:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--76-input--1" name="tab-set--76" type="radio"><label class="tab-label" for="tab-set--76-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="c1"># needs sage.schemes</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: general algorithm not implemented</span>
<span class="go">(The given basis vectors must be linearly independent.)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--76-input--2" name="tab-set--76" type="radio"><label class="tab-label" for="tab-set--76-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>              <span class="c1"># needs sage.schemes</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">NotImplementedError: general algorithm not implemented</span>
<span class="go">(The given basis vectors must be linearly independent.)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3765"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.free_module" title="Link to this definition">¶</a></dt>
<dd><p>Return the underlying free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module corresponding to this ideal.</p>
<p>OUTPUT: free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module of rank 4 embedded in an ambient <span class="math notranslate nohighlight">\(\QQ^4\)</span></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--77-input--1" name="tab-set--77" type="radio"><label class="tab-label" for="tab-set--77-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Fractional ideal (4, 20*i, 2 + 8*i + 2*j, 18*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 2  0  2  8]</span>
<span class="go">[ 0  2  0 18]</span>
<span class="go">[ 0  0  4 16]</span>
<span class="go">[ 0  0  0 20]</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 2/7    0  2/7  8/7]</span>
<span class="go">[   0  2/7    0 18/7]</span>
<span class="go">[   0    0  4/7 16/7]</span>
<span class="go">[   0    0    0 20/7]</span>

<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--77-input--2" name="tab-set--77" type="radio"><label class="tab-label" for="tab-set--77-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="go">Fractional ideal (4, 20*i, 2 + 8*i + 2*j, 18*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 2  0  2  8]</span>
<span class="go">[ 0  2  0 18]</span>
<span class="go">[ 0  0  4 16]</span>
<span class="go">[ 0  0  0 20]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 2/7    0  2/7  8/7]</span>
<span class="go">[   0  2/7    0 18/7]</span>
<span class="go">[   0    0  4/7 16/7]</span>
<span class="go">[   0    0    0 20/7]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The free module method is also useful since it allows for checking if
one ideal is contained in another, computing quotients <span class="math notranslate nohighlight">\(I/J\)</span>, etc.:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--78-input--1" name="tab-set--78" type="radio"><label class="tab-label" for="tab-set--78-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 2*j + 164*k, 2*i + 4*j + 46*k, 16*j + 224*k, 272*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span> <span class="o">/</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Finitely generated module V/W over Integer Ring with invariants (4, 4)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--78-input--2" name="tab-set--78" type="radio"><label class="tab-label" for="tab-set--78-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 2*j + 164*k, 2*i + 4*j + 46*k, 16*j + 224*k, 272*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span> <span class="o">/</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Finitely generated module V/W over Integer Ring with invariants (4, 4)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">This shows that the issue at <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/6760">Issue #6760</a> is fixed:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--79-input--1" name="tab-set--79" type="radio"><label class="tab-label" for="tab-set--79-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + i, 3*i, j + k, 5*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[2 1 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 1 1]</span>
<span class="go">[0 0 0 5]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--79-input--2" name="tab-set--79" type="radio"><label class="tab-label" for="tab-set--79-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + i, 3*i, j + k, 5*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[2 1 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 1 1]</span>
<span class="go">[0 0 0 5]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.gram_matrix">
<span class="sig-name descname"><span class="pre">gram_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3610"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.gram_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Return the Gram matrix of this fractional ideal.</p>
<p>OUTPUT: <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrix over <span class="math notranslate nohighlight">\(\QQ\)</span></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--80-input--1" name="tab-set--80" type="radio"><label class="tab-label" for="tab-set--80-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 40*i, 6 + 28*i + 2*j, 4 + 18*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">gram_matrix</span><span class="p">()</span>
<span class="go">[ 256    0  192  128]</span>
<span class="go">[   0 6400 4480 2880]</span>
<span class="go">[ 192 4480 3328 2112]</span>
<span class="go">[ 128 2880 2112 1408]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--80-input--2" name="tab-set--80" type="radio"><label class="tab-label" for="tab-set--80-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 40*i, 6 + 28*i + 2*j, 4 + 18*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">gram_matrix</span><span class="p">()</span>
<span class="go">[ 256    0  192  128]</span>
<span class="go">[   0 6400 4480 2880]</span>
<span class="go">[ 192 4480 3328 2112]</span>
<span class="go">[ 128 2880 2112 1408]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.intersection">
<span class="sig-name descname"><span class="pre">intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3828"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.intersection" title="Link to this definition">¶</a></dt>
<dd><p>Return the intersection of the ideals <code class="docutils literal notranslate"><span class="pre">self</span></code> and <span class="math notranslate nohighlight">\(J\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--81-input--1" name="tab-set--81" type="radio"><label class="tab-label" for="tab-set--81-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 4*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--81-input--2" name="tab-set--81" type="radio"><label class="tab-label" for="tab-set--81-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 4*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_equivalent">
<span class="sig-name descname"><span class="pre">is_equivalent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">certificate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4059"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_equivalent" title="Link to this definition">¶</a></dt>
<dd><p>Check whether <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">J</span></code> are equivalent as ideals.
Tests equivalence as right ideals by default. Requires the underlying
rational quaternion algebra to be definite.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a fractional quaternion ideal with same order as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a bound to compute and compare theta series before
doing the full equivalence test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> returns an element alpha such that
alpha*J = I or J*alpha = I for right and left ideals respectively</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">side</span></code> – if <code class="docutils literal notranslate"><span class="pre">'left'</span></code> performs left equivalence test. If <code class="docutils literal notranslate"><span class="pre">'right'</span>
<span class="pre">``or</span> <span class="pre">``None</span></code> performs right ideal equivalence test</p></li>
</ul>
<p>OUTPUT: boolean, or (boolean, alpha) if <code class="docutils literal notranslate"><span class="pre">certificate</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--82-input--1" name="tab-set--82" type="radio"><label class="tab-label" for="tab-set--82-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage:</span> <span class="n">OO</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">OO</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: is_equivalent is deprecated,</span>
<span class="go">please use is_left_equivalent or is_right_equivalent</span>
<span class="go">accordingly instead</span>
<span class="go">See https://github.com/sagemath/sage/issues/37100 for details.</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--82-input--2" name="tab-set--82" type="radio"><label class="tab-label" for="tab-set--82-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">OO</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">OO</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: is_equivalent is deprecated,</span>
<span class="go">please use is_left_equivalent or is_right_equivalent</span>
<span class="go">accordingly instead</span>
<span class="go">See https://github.com/sagemath/sage/issues/37100 for details.</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_integral">
<span class="sig-name descname"><span class="pre">is_integral</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4402"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_integral" title="Link to this definition">¶</a></dt>
<dd><p>Check whether the quaternion fractional ideal <code class="docutils literal notranslate"><span class="pre">self</span></code> is integral.</p>
<p>An ideal in a quaternion algebra is integral if and only if it is
contained in its left order. If the left order is already defined
this method just checks this definition, otherwise it uses one
of the alternative definitions from Lemma 16.2.8 of <a class="reference internal" href="../../../../references/index.html#voi2021" id="id7"><span>[Voi2021]</span></a>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--83-input--1" name="tab-set--83" type="radio"><label class="tab-label" for="tab-set--83-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">140</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">150</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">104</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">152</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">140</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">150</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">104</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">152</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--83-input--2" name="tab-set--83" type="radio"><label class="tab-label" for="tab-set--83-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">140</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">104</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">152</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">140</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">104</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">152</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_left_equivalent">
<span class="sig-name descname"><span class="pre">is_left_equivalent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">certificate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4102"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_left_equivalent" title="Link to this definition">¶</a></dt>
<dd><p>Check whether <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">J</span></code> are equivalent as left ideals.
Requires the underlying rational quaternion algebra to be definite.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a fractional quaternion left ideal with same order as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a bound to compute and compare theta series before
doing the full equivalence test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> returns an element alpha such that J*alpha=I</p></li>
</ul>
<p>OUTPUT: boolean, or (boolean, alpha) if <code class="docutils literal notranslate"><span class="pre">certificate</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_primitive">
<span class="sig-name descname"><span class="pre">is_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4487"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_primitive" title="Link to this definition">¶</a></dt>
<dd><p>Check whether the quaternion fractional ideal <code class="docutils literal notranslate"><span class="pre">self</span></code> is primitive.</p>
<p>An integral left <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>-ideal for some order <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>
is called primitive if for all integers <span class="math notranslate nohighlight">\(n &gt; 1\)</span> it is not
contained in <span class="math notranslate nohighlight">\(n\mathcal{O}\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--84-input--1" name="tab-set--84" type="radio"><label class="tab-label" for="tab-set--84-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--84-input--2" name="tab-set--84" type="radio"><label class="tab-label" for="tab-set--84-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_principal">
<span class="sig-name descname"><span class="pre">is_principal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">certificate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4199"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_principal" title="Link to this definition">¶</a></dt>
<dd><p>Check whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is principal as a full rank quaternion ideal.
Requires the underlying quaternion algebra to be definite.
Independent of whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a left or a right ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> returns a generator alpha s.t.
<span class="math notranslate nohighlight">\(I = \alpha O\)</span> where <span class="math notranslate nohighlight">\(O\)</span> is the right order of <span class="math notranslate nohighlight">\(I\)</span></p></li>
</ul>
<p>OUTPUT: boolean, or (boolean, alpha) if <code class="docutils literal notranslate"><span class="pre">certificate</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--85-input--1" name="tab-set--85" type="radio"><label class="tab-label" for="tab-set--85-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">419</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="k">while</span> <span class="n">beta</span><span class="o">.</span><span class="n">is_zero</span><span class="p">():</span>
<span class="gp">....:</span>     <span class="n">beta</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">*</span><span class="n">beta</span>
<span class="gp">sage:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">is_principal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="nb">bool</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">==</span> <span class="n">O</span><span class="o">*</span><span class="n">alpha</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--85-input--2" name="tab-set--85" type="radio"><label class="tab-label" for="tab-set--85-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">419</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="n">beta</span><span class="o">.</span><span class="n">is_zero</span><span class="p">():</span>
<span class="gp">...</span>     <span class="n">beta</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">*</span><span class="n">beta</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">is_principal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">bool</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">==</span> <span class="n">O</span><span class="o">*</span><span class="n">alpha</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_right_equivalent">
<span class="sig-name descname"><span class="pre">is_right_equivalent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">certificate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4125"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_right_equivalent" title="Link to this definition">¶</a></dt>
<dd><p>Check whether <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">J</span></code> are equivalent as right ideals.
Requires the underlying rational quaternion algebra to be definite.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a fractional quaternion right ideal with same order as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a bound to compute and compare theta series before
doing the full equivalence test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> returns an element alpha such that alpha*J=I</p></li>
</ul>
<p>OUTPUT: boolean, or (boolean, alpha) if <code class="docutils literal notranslate"><span class="pre">certificate</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--86-input--1" name="tab-set--86" type="radio"><label class="tab-label" for="tab-set--86-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">OO</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">OO</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(True, 1/3)</span>
<span class="gp">sage:</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">S</span> <span class="o">==</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">True</span>

<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="k">while</span> <span class="n">beta</span><span class="o">.</span><span class="n">is_zero</span><span class="p">():</span>
<span class="gp">....:</span>       <span class="n">beta</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">J</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">I</span>
<span class="gp">sage:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="nb">bool</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">alpha</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--86-input--2" name="tab-set--86" type="radio"><label class="tab-label" for="tab-set--86-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">OO</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">OO</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(True, 1/3)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">S</span> <span class="o">==</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">101</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="n">beta</span><span class="o">.</span><span class="n">is_zero</span><span class="p">():</span>
<span class="gp">...</span>       <span class="n">beta</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">J</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">I</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">is_right_equivalent</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">bool</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">alpha</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.left_order">
<span class="sig-name descname"><span class="pre">left_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3232"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.left_order" title="Link to this definition">¶</a></dt>
<dd><p>Return the left order associated to this fractional ideal.</p>
<p>OUTPUT: an order in a quaternion algebra</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--87-input--1" name="tab-set--87" type="radio"><label class="tab-label" for="tab-set--87-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--87-input--2" name="tab-set--87" type="radio"><label class="tab-label" for="tab-set--87-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We do a consistency check:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--88-input--1" name="tab-set--88" type="radio"><label class="tab-label" for="tab-set--88-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">19</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="go">[209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--88-input--2" name="tab-set--88" type="radio"><label class="tab-label" for="tab-set--88-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">));</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="go">[209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.minimal_element">
<span class="sig-name descname"><span class="pre">minimal_element</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3535"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.minimal_element" title="Link to this definition">¶</a></dt>
<dd><p>Return an element in this quaternion ideal of minimal norm.</p>
<p>If the ideal is a principal lattice, this method can be used
to find a generator; see <a class="reference internal" href="../../../../references/index.html#piz1980" id="id8"><span>[Piz1980]</span></a>, Corollary 1.20.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--89-input--1" name="tab-set--89" type="radio"><label class="tab-label" for="tab-set--89-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Quat</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">O</span>
<span class="go">Order of Quaternion Algebra (-3, -101) with base ring Rational Field with basis (1/2 + 1/2*i, 1/2*j - 1/2*k, -1/3*i + 1/3*k, -k)</span>
<span class="gp">sage:</span> <span class="p">(</span><span class="n">O</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_element</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage:</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">55</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">*</span><span class="mi">141</span> <span class="o">+</span> <span class="n">O</span><span class="o">*</span><span class="n">alpha</span><span class="p">;</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">141</span>
<span class="gp">sage:</span> <span class="n">el</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">minimal_element</span><span class="p">();</span> <span class="n">el</span>
<span class="go">13/2 - 7/6*i + j + 2/3*k</span>
<span class="gp">sage:</span> <span class="n">el</span><span class="o">.</span><span class="n">reduced_norm</span><span class="p">()</span>
<span class="go">282</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--89-input--2" name="tab-set--89" type="radio"><label class="tab-label" for="tab-set--89-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Quat</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">101</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">O</span>
<span class="go">Order of Quaternion Algebra (-3, -101) with base ring Rational Field with basis (1/2 + 1/2*i, 1/2*j - 1/2*k, -1/3*i + 1/3*k, -k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">O</span> <span class="o">*</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">minimal_element</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">141</span><span class="p">)</span> <span class="o">+</span> <span class="n">O</span><span class="o">*</span><span class="n">alpha</span><span class="p">;</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">141</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">el</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">minimal_element</span><span class="p">();</span> <span class="n">el</span>
<span class="go">13/2 - 7/6*i + j + 2/3*k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">el</span><span class="o">.</span><span class="n">reduced_norm</span><span class="p">()</span>
<span class="go">282</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.multiply_by_conjugate">
<span class="sig-name descname"><span class="pre">multiply_by_conjugate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3845"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.multiply_by_conjugate" title="Link to this definition">¶</a></dt>
<dd><p>Return product of <code class="docutils literal notranslate"><span class="pre">self</span></code> and the conjugate Jbar of <span class="math notranslate nohighlight">\(J\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a quaternion ideal</p></li>
</ul>
<p>OUTPUT: a quaternionic fractional ideal</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--90-input--1" name="tab-set--90" type="radio"><label class="tab-label" for="tab-set--90-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiply_by_conjugate</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Fractional ideal (32, 160*i, 8 + 112*i + 8*j, 16 + 72*i + 8*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Fractional ideal (32, 160*i, 8 + 112*i + 8*j, 16 + 72*i + 8*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--90-input--2" name="tab-set--90" type="radio"><label class="tab-label" for="tab-set--90-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">multiply_by_conjugate</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<span class="go">Fractional ideal (32, 160*i, 8 + 112*i + 8*j, 16 + 72*i + 8*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Fractional ideal (32, 160*i, 8 + 112*i + 8*j, 16 + 72*i + 8*k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3634"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.norm" title="Link to this definition">¶</a></dt>
<dd><p>Return the reduced norm of this fractional ideal.</p>
<p>OUTPUT: rational number</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--91-input--1" name="tab-set--91" type="radio"><label class="tab-label" for="tab-set--91-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[16, 32, 32]</span>

<span class="gp">sage:</span> <span class="c1"># optional - magma</span>
<span class="gp">sage:</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;A&lt;i,j,k&gt; := QuaternionAlgebra&lt;Rationals() | </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="go">&#39;&#39;</span>
<span class="gp">sage:</span> <span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;O := QuaternionOrder(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">())))</span>
<span class="go">&#39;&#39;</span>
<span class="gp">sage:</span> <span class="p">[</span> <span class="n">magma</span><span class="p">(</span><span class="s1">&#39;rideal&lt;O | </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">basis</span><span class="p">())))</span><span class="o">.</span><span class="n">Norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[16, 32, 32]</span>

<span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>      <span class="c1"># this is actually an order, so has reduced norm 1</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="p">[</span> <span class="n">J</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span>     <span class="c1"># enumerate maximal right R-ideals of reduced norm 3, verify their norms</span>
<span class="go">[3, 3, 3, 3]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--91-input--2" name="tab-set--91" type="radio"><label class="tab-label" for="tab-set--91-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[16, 32, 32]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># optional - magma</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;A&lt;i,j,k&gt; := QuaternionAlgebra&lt;Rationals() | </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;O := QuaternionOrder(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">())))</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span> <span class="n">magma</span><span class="p">(</span><span class="s1">&#39;rideal&lt;O | </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">basis</span><span class="p">())))</span><span class="o">.</span><span class="n">Norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[16, 32, 32]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>      <span class="c1"># this is actually an order, so has reduced norm 1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span> <span class="n">J</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">]</span>     <span class="c1"># enumerate maximal right R-ideals of reduced norm 3, verify their norms</span>
<span class="go">[3, 3, 3, 3]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.primitive_decomposition">
<span class="sig-name descname"><span class="pre">primitive_decomposition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4432"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.primitive_decomposition" title="Link to this definition">¶</a></dt>
<dd><p>Let <span class="math notranslate nohighlight">\(I\)</span> = <code class="docutils literal notranslate"><span class="pre">self</span></code>. If <span class="math notranslate nohighlight">\(I\)</span> is an integral left <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>-ideal return its decomposition
as an equivalent primitive ideal and an integer such that their product is the initial ideal.</p>
<p>OUTPUTS: A primitive ideal equivalent to <span class="math notranslate nohighlight">\(I\)</span>, i.e. an equivalent ideal not contained
in <span class="math notranslate nohighlight">\(n\mathcal{O}\)</span> for any <span class="math notranslate nohighlight">\(n&gt;0\)</span>, and the smallest integer <span class="math notranslate nohighlight">\(g\)</span> such that <span class="math notranslate nohighlight">\(I \subset g\mathcal{O}\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--92-input--1" name="tab-set--92" type="radio"><label class="tab-label" for="tab-set--92-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">primitive_decomposition</span><span class="p">()</span>
<span class="go">(Fractional ideal (1/2 + 1/2*i + 1/2*j + 3/2*k, i + k, j + k, 2*k), 1)</span>
<span class="gp">sage:</span> <span class="n">J</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">7</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">49</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">91</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">21</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">35</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">35</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">70</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">Jequiv</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">primitive_decomposition</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">Jequiv</span><span class="o">*</span><span class="n">g</span> <span class="o">==</span> <span class="n">J</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">Jequiv</span><span class="p">,</span> <span class="n">g</span>
<span class="go">(Fractional ideal (10, 5 + 5*i, 3 + j, 13/2 + 7/2*i + 1/2*j + 1/2*k), 7)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--92-input--2" name="tab-set--92" type="radio"><label class="tab-label" for="tab-set--92-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">primitive_decomposition</span><span class="p">()</span>
<span class="go">(Fractional ideal (1/2 + 1/2*i + 1/2*j + 3/2*k, i + k, j + k, 2*k), 1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">J</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">91</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Jequiv</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">primitive_decomposition</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Jequiv</span><span class="o">*</span><span class="n">g</span> <span class="o">==</span> <span class="n">J</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Jequiv</span><span class="p">,</span> <span class="n">g</span>
<span class="go">(Fractional ideal (10, 5 + 5*i, 3 + j, 13/2 + 7/2*i + 1/2*j + 1/2*k), 7)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.pullback">
<span class="sig-name descname"><span class="pre">pullback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3964"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.pullback" title="Link to this definition">¶</a></dt>
<dd><p>Compute the ideal which is the pullback of <code class="docutils literal notranslate"><span class="pre">self</span></code> through an ideal <code class="docutils literal notranslate"><span class="pre">J</span></code>.</p>
<p>Uses Lemma 2.1.7 of <a class="reference internal" href="../../../../references/index.html#ler2022" id="id9"><span>[Ler2022]</span></a>. Only works for integral ideals.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a fractional quaternion ideal with norm coprime to <code class="docutils literal notranslate"><span class="pre">self</span></code> and either
left order equal to the right order of <code class="docutils literal notranslate"><span class="pre">self</span></code>, or vice versa</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">side</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); set to <code class="docutils literal notranslate"><span class="pre">'left'</span></code> or <code class="docutils literal notranslate"><span class="pre">'right'</span></code> to
perform pullback of left or right ideals respectively. If <code class="docutils literal notranslate"><span class="pre">None</span></code> the side
is determined by the matching left and right orders</p></li>
</ul>
<p>OUTPUT: a fractional quaternion ideal</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--93-input--1" name="tab-set--93" type="radio"><label class="tab-label" for="tab-set--93-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">419</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I1</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I3</span> <span class="o">=</span> <span class="n">I1</span><span class="o">.</span><span class="n">pushforward</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I3</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span> <span class="o">==</span> <span class="n">I2</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">I3</span><span class="o">.</span><span class="n">pullback</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">I1</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--93-input--2" name="tab-set--93" type="radio"><label class="tab-label" for="tab-set--93-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">419</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I1</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I3</span> <span class="o">=</span> <span class="n">I1</span><span class="o">.</span><span class="n">pushforward</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I3</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span> <span class="o">==</span> <span class="n">I2</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I3</span><span class="o">.</span><span class="n">pullback</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">I1</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.pushforward">
<span class="sig-name descname"><span class="pre">pushforward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3870"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.pushforward" title="Link to this definition">¶</a></dt>
<dd><p>Compute the ideal which is the pushforward of <code class="docutils literal notranslate"><span class="pre">self</span></code> through an ideal <code class="docutils literal notranslate"><span class="pre">J</span></code>.</p>
<p>Uses Lemma 2.1.7 of <a class="reference internal" href="../../../../references/index.html#ler2022" id="id10"><span>[Ler2022]</span></a>. Only works for integral ideals.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a fractional quaternion ideal with norm coprime to <code class="docutils literal notranslate"><span class="pre">self</span></code> and either
the same left order or right order as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">side</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); set to <code class="docutils literal notranslate"><span class="pre">'left'</span></code> or <code class="docutils literal notranslate"><span class="pre">'right'</span></code> to
perform pushforward of left or right ideals respectively. If <code class="docutils literal notranslate"><span class="pre">None</span></code> the side
is determined by the matching left or right orders</p></li>
</ul>
<p>OUTPUT: a fractional quaternion ideal</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--94-input--1" name="tab-set--94" type="radio"><label class="tab-label" for="tab-set--94-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">419</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I1</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I1</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span> <span class="o">==</span> <span class="n">I2</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">I1</span><span class="o">.</span><span class="n">pushforward</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">Fractional ideal (3, 15*i, 3/2 + 10*i + 1/2*j, 1 + 9/10*i + 1/10*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--94-input--2" name="tab-set--94" type="radio"><label class="tab-label" for="tab-set--94-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">419</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I1</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I1</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span> <span class="o">==</span> <span class="n">I2</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I1</span><span class="o">.</span><span class="n">pushforward</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">Fractional ideal (3, 15*i, 3/2 + 10*i + 1/2*j, 1 + 9/10*i + 1/10*k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quadratic_form">
<span class="sig-name descname"><span class="pre">quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3502"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quadratic_form" title="Link to this definition">¶</a></dt>
<dd><p>Return the normalized quadratic form associated to this quaternion ideal.</p>
<p>OUTPUT: quadratic form</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--95-input--1" name="tab-set--95" type="radio"><label class="tab-label" for="tab-set--95-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 2 0 3 2 ]</span>
<span class="go">[ * 2 2 1 ]</span>
<span class="go">[ * * 3 2 ]</span>
<span class="go">[ * * * 2 ]</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + 12*q^5 + 24*q^6 + 24*q^7 + 36*q^8 + 36*q^9 + O(q^10)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + 12*q^5 + 24*q^6 + 24*q^7 + 36*q^8 + 36*q^9 + O(q^10)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--95-input--2" name="tab-set--95" type="radio"><label class="tab-label" for="tab-set--95-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 2 0 3 2 ]</span>
<span class="go">[ * 2 2 1 ]</span>
<span class="go">[ * * 3 2 ]</span>
<span class="go">[ * * * 2 ]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + 12*q^5 + 24*q^6 + 24*q^7 + 36*q^8 + 36*q^9 + O(q^10)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + 12*q^5 + 24*q^6 + 24*q^7 + 36*q^8 + 36*q^9 + O(q^10)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_algebra">
<span class="sig-name descname"><span class="pre">quaternion_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3148"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_algebra" title="Link to this definition">¶</a></dt>
<dd><p>Return the ambient quaternion algebra that contains this fractional ideal.</p>
<p>This is an alias for <span class="math notranslate nohighlight">\(self.ring()\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--96-input--1" name="tab-set--96" type="radio"><label class="tab-label" for="tab-set--96-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 40*i, 6 + 28*i + 2*j, 4 + 18*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -3) with base ring Rational Field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--96-input--2" name="tab-set--96" type="radio"><label class="tab-label" for="tab-set--96-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 40*i, 6 + 28*i + 2*j, 4 + 18*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -3) with base ring Rational Field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3312"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.random_element" title="Link to this definition">¶</a></dt>
<dd><p>Return a random element in the rational fractional ideal <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--97-input--1" name="tab-set--97" type="radio"><label class="tab-label" for="tab-set--97-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--97-input--2" name="tab-set--97" type="radio"><label class="tab-label" for="tab-set--97-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">211</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.reduced_basis">
<span class="sig-name descname"><span class="pre">reduced_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3434"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.reduced_basis" title="Link to this definition">¶</a></dt>
<dd><p>Let <span class="math notranslate nohighlight">\(I\)</span> = <code class="docutils literal notranslate"><span class="pre">self</span></code> be a fractional ideal in a (rational) definite
quaternion algebra. This function returns an LLL reduced basis of <span class="math notranslate nohighlight">\(I\)</span>.</p>
<p>OUTPUT: a tuple of four elements in <span class="math notranslate nohighlight">\(I\)</span> forming an LLL reduced basis of
<span class="math notranslate nohighlight">\(I\)</span> as a lattice</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--98-input--1" name="tab-set--98" type="radio"><label class="tab-label" for="tab-set--98-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">37</span><span class="p">);</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">I</span>
<span class="go">Fractional ideal (4, 148*i, 108*i + 4*j, 2 + 2*i + 2*j + 2*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()</span>
<span class="go">(4, 2 + 2*i + 2*j + 2*k, 2 - 14*i + 14*j - 2*k, 2 - 2*i - 14*j + 14*k)</span>
<span class="gp">sage:</span> <span class="n">l</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reduced_norm</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reduced_norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">50</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">-</span> <span class="mi">7</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">*</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">O</span><span class="o">*</span><span class="mi">3089622859</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">1/2*i + j + 5/2*k</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--98-input--2" name="tab-set--98" type="radio"><label class="tab-label" for="tab-set--98-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">37</span><span class="p">));</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span>
<span class="go">Fractional ideal (4, 148*i, 108*i + 4*j, 2 + 2*i + 2*j + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()</span>
<span class="go">(4, 2 + 2*i + 2*j + 2*k, 2 - 14*i + 14*j - 2*k, 2 - 2*i - 14*j + 14*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reduced_norm</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">reduced_norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">50</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">-</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">*</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">O</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3089622859</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="go">1/2*i + j + 5/2*k</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.right_order">
<span class="sig-name descname"><span class="pre">right_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3259"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.right_order" title="Link to this definition">¶</a></dt>
<dd><p>Return the right order associated to this fractional ideal.</p>
<p>OUTPUT: an order in a quaternion algebra</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--99-input--1" name="tab-set--99" type="radio"><label class="tab-label" for="tab-set--99-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 8*i, 2 + 6*i + 2*j, 6 + 3*i + k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-2, -389) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-2, -389) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j + 3/2*k, 1/8*i + 1/4*j + 9/8*k, j + k, 2*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--99-input--2" name="tab-set--99" type="radio"><label class="tab-label" for="tab-set--99-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">389</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 8*i, 2 + 6*i + 2*j, 6 + 3*i + k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-2, -389) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-2, -389) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j + 3/2*k, 1/8*i + 1/4*j + 9/8*k, j + k, 2*k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The following is a big consistency check.  We take reps for
all the right ideal classes of a certain order, take the
corresponding left orders, then take ideals in the left orders
and from those compute the right order again:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--100-input--1" name="tab-set--100" type="radio"><label class="tab-label" for="tab-set--100-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">19</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">))]</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
<span class="go">18</span>
<span class="gp">sage:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">I</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">J</span><span class="p">]))</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--100-input--2" name="tab-set--100" type="radio"><label class="tab-label" for="tab-set--100-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">));</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
<span class="go">18</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">I</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">J</span><span class="p">]))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">J</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3072"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale the fractional ideal <code class="docutils literal notranslate"><span class="pre">self</span></code> by multiplying the basis
by <code class="docutils literal notranslate"><span class="pre">alpha</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> – nonzero element of quaternion algebra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code> multiply
<span class="math notranslate nohighlight">\(\alpha\)</span> on the left, otherwise multiply <span class="math notranslate nohighlight">\(\alpha\)</span> on the right</p></li>
</ul>
<p>OUTPUT: a new fractional ideal</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--101-input--1" name="tab-set--101" type="radio"><label class="tab-label" for="tab-set--101-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">37</span><span class="p">);</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">();</span> <span class="n">I</span>
<span class="go">Fractional ideal (4, 148*i, 2 + 106*i + 2*j, 2 + 147*i + k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Fractional ideal (296, 4*i, 2 + 2*i + 2*j, 212 + 2*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (296, 4*i, 294 + 2*i + 2*j, 84 + 2*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Fractional ideal (296, 4*i, 2 + 2*i + 2*j, 212 + 2*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">4*i</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
<span class="go">4*i</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--101-input--2" name="tab-set--101" type="radio"><label class="tab-label" for="tab-set--101-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">37</span><span class="p">));</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">();</span> <span class="n">I</span>
<span class="go">Fractional ideal (4, 148*i, 2 + 106*i + 2*j, 2 + 147*i + k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Fractional ideal (296, 4*i, 2 + 2*i + 2*j, 212 + 2*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (296, 4*i, 294 + 2*i + 2*j, 84 + 2*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Fractional ideal (296, 4*i, 2 + 2*i + 2*j, 212 + 2*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">*</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="go">4*i</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">i</span>
<span class="go">4*i</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The scaling element must be nonzero:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--102-input--1" name="tab-set--102" type="radio"><label class="tab-label" for="tab-set--102-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">B</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">419</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">*</span> <span class="n">O</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: the scaling factor must be nonzero</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--102-input--2" name="tab-set--102" type="radio"><label class="tab-label" for="tab-set--102-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">419</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">*</span> <span class="n">O</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: the scaling factor must be nonzero</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series">
<span class="sig-name descname"><span class="pre">theta_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'q'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3563"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series" title="Link to this definition">¶</a></dt>
<dd><p>Return normalized theta series of <code class="docutils literal notranslate"><span class="pre">self</span></code>, as a power series over
<span class="math notranslate nohighlight">\(\ZZ\)</span> in the variable <code class="docutils literal notranslate"><span class="pre">var</span></code>, which is ‘q’ by default.</p>
<p>The normalized theta series is by definition</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\theta_I(q) = \sum_{x \in I} q^{\frac{N(x)}{N(I)}}.\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">'q'</span></code>)</p></li>
</ul>
<p>OUTPUT: power series</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--103-input--1" name="tab-set--103" type="radio"><label class="tab-label" for="tab-set--103-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 8*i, 6 + 4*i + 2*j, 4 + 2*i + 2*k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">32</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + O(q^5)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="go">1 + 12*T^2 + 12*T^3 + 12*T^4 + O(T^5)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + O(q^3)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--103-input--2" name="tab-set--103" type="radio"><label class="tab-label" for="tab-set--103-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 8*i, 6 + 4*i + 2*j, 4 + 2*i + 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">32</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + O(q^5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="go">1 + 12*T^2 + 12*T^3 + 12*T^4 + O(T^5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">1 + 12*q^2 + O(q^3)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series_vector">
<span class="sig-name descname"><span class="pre">theta_series_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L3467"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series_vector" title="Link to this definition">¶</a></dt>
<dd><p>Return theta series coefficients of <code class="docutils literal notranslate"><span class="pre">self</span></code>, as a vector
of <span class="math notranslate nohighlight">\(B\)</span> integers.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – positive integer</p></li>
</ul>
<p>OUTPUT: vector over <span class="math notranslate nohighlight">\(\ZZ\)</span> with <span class="math notranslate nohighlight">\(B\)</span> entries</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--104-input--1" name="tab-set--104" type="radio"><label class="tab-label" for="tab-set--104-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 8*i, 2 + 6*i + 2*j, 6 + 3*i + k)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(1, 0, 2, 2, 6)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(1, 0, 2, 2, 6, 4, 8, 6, 10, 10)</span>
<span class="gp">sage:</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(1, 0, 2, 2, 6)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--104-input--2" name="tab-set--104" type="radio"><label class="tab-label" for="tab-set--104-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span> <span class="n">I</span>
<span class="go">Fractional ideal (8, 8*i, 2 + 6*i + 2*j, 6 + 3*i + k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">(1, 0, 2, 2, 6)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">(1, 0, 2, 2, 6, 4, 8, 6, 10, 10)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">(1, 0, 2, 2, 6)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1992"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Parents and Elements v10.6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parent</span></code></a></p>
<p>An order in a quaternion algebra.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--105-input--1" name="tab-set--105" type="radio"><label class="tab-label" for="tab-set--105-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
<span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.algebras.quatalg.quaternion_algebra.QuaternionOrder_with_category&#39;&gt;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--105-input--2" name="tab-set--105" type="radio"><label class="tab-label" for="tab-set--105-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.algebras.quatalg.quaternion_algebra.QuaternionOrder_with_category&#39;&gt;</span>
</pre></div>
</div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2272"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis" title="Link to this definition">¶</a></dt>
<dd><p>Return fix choice of basis for this quaternion order.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--106-input--1" name="tab-set--106" type="radio"><label class="tab-label" for="tab-set--106-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--106-input--2" name="tab-set--106" type="radio"><label class="tab-label" for="tab-set--106-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis_matrix">
<span class="sig-name descname"><span class="pre">basis_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2632"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Return the basis matrix of this quaternion order, for the
specific basis returned by <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis" title="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">basis()</span></code></a>.</p>
<p>OUTPUT: matrix over <span class="math notranslate nohighlight">\(\QQ\)</span></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--107-input--1" name="tab-set--107" type="radio"><label class="tab-label" for="tab-set--107-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">O</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">sage:</span> <span class="n">O</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 1/2  1/2    0    0]</span>
<span class="go">[   0    0  1/2 -1/2]</span>
<span class="go">[   0    1    0    0]</span>
<span class="go">[   0    0    0   -1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--107-input--2" name="tab-set--107" type="radio"><label class="tab-label" for="tab-set--107-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 1/2  1/2    0    0]</span>
<span class="go">[   0    0  1/2 -1/2]</span>
<span class="go">[   0    1    0    0]</span>
<span class="go">[   0    0    0   -1]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Note that the returned matrix is <em>not</em> necessarily the same as
the basis matrix of the <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal" title="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unit_ideal()</span></code></a>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--108-input--1" name="tab-set--108" type="radio"><label class="tab-label" for="tab-set--108-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">O</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  1  0  0]</span>
<span class="go">[-1  0  0  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="gp">sage:</span> <span class="n">O</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--108-input--2" name="tab-set--108" type="radio"><label class="tab-label" for="tab-set--108-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  1  0  0]</span>
<span class="go">[-1  0  0  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2403"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.discriminant" title="Link to this definition">¶</a></dt>
<dd><p>Return the discriminant of this order.</p>
<p>This is defined as
<span class="math notranslate nohighlight">\(\sqrt{ det ( Tr(e_i \bar{e}_j ) ) }\)</span>, where <span class="math notranslate nohighlight">\(\{e_i\}\)</span> is the
basis of the order.</p>
<p>OUTPUT: rational number</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--109-input--1" name="tab-set--109" type="radio"><label class="tab-label" for="tab-set--109-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">11</span>

<span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">55</span>
<span class="gp">sage:</span> <span class="nb">type</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span>
<span class="go">&lt;... &#39;sage.rings.rational.Rational&#39;&gt;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--109-input--2" name="tab-set--109" type="radio"><label class="tab-label" for="tab-set--109-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">11</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">55</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span>
<span class="go">&lt;... &#39;sage.rings.rational.Rational&#39;&gt;</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2378"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.free_module" title="Link to this definition">¶</a></dt>
<dd><p>Return the free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module that corresponds to this order
inside the vector space corresponding to the ambient
quaternion algebra.</p>
<p>OUTPUT: a free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module of rank 4</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--110-input--1" name="tab-set--110" type="radio"><label class="tab-label" for="tab-set--110-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--110-input--2" name="tab-set--110" type="radio"><label class="tab-label" for="tab-set--110-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gen">
<span class="sig-name descname"><span class="pre">gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2181"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gen" title="Link to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(n\)</span>-th generator.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer between 0 and 3, inclusive</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--111-input--1" name="tab-set--111" type="radio"><label class="tab-label" for="tab-set--111-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">R</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1/2 + 1/2*i</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1/2*j - 1/2*k</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">i</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-k</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--111-input--2" name="tab-set--111" type="radio"><label class="tab-label" for="tab-set--111-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">R</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">1/2 + 1/2*i</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">1/2*j - 1/2*k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">i</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">-k</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2159"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gens" title="Link to this definition">¶</a></dt>
<dd><p>Return generators for <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--112-input--1" name="tab-set--112" type="radio"><label class="tab-label" for="tab-set--112-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--112-input--2" name="tab-set--112" type="radio"><label class="tab-label" for="tab-set--112-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.intersection">
<span class="sig-name descname"><span class="pre">intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.intersection" title="Link to this definition">¶</a></dt>
<dd><p>Return the intersection of this order with other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a quaternion order in the same ambient quaternion algebra</p></li>
</ul>
<p>OUTPUT: a quaternion order</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--113-input--1" name="tab-set--113" type="radio"><label class="tab-label" for="tab-set--113-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*i, i, 1/2*j + 1/2*k, k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--113-input--2" name="tab-set--113" type="radio"><label class="tab-label" for="tab-set--113-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*i, i, 1/2*j + 1/2*k, k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We intersect various orders in the quaternion algebra ramified at 11:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--114-input--1" name="tab-set--114" type="radio"><label class="tab-label" for="tab-set--114-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">S</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 5/2*k, j, 3*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 23/2*k, j, 15*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--114-input--2" name="tab-set--114" type="radio"><label class="tab-label" for="tab-set--114-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">S</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 5/2*k, j, 3*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j, 1/2*i + 23/2*k, j, 15*k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.is_maximal">
<span class="sig-name descname"><span class="pre">is_maximal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2429"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.is_maximal" title="Link to this definition">¶</a></dt>
<dd><p>Check whether the order of <code class="docutils literal notranslate"><span class="pre">self</span></code> is maximal in the ambient quaternion algebra.</p>
<p>Only implemented for quaternion algebras over number fields; for reference,
see Theorem 15.5.5 in <a class="reference internal" href="../../../../references/index.html#voi2021" id="id11"><span>[Voi2021]</span></a>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--115-input--1" name="tab-set--115" type="radio"><label class="tab-label" for="tab-set--115-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">O0_basis</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O0</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">(</span><span class="n">O0_basis</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O0</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">O1</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">O1</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--115-input--2" name="tab-set--115" type="radio"><label class="tab-label" for="tab-set--115-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O0_basis</span> <span class="o">=</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O0</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">(</span><span class="n">O0_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O0</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O1</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O1</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.isomorphism_to">
<span class="sig-name descname"><span class="pre">isomorphism_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conjugator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2787"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.isomorphism_to" title="Link to this definition">¶</a></dt>
<dd><p>Compute an isomorphism from this quaternion order <span class="math notranslate nohighlight">\(O\)</span>
to another order <span class="math notranslate nohighlight">\(O'\)</span> in the same quaternion algebra.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">conjugator</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code> this
method returns a single quaternion <span class="math notranslate nohighlight">\(\gamma \in O \cap O'\)</span>
of minimal norm such that <span class="math notranslate nohighlight">\(O' = \gamma^{-1} O \gamma\)</span>,
rather than the ring isomorphism it defines</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – positive integer; bound on theta series
coefficients to rule out non isomorphic orders</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is currently only implemented for maximal orders in
definite quaternion orders over <span class="math notranslate nohighlight">\(\QQ\)</span>. For a general algorithm,
see <a class="reference internal" href="../../../../references/index.html#kv2010" id="id12"><span>[KV2010]</span></a> (Problem <code class="docutils literal notranslate"><span class="pre">IsConjugate</span></code>).</p>
</div>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--116-input--1" name="tab-set--116" type="radio"><label class="tab-label" for="tab-set--116-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Quat</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">O0</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">O1</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">667</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">9</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="mi">222075</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">333</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">667</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">iso</span> <span class="o">=</span> <span class="n">O0</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">O1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">iso</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Order of Quaternion Algebra (-1, -19) with base ring Rational Field</span>
<span class="go">         with basis (1, i, 1/2*i + 1/2*j, 1/2 + 1/2*k)</span>
<span class="go">  To:   Order of Quaternion Algebra (-1, -19) with base ring Rational Field</span>
<span class="go">         with basis (1, 667*i, 1/2 + 9*i + 1/2*j, 222075/1334*i + 333/667*j + 1/1334*k)</span>
<span class="go">  Defn: i |--&gt; 629/667*i + 36/667*j - 36/667*k</span>
<span class="go">        j |--&gt; -684/667*i + 648/667*j + 19/667*k</span>
<span class="go">        k |--&gt; 684/667*i + 19/667*j + 648/667*k</span>
<span class="gp">sage:</span> <span class="n">iso</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">iso</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">629/667*i + 36/667*j - 36/667*k</span>
<span class="gp">sage:</span> <span class="n">iso</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: 1/3*i fails to convert into the map&#39;s domain ...</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--116-input--2" name="tab-set--116" type="radio"><label class="tab-label" for="tab-set--116-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Quat</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O0</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O1</span> <span class="o">=</span> <span class="n">Quat</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">667</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">222075</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">333</span><span class="p">)</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">667</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">iso</span> <span class="o">=</span> <span class="n">O0</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">O1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">iso</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Order of Quaternion Algebra (-1, -19) with base ring Rational Field</span>
<span class="go">         with basis (1, i, 1/2*i + 1/2*j, 1/2 + 1/2*k)</span>
<span class="go">  To:   Order of Quaternion Algebra (-1, -19) with base ring Rational Field</span>
<span class="go">         with basis (1, 667*i, 1/2 + 9*i + 1/2*j, 222075/1334*i + 333/667*j + 1/1334*k)</span>
<span class="go">  Defn: i |--&gt; 629/667*i + 36/667*j - 36/667*k</span>
<span class="go">        j |--&gt; -684/667*i + 648/667*j + 19/667*k</span>
<span class="go">        k |--&gt; 684/667*i + 19/667*j + 648/667*k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">iso</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">iso</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">629/667*i + 36/667*j - 36/667*k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">iso</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">TypeError: 1/3*i fails to convert into the map&#39;s domain ...</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab"></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--117-input--1" name="tab-set--117" type="radio"><label class="tab-label" for="tab-set--117-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">O0</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">O1</span><span class="p">,</span> <span class="n">conjugator</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">gamma</span>
<span class="go">-36 + j + k</span>
<span class="gp">sage:</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">O0</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">O1</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">O1</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span> <span class="o">==</span> <span class="o">~</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">O0</span> <span class="o">*</span> <span class="n">gamma</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--117-input--2" name="tab-set--117" type="radio"><label class="tab-label" for="tab-set--117-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">O0</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">O1</span><span class="p">,</span> <span class="n">conjugator</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">gamma</span>
<span class="go">-36 + j + k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">O0</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">O1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">O1</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span> <span class="o">==</span> <span class="o">~</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">O0</span> <span class="o">*</span> <span class="n">gamma</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p>ALGORITHM:</p>
<p>Find a generator of the principal lattice <span class="math notranslate nohighlight">\(N\cdot O\cdot O'\)</span>
where <span class="math notranslate nohighlight">\(N = [O : O cap O']\)</span> using
<a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.minimal_element" title="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.minimal_element"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal_rational.minimal_element()</span></code></a>.
An isomorphism is given by conjugation by such an element.
Works providing reduced norm of conjugation element is not
a ramified prime times a square. To cover cases where it is
we repeat the check for orders conjugated by i, j, and k.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.left_ideal">
<span class="sig-name descname"><span class="pre">left_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2531"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.left_ideal" title="Link to this definition">¶</a></dt>
<dd><p>Return the left ideal of this order generated by the given generators.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – list of elements of this quaternion order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_basis</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code> then
<code class="docutils literal notranslate"><span class="pre">gens</span></code> must be a <span class="math notranslate nohighlight">\(\ZZ\)</span>-basis of the ideal</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--118-input--1" name="tab-set--118" type="radio"><label class="tab-label" for="tab-set--118-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="mi">2</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1 + i, 2*i, j + k, 2*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1/2 + 1/2*i + 1/2*j + 13/2*k, i + j, 6*j + 6*k, 12*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--118-input--2" name="tab-set--118" type="radio"><label class="tab-label" for="tab-set--118-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1 + i, 2*i, j + k, 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1/2 + 1/2*i + 1/2*j + 13/2*k, i + j, 6*j + 6*k, 12*k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">It is also possible to pass a generating set (rather than a basis),
or a single generator:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--119-input--1" name="tab-set--119" type="radio"><label class="tab-label" for="tab-set--119-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 13/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 13/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="n">R</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--119-input--2" name="tab-set--119" type="radio"><label class="tab-label" for="tab-set--119-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 13/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 13/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="n">R</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ngens">
<span class="sig-name descname"><span class="pre">ngens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ngens" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of generators (which is 4).</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--120-input--1" name="tab-set--120" type="radio"><label class="tab-label" for="tab-set--120-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--120-input--2" name="tab-set--120" type="radio"><label class="tab-label" for="tab-set--120-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.one">
<span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2148"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.one" title="Link to this definition">¶</a></dt>
<dd><p>Return the multiplicative unit of this quaternion order.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--121-input--1" name="tab-set--121" type="radio"><label class="tab-label" for="tab-set--121-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--121-input--2" name="tab-set--121" type="radio"><label class="tab-label" for="tab-set--121-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quadratic_form">
<span class="sig-name descname"><span class="pre">quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2699"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quadratic_form" title="Link to this definition">¶</a></dt>
<dd><p>Return the normalized quadratic form associated to this quaternion order.</p>
<p>OUTPUT: quadratic form</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--122-input--1" name="tab-set--122" type="radio"><label class="tab-label" for="tab-set--122-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 14 253 55 286 ]</span>
<span class="go">[ * 1455 506 3289 ]</span>
<span class="go">[ * * 55 572 ]</span>
<span class="go">[ * * * 1859 ]</span>
<span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 2*q + 2*q^4 + 4*q^6 + 4*q^8 + 2*q^9 + O(q^10)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--122-input--2" name="tab-set--122" type="radio"><label class="tab-label" for="tab-set--122-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 14 253 55 286 ]</span>
<span class="go">[ * 1455 506 3289 ]</span>
<span class="go">[ * * 55 572 ]</span>
<span class="go">[ * * * 1859 ]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">1 + 2*q + 2*q^4 + 4*q^6 + 4*q^8 + 2*q^9 + O(q^10)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quaternion_algebra">
<span class="sig-name descname"><span class="pre">quaternion_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2283"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quaternion_algebra" title="Link to this definition">¶</a></dt>
<dd><p>Return ambient quaternion algebra that contains this quaternion order.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--123-input--1" name="tab-set--123" type="radio"><label class="tab-label" for="tab-set--123-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-11, -1) with base ring Rational Field</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--123-input--2" name="tab-set--123" type="radio"><label class="tab-label" for="tab-set--123-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-11, -1) with base ring Rational Field</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2307"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.random_element" title="Link to this definition">¶</a></dt>
<dd><p>Return a random element of this order.</p>
<p>The args and kwds are passed to the random_element method of
the integer ring, and we return an element of the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ae_1 + be_2 + ce_3 + de_4\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(e_1\)</span>, …, <span class="math notranslate nohighlight">\(e_4\)</span> are the basis of this order and <span class="math notranslate nohighlight">\(a\)</span>,
<span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(d\)</span> are random integers.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--124-input--1" name="tab-set--124" type="radio"><label class="tab-label" for="tab-set--124-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">-4 - 4*i + j - k</span>
<span class="gp">sage:</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">-9/2 - 7/2*i - 7/2*j - 3/2*k</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--124-input--2" name="tab-set--124" type="radio"><label class="tab-label" for="tab-set--124-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">-4 - 4*i + j - k</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># random</span>
<span class="go">-9/2 - 7/2*i - 7/2*j - 3/2*k</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.right_ideal">
<span class="sig-name descname"><span class="pre">right_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2574"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.right_ideal" title="Link to this definition">¶</a></dt>
<dd><p>Return the right ideal of this order generated by the given generators.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – list of elements of this quaternion order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_basis</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code> then
<code class="docutils literal notranslate"><span class="pre">gens</span></code> must be a <span class="math notranslate nohighlight">\(\ZZ\)</span>-basis of the ideal</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--125-input--1" name="tab-set--125" type="radio"><label class="tab-label" for="tab-set--125-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1 + i, 2*i, j + k, 2*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1/2 + 1/2*i + 1/2*j + 11/2*k, i + j, 6*j + 6*k, 12*k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--125-input--2" name="tab-set--125" type="radio"><label class="tab-label" for="tab-set--125-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1 + i, 2*i, j + k, 2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()],</span> <span class="n">is_basis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (1/2 + 1/2*i + 1/2*j + 11/2*k, i + j, 6*j + 6*k, 12*k)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">It is also possible to pass a generating set (rather than a basis),
or a single generator:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--126-input--1" name="tab-set--126" type="radio"><label class="tab-label" for="tab-set--126-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 11/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 11/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">sage:</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--126-input--2" name="tab-set--126" type="radio"><label class="tab-label" for="tab-set--126-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 11/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="go">Fractional ideal (12, 6 + 6*i, i + j, 11/2 + 1/2*i + 1/2*j + 1/2*k)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span> <span class="o">+</span> <span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ternary_quadratic_form">
<span class="sig-name descname"><span class="pre">ternary_quadratic_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2720"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ternary_quadratic_form" title="Link to this definition">¶</a></dt>
<dd><p>Return the ternary quadratic form associated to this order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">include_basis</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code> also
return a basis for the dimension 3 subspace <span class="math notranslate nohighlight">\(G\)</span></p></li>
</ul>
<p>OUTPUT: QuadraticForm</p>
<ul class="simple">
<li><p>optional basis for dimension 3 subspace</p></li>
</ul>
<p>This function computes the positive definition quadratic form
obtained by letting G be the trace zero subspace of <span class="math notranslate nohighlight">\(\ZZ\)</span> +
2* <code class="docutils literal notranslate"><span class="pre">self</span></code>, which has rank 3, and restricting the pairing
<a class="reference internal" href="quaternion_algebra_element.html#sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair" title="sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionAlgebraElement_abstract.pair()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">(x,y) = (x.conjugate()*y).reduced_trace()</span>
</pre></div>
</div>
<p>to <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>APPLICATIONS: Ternary quadratic forms associated to an order
in a rational quaternion algebra are useful in computing with
Gross points, in decided whether quaternion orders have
embeddings from orders in quadratic imaginary fields, and in
computing elements of the Kohnen plus subspace of modular
forms of weight 3/2.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--127-input--1" name="tab-set--127" type="radio"><label class="tab-label" for="tab-set--127-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ternary_quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 5820 1012 13156 ]</span>
<span class="go">[ * 55 1144 ]</span>
<span class="go">[ * * 7436 ]</span>
<span class="gp">sage:</span> <span class="n">factor</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">disc</span><span class="p">())</span>
<span class="go">2^4 * 11^2 * 13^2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--127-input--2" name="tab-set--127" type="radio"><label class="tab-label" for="tab-set--127-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.schemes</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ternary_quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 5820 1012 13156 ]</span>
<span class="go">[ * 55 1144 ]</span>
<span class="go">[ * * 7436 ]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">factor</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">disc</span><span class="p">())</span>
<span class="go">2^4 * 11^2 * 13^2</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The following theta series is a modular form of weight 3/2 and level 4*11*13:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--128-input--1" name="tab-set--128" type="radio"><label class="tab-label" for="tab-set--128-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>                                                   <span class="c1"># needs sage.schemes</span>
<span class="go">1 + 2*q^23 + 2*q^55 + 2*q^56 + 2*q^75 + 4*q^92 + O(q^100)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--128-input--2" name="tab-set--128" type="radio"><label class="tab-label" for="tab-set--128-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>                                                   <span class="c1"># needs sage.schemes</span>
<span class="go">1 + 2*q^23 + 2*q^55 + 2*q^56 + 2*q^75 + 4*q^92 + O(q^100)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal">
<span class="sig-name descname"><span class="pre">unit_ideal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L2617"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal" title="Link to this definition">¶</a></dt>
<dd><p>Return the unit ideal in this quaternion order.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--129-input--1" name="tab-set--129" type="radio"><label class="tab-label" for="tab-set--129-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">();</span> <span class="n">I</span>
<span class="go">Fractional ideal (1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--129-input--2" name="tab-set--129" type="radio"><label class="tab-label" for="tab-set--129-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">();</span> <span class="n">I</span>
<span class="go">Fractional ideal (1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.basis_for_quaternion_lattice">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">basis_for_quaternion_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4513"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.basis_for_quaternion_lattice" title="Link to this definition">¶</a></dt>
<dd><p>Return a basis for the <span class="math notranslate nohighlight">\(\ZZ\)</span>-lattice in a quaternion algebra
spanned by the given gens.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – list of elements of a single quaternion algebra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reverse</span></code> – when computing the HNF do it on the basis
<span class="math notranslate nohighlight">\((k,j,i,1)\)</span> instead of <span class="math notranslate nohighlight">\((1,i,j,k)\)</span>; this ensures that if
<code class="docutils literal notranslate"><span class="pre">gens</span></code> are the generators for a fractional ideal (in
particular, an order), the first returned basis vector
equals the norm of the ideal (in case of an order, <span class="math notranslate nohighlight">\(1\)</span>)</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--130-input--1" name="tab-set--130" type="radio"><label class="tab-label" for="tab-set--130-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">basis_for_quaternion_lattice</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">basis_for_quaternion_lattice</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">[1/3, 2*i, i + j, 2*k]</span>
<span class="gp">sage:</span> <span class="n">basis_for_quaternion_lattice</span><span class="p">([</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="go">[1, i, j, k]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--130-input--2" name="tab-set--130" type="radio"><label class="tab-label" for="tab-set--130-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">basis_for_quaternion_lattice</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">basis_for_quaternion_lattice</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))])</span>
<span class="go">[1/3, 2*i, i + j, 2*k]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">basis_for_quaternion_lattice</span><span class="p">([</span><span class="n">A</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="go">[1, i, j, k]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.intersection_of_row_modules_over_ZZ">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">intersection_of_row_modules_over_ZZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4545"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.intersection_of_row_modules_over_ZZ" title="Link to this definition">¶</a></dt>
<dd><p>Intersect the <span class="math notranslate nohighlight">\(\ZZ\)</span>-modules with basis matrices the full rank <span class="math notranslate nohighlight">\(4 \times 4\)</span>
<span class="math notranslate nohighlight">\(\QQ\)</span>-matrices in the list v.</p>
<p>The returned intersection is
represented by a <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrix over <span class="math notranslate nohighlight">\(\QQ\)</span>.  This can also be done
using modules and intersection, but that would take over twice as long
because of overhead, hence this function.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--131-input--1" name="tab-set--131" type="radio"><label class="tab-label" for="tab-set--131-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">intersection_of_row_modules_over_ZZ</span>
<span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">intersection_of_row_modules_over_ZZ</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[   2    0   -1   -1]</span>
<span class="go">[  -4    1    1   -3]</span>
<span class="go">[  -3 19/2   -1   -4]</span>
<span class="go">[   2   -3   -8    4]</span>
<span class="gp">sage:</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">M</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span> <span class="o">==</span> <span class="n">M2</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--131-input--2" name="tab-set--131" type="radio"><label class="tab-label" for="tab-set--131-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),[</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">intersection_of_row_modules_over_ZZ</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">intersection_of_row_modules_over_ZZ</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[   2    0   -1   -1]</span>
<span class="go">[  -4    1    1   -3]</span>
<span class="go">[  -3 19/2   -1   -4]</span>
<span class="go">[   2   -3   -8    4]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span> <span class="o">==</span> <span class="n">M2</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.is_QuaternionAlgebra">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">is_QuaternionAlgebra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L469"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.is_QuaternionAlgebra" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">A</span></code> is of the QuaternionAlgebra data type.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--132-input--1" name="tab-set--132" type="radio"><label class="tab-label" for="tab-set--132-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">is_QuaternionAlgebra</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">doctest:warning...</span>
<span class="go">DeprecationWarning: the function is_QuaternionAlgebra is deprecated;</span>
<span class="go">use &#39;isinstance(..., QuaternionAlgebra_abstract)&#39; instead</span>
<span class="go">See https://github.com/sagemath/sage/issues/37896 for details.</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">is_QuaternionAlgebra</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--132-input--2" name="tab-set--132" type="radio"><label class="tab-label" for="tab-set--132-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">is_QuaternionAlgebra</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">doctest:warning...</span>
<span class="go">DeprecationWarning: the function is_QuaternionAlgebra is deprecated;</span>
<span class="go">use &#39;isinstance(..., QuaternionAlgebra_abstract)&#39; instead</span>
<span class="go">See https://github.com/sagemath/sage/issues/37896 for details.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">is_QuaternionAlgebra</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.maxord_solve_aux_eq">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">maxord_solve_aux_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4727"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.maxord_solve_aux_eq" title="Link to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> and an even prime ideal <code class="docutils literal notranslate"><span class="pre">p</span></code> find
(y,z,w) with y a unit mod <span class="math notranslate nohighlight">\(p^{2e}\)</span> such that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 - ay^2 - bz^2 + abw^2 \equiv 0 mod p^{2e},\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> is the ramification index of <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>Currently only <span class="math notranslate nohighlight">\(p=2\)</span> is implemented by hardcoding solutions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – integer with <span class="math notranslate nohighlight">\(v_p(a) = 0\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> – integer with <span class="math notranslate nohighlight">\(v_p(b) \in \{0,1\}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – even prime ideal (actually only <code class="docutils literal notranslate"><span class="pre">p=ZZ(2)</span></code> is implemented)</p></li>
</ul>
<p>OUTPUT: a tuple <span class="math notranslate nohighlight">\((y, z, w)\)</span></p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--133-input--1" name="tab-set--133" type="radio"><label class="tab-label" for="tab-set--133-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">maxord_solve_aux_eq</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
<span class="gp">....:</span>     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
<span class="gp">....:</span>         <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="n">maxord_solve_aux_eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">....:</span>         <span class="k">assert</span> <span class="n">mod</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">mod</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">....:</span>         <span class="k">assert</span> <span class="n">mod</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--133-input--2" name="tab-set--133" type="radio"><label class="tab-label" for="tab-set--133-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">maxord_solve_aux_eq</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)]:</span>
<span class="gp">...</span>     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)]:</span>
<span class="gp">...</span>         <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="n">maxord_solve_aux_eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">...</span>         <span class="k">assert</span> <span class="n">mod</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">mod</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">...</span>         <span class="k">assert</span> <span class="n">mod</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.normalize_basis_at_p">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">normalize_basis_at_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B=&lt;method</span> <span class="pre">'pair'</span> <span class="pre">of</span> <span class="pre">'sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract'</span> <span class="pre">objects&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L4589"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.normalize_basis_at_p" title="Link to this definition">¶</a></dt>
<dd><p>Compute a (at <code class="docutils literal notranslate"><span class="pre">p</span></code>) normalized basis from the given basis <code class="docutils literal notranslate"><span class="pre">e</span></code>
of a <span class="math notranslate nohighlight">\(\ZZ\)</span>-module.</p>
<p>The returned basis is (at <code class="docutils literal notranslate"><span class="pre">p</span></code>) a <span class="math notranslate nohighlight">\(\ZZ_p\)</span> basis for the same
module, and has the property that with respect to it the quadratic
form induced by the bilinear form B is represented as a orthogonal
sum of atomic forms multiplied by p-powers.</p>
<p>If <span class="math notranslate nohighlight">\(p \neq 2\)</span> this means that the form is diagonal with respect to
this basis.</p>
<p>If <span class="math notranslate nohighlight">\(p = 2\)</span> there may be additional 2-dimensional subspaces on which
the form is represented as <span class="math notranslate nohighlight">\(2^e (ax^2 + bxy + cx^2)\)</span> with
<span class="math notranslate nohighlight">\(0 = v_2(b) = v_2(a) \leq v_2(c)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> – list; basis of a <span class="math notranslate nohighlight">\(\ZZ\)</span> module
(WARNING: will be modified!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime for at which the basis should be normalized</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> –
(default: <a class="reference internal" href="quaternion_algebra_element.html#sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair" title="sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionAlgebraElement_abstract.pair()</span></code></a>)
a bilinear form with respect to which to normalize</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list containing two-element tuples: The first element of
each tuple is a basis element, the second the valuation of
the orthogonal summand to which it belongs. The list is sorted
by ascending valuation.</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--134-input--1" name="tab-set--134" type="radio"><label class="tab-label" for="tab-set--134-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">normalize_basis_at_p</span>
<span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[(1, 0), (i, 0), (j, 0), (k, 0)]</span>

<span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">210</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[(1, 0), (i, 1), (j, 1), (k, 2)]</span>

<span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">286</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[(1, 0), (1/2*j + 1/2*k, 0), (-5/6*j + 1/6*k, 1), (1/2*i, 1)]</span>

<span class="gp">sage:</span> <span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[(1, 0), (1/2 + 1/2*i + 1/2*j + 1/2*k, 0), (-34/105*i - 463/735*j + 71/105*k, 1),</span>
<span class="go"> (1/7*i - 8/49*j + 1/7*k, 1)]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--134-input--2" name="tab-set--134" type="radio"><label class="tab-label" for="tab-set--134-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">normalize_basis_at_p</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[(1, 0), (i, 0), (j, 0), (k, 0)]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">210</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[(1, 0), (i, 1), (j, 1), (k, 2)]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">286</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[(1, 0), (1/2*j + 1/2*k, 0), (-5/6*j + 1/6*k, 1), (1/2*i, 1)]</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[(1, 0), (1/2 + 1/2*i + 1/2*j + 1/2*k, 0), (-34/105*i - 463/735*j + 71/105*k, 1),</span>
<span class="go"> (1/7*i - 8/49*j + 1/7*k, 1)]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.unpickle_QuaternionAlgebra_v0">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">unpickle_QuaternionAlgebra_v0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/algebras/quatalg/quaternion_algebra.py#L1974"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.unpickle_QuaternionAlgebra_v0" title="Link to this definition">¶</a></dt>
<dd><p>The <span class="math notranslate nohighlight">\(0\)</span>-th version of pickling for quaternion algebras.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--135-input--1" name="tab-set--135" type="radio"><label class="tab-label" for="tab-set--135-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">unpickle_QuaternionAlgebra_v0</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-5, -19) with base ring Rational Field</span>
<span class="gp">sage:</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span> <span class="ow">is</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--135-input--2" name="tab-set--135" type="radio"><label class="tab-label" for="tab-set--135-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">unpickle_QuaternionAlgebra_v0</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-5, -19) with base ring Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span> <span class="ow">is</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="quaternion_algebra_element.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Elements of Quaternion Algebras</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../../../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2025, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Quaternion Algebras</a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebraFactory</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_key"><code class="docutils literal notranslate"><span class="pre">create_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_object"><code class="docutils literal notranslate"><span class="pre">create_object()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra_ab</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.discriminant"><code class="docutils literal notranslate"><span class="pre">discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gen"><code class="docutils literal notranslate"><span class="pre">gen()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gens"><code class="docutils literal notranslate"><span class="pre">gens()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ideal"><code class="docutils literal notranslate"><span class="pre">ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.inner_product_matrix"><code class="docutils literal notranslate"><span class="pre">inner_product_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.invariants"><code class="docutils literal notranslate"><span class="pre">invariants()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_definite"><code class="docutils literal notranslate"><span class="pre">is_definite()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_isomorphic"><code class="docutils literal notranslate"><span class="pre">is_isomorphic()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.is_totally_definite"><code class="docutils literal notranslate"><span class="pre">is_totally_definite()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order"><code class="docutils literal notranslate"><span class="pre">maximal_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_data"><code class="docutils literal notranslate"><span class="pre">modp_splitting_data()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_map"><code class="docutils literal notranslate"><span class="pre">modp_splitting_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.order_with_level"><code class="docutils literal notranslate"><span class="pre">order_with_level()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.quaternion_order"><code class="docutils literal notranslate"><span class="pre">quaternion_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_places"><code class="docutils literal notranslate"><span class="pre">ramified_places()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_primes"><code class="docutils literal notranslate"><span class="pre">ramified_primes()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra_abstract</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module"><code class="docutils literal notranslate"><span class="pre">free_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.inner_product_matrix"><code class="docutils literal notranslate"><span class="pre">inner_product_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_commutative"><code class="docutils literal notranslate"><span class="pre">is_commutative()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_division_algebra"><code class="docutils literal notranslate"><span class="pre">is_division_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_exact"><code class="docutils literal notranslate"><span class="pre">is_exact()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_field"><code class="docutils literal notranslate"><span class="pre">is_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_finite"><code class="docutils literal notranslate"><span class="pre">is_finite()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_integral_domain"><code class="docutils literal notranslate"><span class="pre">is_integral_domain()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_matrix_ring"><code class="docutils literal notranslate"><span class="pre">is_matrix_ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_noetherian"><code class="docutils literal notranslate"><span class="pre">is_noetherian()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.ngens"><code class="docutils literal notranslate"><span class="pre">ngens()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.order"><code class="docutils literal notranslate"><span class="pre">order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.random_element"><code class="docutils literal notranslate"><span class="pre">random_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.vector_space"><code class="docutils literal notranslate"><span class="pre">vector_space()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal"><code class="docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational"><code class="docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal_rational</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis_matrix"><code class="docutils literal notranslate"><span class="pre">basis_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.conjugate"><code class="docutils literal notranslate"><span class="pre">conjugate()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.cyclic_right_subideals"><code class="docutils literal notranslate"><span class="pre">cyclic_right_subideals()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.free_module"><code class="docutils literal notranslate"><span class="pre">free_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.gram_matrix"><code class="docutils literal notranslate"><span class="pre">gram_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.intersection"><code class="docutils literal notranslate"><span class="pre">intersection()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_equivalent"><code class="docutils literal notranslate"><span class="pre">is_equivalent()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_integral"><code class="docutils literal notranslate"><span class="pre">is_integral()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_left_equivalent"><code class="docutils literal notranslate"><span class="pre">is_left_equivalent()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_primitive"><code class="docutils literal notranslate"><span class="pre">is_primitive()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_principal"><code class="docutils literal notranslate"><span class="pre">is_principal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_right_equivalent"><code class="docutils literal notranslate"><span class="pre">is_right_equivalent()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.left_order"><code class="docutils literal notranslate"><span class="pre">left_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.minimal_element"><code class="docutils literal notranslate"><span class="pre">minimal_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.multiply_by_conjugate"><code class="docutils literal notranslate"><span class="pre">multiply_by_conjugate()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.primitive_decomposition"><code class="docutils literal notranslate"><span class="pre">primitive_decomposition()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.pullback"><code class="docutils literal notranslate"><span class="pre">pullback()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.pushforward"><code class="docutils literal notranslate"><span class="pre">pushforward()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quadratic_form"><code class="docutils literal notranslate"><span class="pre">quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_algebra"><code class="docutils literal notranslate"><span class="pre">quaternion_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.random_element"><code class="docutils literal notranslate"><span class="pre">random_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.reduced_basis"><code class="docutils literal notranslate"><span class="pre">reduced_basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.right_order"><code class="docutils literal notranslate"><span class="pre">right_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.scale"><code class="docutils literal notranslate"><span class="pre">scale()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series"><code class="docutils literal notranslate"><span class="pre">theta_series()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series_vector"><code class="docutils literal notranslate"><span class="pre">theta_series_vector()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder"><code class="docutils literal notranslate"><span class="pre">QuaternionOrder</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis_matrix"><code class="docutils literal notranslate"><span class="pre">basis_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.discriminant"><code class="docutils literal notranslate"><span class="pre">discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.free_module"><code class="docutils literal notranslate"><span class="pre">free_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gen"><code class="docutils literal notranslate"><span class="pre">gen()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gens"><code class="docutils literal notranslate"><span class="pre">gens()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.intersection"><code class="docutils literal notranslate"><span class="pre">intersection()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.is_maximal"><code class="docutils literal notranslate"><span class="pre">is_maximal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.isomorphism_to"><code class="docutils literal notranslate"><span class="pre">isomorphism_to()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.left_ideal"><code class="docutils literal notranslate"><span class="pre">left_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ngens"><code class="docutils literal notranslate"><span class="pre">ngens()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.one"><code class="docutils literal notranslate"><span class="pre">one()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quadratic_form"><code class="docutils literal notranslate"><span class="pre">quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quaternion_algebra"><code class="docutils literal notranslate"><span class="pre">quaternion_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.random_element"><code class="docutils literal notranslate"><span class="pre">random_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.right_ideal"><code class="docutils literal notranslate"><span class="pre">right_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ternary_quadratic_form"><code class="docutils literal notranslate"><span class="pre">ternary_quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal"><code class="docutils literal notranslate"><span class="pre">unit_ideal()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.basis_for_quaternion_lattice"><code class="docutils literal notranslate"><span class="pre">basis_for_quaternion_lattice()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.intersection_of_row_modules_over_ZZ"><code class="docutils literal notranslate"><span class="pre">intersection_of_row_modules_over_ZZ()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.is_QuaternionAlgebra"><code class="docutils literal notranslate"><span class="pre">is_QuaternionAlgebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.maxord_solve_aux_eq"><code class="docutils literal notranslate"><span class="pre">maxord_solve_aux_eq()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.normalize_basis_at_p"><code class="docutils literal notranslate"><span class="pre">normalize_basis_at_p()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.unpickle_QuaternionAlgebra_v0"><code class="docutils literal notranslate"><span class="pre">unpickle_QuaternionAlgebra_v0()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../%5fstatic/documentation_options.js"></script>
    <script src="../../../../%5fstatic/doctools.js"></script>
    <script src="../../../../%5fstatic/sphinx_highlight.js"></script>
    <script src="../../../../%5fstatic/scripts/furo.js"></script>
    <script src="../../../../%5fstatic/clipboard.min.js"></script>
    <script src="../../../../%5fstatic/copybutton.js"></script>
    <script src="../../../../%5fstatic/tabs.js"></script>
    <script src="../../../../%5fstatic/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "im": "\\mathop{\\operatorname{im}}", "rank": "\\mathop{\\operatorname{rank}}", "PP": "\\Bold{P}", "OO": "\\mathcal{O}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="/Users/mkoeppe/s/sage/sage-rebasing/local/share/mathjax/mathjax/tex-chtml.js?v=0d9741c5"></script>
    <script src="../../../../%5fstatic/jupyter-sphinx-furo.js"></script>
    </body>
</html>