<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Tangent Spaces" href="../../../tangent_space.html" /><link rel="prev" title="Curves in Manifolds" href="curve.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Integrated Curves and Geodesics in Manifolds - Manifolds</title>
      <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-codemirror-monokai.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-tabs.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Manifolds</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../%5fstatic/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../%5fstatic/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">passagemath 10.6.2 Reference Manual</span>
  
</a><div class="select-wrapper">
  <select id="versions-menu" onchange="changeVersion()">
    <option value="" selected>other version</option>
    <option value="https://doc-develop--sagemath.netlify.app">develop</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Manifolds</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../manifold.html">Topological Manifolds</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Topological Manifolds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manifold.html">Topological Manifolds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subset.html">Subsets of Topological Manifolds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structure.html">Manifold Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../point.html">Points of Topological Manifolds</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../chart.html">Coordinate Charts</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Coordinate Charts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chart.html">Coordinate Charts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chart_func.html">Chart Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../calculus_method.html">Coordinate calculus methods</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../scalarfield.html">Scalar Fields</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Scalar Fields</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../scalarfield_algebra.html">Algebra of Scalar Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scalarfield.html">Scalar Fields</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../continuous_map.html">Continuous Maps</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Continuous Maps</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manifold_homset.html">Set of Morphisms between Topological Manifolds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../continuous_map.html">Continuous Maps Between Topological Manifolds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../continuous_map_image.html">Images of Manifold Subsets under Continuous Maps as Subsets of the Codomain</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topological_submanifold.html">Submanifolds of topological manifolds</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../vector_bundle.html">Topological Vector Bundles</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Topological Vector Bundles</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../vector_bundle.html">Topological Vector Bundle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_bundle_fiber.html">Vector Bundle Fibers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_bundle_fiber_element.html">Vector Bundle Fiber Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trivialization.html">Trivializations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../local_frame.html">Local Frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="../section_module.html">Section Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../section.html">Sections</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../family.html">Families of Manifold Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsets/closure.html">Topological Closures of Manifold Subsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsets/pullback.html">Manifold Subsets Defined as Pullbacks of Subsets under Continuous Maps</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../diff_manifold.html">Differentiable Manifolds</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Differentiable Manifolds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="manifold.html">Differentiable Manifolds</a></li>
<li class="toctree-l2"><a class="reference internal" href="chart.html">Coordinate Charts on Differentiable Manifolds</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/real_line.html">The Real Line and Open Intervals</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../diff_scalarfield.html">Scalar Fields</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Scalar Fields</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="scalarfield_algebra.html">Algebra of Differentiable Scalar Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="scalarfield.html">Differentiable Scalar Fields</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../../diff_map.html">Differentiable Maps and Curves</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Differentiable Maps and Curves</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="manifold_homset.html">Sets of Morphisms between Differentiable Manifolds</a></li>
<li class="toctree-l3"><a class="reference internal" href="diff_map.html">Differentiable Maps between Differentiable Manifolds</a></li>
<li class="toctree-l3"><a class="reference internal" href="curve.html">Curves in Manifolds</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Integrated Curves and Geodesics in Manifolds</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../tangent_space.html">Tangent Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Tangent Spaces</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="tangent_space.html">Tangent Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="tangent_vector.html">Tangent Vectors</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../vectorfield.html">Vector Fields</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Vector Fields</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="vectorfield_module.html">Vector Field Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="vectorfield.html">Vector Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="vectorframe.html">Vector Frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="automorphismfield_group.html">Group of Tangent-Space Automorphism Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="automorphismfield.html">Tangent-Space Automorphism Fields</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../tensorfield.html">Tensor Fields</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Tensor Fields</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="tensorfield_module.html">Tensor Field Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensorfield.html">Tensor Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensorfield_paral.html">Tensor Fields with Values on a Parallelizable Manifold</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../diff_form.html">Differential Forms</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Differential Forms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="diff_form_module.html">Differential Form Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="diff_form.html">Differential Forms</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../mixed_form.html">Mixed Differential Forms</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Mixed Differential Forms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="mixed_form_algebra.html">Graded Algebra of Mixed Differential Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="mixed_form.html">Mixed Differential Forms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="de_rham_cohomology.html">De Rham Cohomology</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../multivector.html">Alternating Multivector Fields</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Alternating Multivector Fields</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="multivector_module.html">Multivector Field Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="multivectorfield.html">Multivector Fields</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="affine_connection.html">Affine Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="differentiable_submanifold.html">Submanifolds of differentiable manifolds</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../diff_vector_bundle.html">Differentiable Vector Bundles</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Differentiable Vector Bundles</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="vector_bundle.html">Differentiable Vector Bundles</a></li>
<li class="toctree-l3"><a class="reference internal" href="bundle_connection.html">Bundle Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="characteristic_cohomology_class.html">Characteristic cohomology classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../riem_manifold.html">Pseudo-Riemannian Manifolds</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Pseudo-Riemannian Manifolds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="pseudo_riemannian.html">Pseudo-Riemannian Manifolds</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../euclidean_space.html">Euclidean Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Euclidean Spaces</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/euclidean.html">Euclidean Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/sphere.html">Spheres smoothly embedded in Euclidean Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operators.html">Operators for vector calculus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="metric.html">Pseudo-Riemannian Metrics and Degenerate Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="levi_civita_connection.html">Levi-Civita Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="pseudo_riemannian_submanifold.html">Pseudo-Riemannian submanifolds</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../degenerate_metric.html">Degenerate Metric Manifolds</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Degenerate Metric Manifolds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="degenerate.html">Degenerate manifolds</a></li>
<li class="toctree-l3"><a class="reference internal" href="degenerate_submanifold.html">Degenerate submanifolds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../poisson_manifold.html">Poisson Manifolds</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Poisson Manifolds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="poisson_tensor.html">Poisson tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="symplectic_form.html">Symplectic structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/symplectic_space.html">Symplectic vector spaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utilities for Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../catalog.html">Manifolds Catalog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/edit/main/src/sage/manifolds/differentiable/integrated_curve.py" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="integrated-curves-and-geodesics-in-manifolds">
<span id="sage-manifolds-differentiable-integrated-curve"></span><h1>Integrated Curves and Geodesics in Manifolds<a class="headerlink" href="#integrated-curves-and-geodesics-in-manifolds" title="Link to this heading">¶</a></h1>
<p id="module-sage.manifolds.differentiable.integrated_curve">Given a differentiable manifold <span class="math notranslate nohighlight">\(M\)</span>, an <em>integrated curve</em> in <span class="math notranslate nohighlight">\(M\)</span>
is a differentiable curve constructed as a solution to a system of
second order differential equations.</p>
<p>Integrated curves are implemented by the class <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a>, from
which the classes <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedAutoparallelCurve</span></code></a> and
<a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic" title="sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedGeodesic</span></code></a> inherit.</p>
<p class="rubric">Example: a geodesic in the hyperbolic plane</p>
<p class="with-sage-tab with-python-tab">First declare the hyperbolic plane as a 2-dimensional Riemannian manifold <code class="docutils literal notranslate"><span class="pre">M</span></code>
and introduce the chart <code class="docutils literal notranslate"><span class="pre">X</span></code> corresponding to the Poincaré half-plane model:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;x y:(0,+oo)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;x y:(0,+oo)&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Then set the metric to be the hyperbolic one:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">g = y^(-2) dx⊗dx + y^(-2) dy⊗dy</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">y</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">y</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">g = y^(-2) dx⊗dx + y^(-2) dy⊗dy</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Pick an initial point and an initial tangent vector:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v = ∂/∂x + 3/2 ∂/∂y</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v = ∂/∂x + 3/2 ∂/∂y</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Declare a geodesic with such initial conditions, denoting by <span class="math notranslate nohighlight">\(t\)</span> the
corresponding affine parameter:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Numerically integrate the geodesic (see <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> for
all possible options, including the choice of the numerical algorithm):</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>                                                               <span class="c1"># needs scipy</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>                                                               <span class="c1"># needs scipy</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Plot the geodesic after interpolating the solution <code class="docutils literal notranslate"><span class="pre">sol</span></code>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>                                                      <span class="c1"># needs scipy</span>

<span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">p_plot</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label_offset</span><span class="o">=-</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v_plot</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label_offset</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph</span> <span class="o">+</span> <span class="n">p_plot</span> <span class="o">+</span> <span class="n">v_plot</span>
<span class="go">Graphics object consisting of 5 graphics primitives</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>                                                      <span class="c1"># needs scipy</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p_plot</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">label_offset</span><span class="o">=-</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.07&#39;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v_plot</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label_offset</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.05&#39;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph</span> <span class="o">+</span> <span class="n">p_plot</span> <span class="o">+</span> <span class="n">v_plot</span>
<span class="go">Graphics object consisting of 5 graphics primitives</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-1.svg" class="plot-directive" src="../../../_images/integrated_curve-1.svg" />
</figure>
<p class="with-sage-tab with-python-tab"><span class="math notranslate nohighlight">\(c\)</span> is a differentiable curve in <span class="math notranslate nohighlight">\(M\)</span> and inherits from the properties of
<a class="reference internal" href="curve.html#sage.manifolds.differentiable.curve.DifferentiableCurve" title="sage.manifolds.differentiable.curve.DifferentiableCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentiableCurve</span></code></a>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">c</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Real interval (0, 10)</span>
<span class="gp">sage:</span> <span class="n">c</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">2-dimensional Riemannian manifold M</span>
<span class="gp">sage:</span> <span class="n">c</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">c: (0, 10) → M</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Real interval (0, 10)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">2-dimensional Riemannian manifold M</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">c: (0, 10) → M</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">In particular, its value at <span class="math notranslate nohighlight">\(t=1\)</span> is:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                                                                          <span class="c1"># needs scipy</span>
<span class="go">Point on the 2-dimensional Riemannian manifold M</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>                                                                          <span class="c1"># needs scipy</span>
<span class="go">Point on the 2-dimensional Riemannian manifold M</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">which corresponds to the following <span class="math notranslate nohighlight">\((x, y)\)</span> coordinates:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">X</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># abs tol 1e-12                                                      # needs scipy</span>
<span class="go">(2.4784140715580136, 1.5141683866138937)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>  <span class="c1"># abs tol 1e-12                                                      # needs scipy</span>
<span class="go">(2.4784140715580136, 1.5141683866138937)</span>
</pre></div>
</div>
</div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Karim Van Aelst (2017): initial version</p></li>
<li><p>Florentin Jaffredo (2018): integration over multiple charts, use of
<code class="docutils literal notranslate"><span class="pre">fast_callable</span></code> to improve the computation speed</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.manifolds.differentiable.integrated_curve.</span></span><span class="sig-name descname"><span class="pre">IntegratedAutoparallelCurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_tangent_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">across_charts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L2872"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a></p>
<p>Autoparallel curve on the manifold with respect to a given
affine connection.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parent</span></code> –
<a class="reference internal" href="manifold_homset.html#sage.manifolds.differentiable.manifold_homset.IntegratedAutoparallelCurveSet" title="sage.manifolds.differentiable.manifold_homset.IntegratedAutoparallelCurveSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedAutoparallelCurveSet</span></code></a>
the set of curves <span class="math notranslate nohighlight">\(\mathrm{Hom_{autoparallel}}(I, M)\)</span> to which the
curve belongs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">affine_connection</span></code> –
<a class="reference internal" href="affine_connection.html#sage.manifolds.differentiable.affine_connection.AffineConnection" title="sage.manifolds.differentiable.affine_connection.AffineConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">AffineConnection</span></code></a>
affine connection with respect to which the curve is autoparallel</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curve_parameter</span></code> – symbolic expression to be used as the
parameter of the curve (the equations defining an instance of
IntegratedAutoparallelCurve are such that <code class="docutils literal notranslate"><span class="pre">t</span></code> will actually be
an affine parameter of the curve)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_tangent_vector</span></code> –
<a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
initial tangent vector of the curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chart</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) chart on the manifold in terms of
which the equations are expressed; if <code class="docutils literal notranslate"><span class="pre">None</span></code> the default chart
of the manifold is assumed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; symbol given to the curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to
denote the curve; if none is provided, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Autoparallel curves associated with the Mercator projection of the
unit 2-sphere <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://idontgetoutmuch.wordpress.com/2016/11/24/mercator-a-connection-with-torsion/">https://idontgetoutmuch.wordpress.com/2016/11/24/mercator-a-connection-with-torsion/</a>
for more details about Mercator projection.</p>
</div>
<p>On the Mercator projection, the lines of longitude all appear
vertical and then all parallel with respect to each other.
Likewise, all the lines of latitude appear horizontal and parallel
with respect to each other.
These curves may be recovered as autoparallel curves of a certain
connection <span class="math notranslate nohighlight">\(\nabla\)</span> to be made explicit.</p>
<p class="with-sage-tab with-python-tab">Start with declaring the standard polar coordinates
<span class="math notranslate nohighlight">\((\theta, \phi)\)</span> on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> and the
corresponding coordinate frame <span class="math notranslate nohighlight">\((e_{\theta}, e_{\phi})\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">polar</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;=</span><span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">epolar</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">polar</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;th&#39;</span><span class="p">,</span> <span class="s1">&#39;ph&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="n">ph</span><span class="p">,)</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">epolar</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Normalizing <span class="math notranslate nohighlight">\(e_{\phi}\)</span> provides an orthonormal basis:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">ch_basis</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">automorphism_field</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">ch_basis</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">ch_basis</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">epolar_ON</span> <span class="o">=</span> <span class="n">epolar</span><span class="o">.</span><span class="n">new_frame</span><span class="p">(</span><span class="n">ch_basis</span><span class="p">,</span><span class="s1">&#39;epolar_ON&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ch_basis</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">automorphism_field</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ch_basis</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="n">ch_basis</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">epolar_ON</span> <span class="o">=</span> <span class="n">epolar</span><span class="o">.</span><span class="n">new_frame</span><span class="p">(</span><span class="n">ch_basis</span><span class="p">,</span><span class="s1">&#39;epolar_ON&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Denote <span class="math notranslate nohighlight">\((\hat{e}_{\theta}, \hat{e}_{\phi})\)</span> such an orthonormal frame
field. In any point, the vector field <span class="math notranslate nohighlight">\(\hat{e}_{\theta}\)</span> is
normalized and tangent to the line of longitude through the point.
Likewise, <span class="math notranslate nohighlight">\(\hat{e}_{\phi}\)</span> is normalized and tangent to the
line of latitude.</p>
<p class="with-sage-tab with-python-tab">Now, set an affine connection with respect to such fields that are
parallelly transported in all directions, that is:
<span class="math notranslate nohighlight">\(\nabla \hat{e}_{\theta} = \nabla \hat{e}_{\phi} = 0\)</span>.
This is equivalent to setting all the connection coefficients to
zero with respect to this frame:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">nab</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">affine_connection</span><span class="p">(</span><span class="s1">&#39;nab&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">nab</span><span class="o">.</span><span class="n">set_coef</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">epolar_ON</span><span class="p">)[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">nab</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">affine_connection</span><span class="p">(</span><span class="s1">&#39;nab&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">nab</span><span class="o">.</span><span class="n">set_coef</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">epolar_ON</span><span class="p">)[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">This connection is such that two vectors are parallel if their
angles to a given meridian are the same.
Check that this connection is compatible with the Euclidean
metric tensor <span class="math notranslate nohighlight">\(g\)</span> induced on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage:</span> <span class="n">nab</span><span class="p">(</span><span class="n">g</span><span class="p">)[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">nab</span><span class="p">(</span><span class="n">g</span><span class="p">)[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Yet, this connection is not the Levi-Civita connection, which
implies that it has non-vanishing torsion:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">nab</span><span class="o">.</span><span class="n">torsion</span><span class="p">()[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, cos(th)/sin(th)], [-cos(th)/sin(th), 0]]]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">nab</span><span class="o">.</span><span class="n">torsion</span><span class="p">()[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, cos(th)/sin(th)], [-cos(th)/sin(th), 0]]]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Set generic initial conditions for the autoparallel curves to
compute:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="p">[</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;th0 ph0 v_th0 v_ph0&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">),</span> <span class="n">basis</span><span class="o">=</span><span class="n">epolar_ON</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;th0 ph0 v_th0 v_ph0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">),</span> <span class="n">basis</span><span class="o">=</span><span class="n">epolar_ON</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Note here that the components <code class="docutils literal notranslate"><span class="pre">(v_th0,</span> <span class="pre">v_ph0)</span></code> of the initial
tangent vector <code class="docutils literal notranslate"><span class="pre">v</span></code> refer to the basis
<code class="docutils literal notranslate"><span class="pre">epolar_ON</span></code> <span class="math notranslate nohighlight">\(= (\hat{e}_{\theta}, \hat{e}_{\phi})\)</span>
and not the coordinate basis <code class="docutils literal notranslate"><span class="pre">epolar</span></code> <span class="math notranslate nohighlight">\(= (e_{\theta}, e_{\phi})\)</span>.
This is merely to help picture the aspect of the tangent vector in
the usual embedding of <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> in
<span class="math notranslate nohighlight">\(\mathbb{R}^{3}\)</span> thanks to using an orthonormal frame,
since providing the components with respect to the coordinate basis
would require multiplying the second component (i.e. the <span class="math notranslate nohighlight">\(\phi\)</span>
component) in order to picture the vector in the same way.
This subtlety will need to be taken into account later when the
numerical curve will be compared to the analytical solution.</p>
<p class="with-sage-tab with-python-tab">Now, declare the corresponding integrated autoparallel curve and display
the differential system it satisfies:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t tmin tmax&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_autoparallel_curve</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">),</span>
<span class="gp">....:</span>                                  <span class="n">v</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Autoparallel curve c in the 2-dimensional differentiable</span>
<span class="go"> manifold S^2 equipped with Affine connection nab on the</span>
<span class="go"> 2-dimensional differentiable manifold S^2, and integrated over</span>
<span class="go"> the Real interval (tmin, tmax) as a solution to the following</span>
<span class="go"> equations, written with respect to Chart (S^2, (th, ph)):</span>

<span class="go">Initial point: Point p on the 2-dimensional differentiable</span>
<span class="go"> manifold S^2 with coordinates [th0, ph0] with respect to</span>
<span class="go"> Chart (S^2, (th, ph))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 2-dimensional differentiable manifold S^2 with</span>
<span class="go"> components [v_th0, v_ph0/sin(th0)] with respect to Chart (S^2, (th, ph))</span>

<span class="go">d(th)/dt = Dth</span>
<span class="go">d(ph)/dt = Dph</span>
<span class="go">d(Dth)/dt = 0</span>
<span class="go">d(Dph)/dt = -Dph*Dth*cos(th)/sin(th)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t tmin tmax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_autoparallel_curve</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">),</span>
<span class="gp">...</span>                                  <span class="n">v</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Autoparallel curve c in the 2-dimensional differentiable</span>
<span class="go"> manifold S^2 equipped with Affine connection nab on the</span>
<span class="go"> 2-dimensional differentiable manifold S^2, and integrated over</span>
<span class="go"> the Real interval (tmin, tmax) as a solution to the following</span>
<span class="go"> equations, written with respect to Chart (S^2, (th, ph)):</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Initial point: Point p on the 2-dimensional differentiable</span>
<span class="go"> manifold S^2 with coordinates [th0, ph0] with respect to</span>
<span class="go"> Chart (S^2, (th, ph))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 2-dimensional differentiable manifold S^2 with</span>
<span class="go"> components [v_th0, v_ph0/sin(th0)] with respect to Chart (S^2, (th, ph))</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">d(th)/dt = Dth</span>
<span class="go">d(ph)/dt = Dph</span>
<span class="go">d(Dth)/dt = 0</span>
<span class="go">d(Dph)/dt = -Dph*Dth*cos(th)/sin(th)</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Set a dictionary providing the parameter range and the initial
conditions for a line of latitude and a line of longitude:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">dict_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;latit&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....:</span>   <span class="s1">&#39;longi&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">0</span><span class="p">}}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">dict_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;latit&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">tmax</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)},</span>
<span class="gp">...</span>   <span class="s1">&#39;longi&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">tmax</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">th0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)}}</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Declare the Mercator coordinates <span class="math notranslate nohighlight">\((\xi, \zeta)\)</span> and the
corresponding coordinate change from the polar coordinates:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">mercator</span><span class="o">.&lt;</span><span class="n">xi</span><span class="p">,</span><span class="n">ze</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;xi:(-oo,oo):\xi ze:(0,2*pi):\zeta&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">polar</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">mercator</span><span class="p">,</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">th</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="n">ph</span><span class="p">))</span>
<span class="go">Change of coordinates from Chart (S^2, (th, ph)) to Chart</span>
<span class="go"> (S^2, (xi, ze))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">mercator</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;xi:(-oo,oo):\xi ze:(0,2*pi):\zeta&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;xi&#39;</span><span class="p">,</span> <span class="s1">&#39;ze&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">ze</span><span class="p">,)</span> <span class="o">=</span> <span class="n">mercator</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">polar</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">mercator</span><span class="p">,</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">th</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))),</span> <span class="n">ph</span><span class="p">))</span>
<span class="go">Change of coordinates from Chart (S^2, (th, ph)) to Chart</span>
<span class="go"> (S^2, (xi, ze))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Ask for the identity map in terms of these charts in order to add
this coordinate change to its dictionary of expressions. This is
required to plot the curve with respect to the Mercator chart:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">identity</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">identity_map</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">identity</span><span class="o">.</span><span class="n">coord_functions</span><span class="p">(</span><span class="n">polar</span><span class="p">,</span> <span class="n">mercator</span><span class="p">)</span>
<span class="go">Coordinate functions (log(sin(1/2*th)/cos(1/2*th)), ph) on the</span>
<span class="go"> Chart (S^2, (th, ph))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">identity</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">identity_map</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">identity</span><span class="o">.</span><span class="n">coord_functions</span><span class="p">(</span><span class="n">polar</span><span class="p">,</span> <span class="n">mercator</span><span class="p">)</span>
<span class="go">Coordinate functions (log(sin(1/2*th)/cos(1/2*th)), ph) on the</span>
<span class="go"> Chart (S^2, (th, ph))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Solve, interpolate and prepare the plot for the solutions
corresponding to the two initial conditions previously set:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph2D_mercator</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">....:</span>     <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....:</span>                        <span class="n">parameters_values</span><span class="o">=</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<span class="gp">....:</span>     <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....:</span>                           <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="n">graph2D_mercator</span><span class="o">+=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....:</span>                               <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph2D_mercator</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">...</span>     <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">...</span>                        <span class="n">parameters_values</span><span class="o">=</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<span class="gp">...</span>     <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">...</span>                           <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)</span>
<span class="gp">...</span>     <span class="n">graph2D_mercator</span><span class="o">+=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">...</span>                               <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Prepare a grid of Mercator coordinates lines, and plot the curves
over it:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph2D_mercator_coords</span><span class="o">=</span><span class="n">mercator</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span>
<span class="gp">....:</span>                            <span class="n">number_values</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph2D_mercator</span> <span class="o">+</span> <span class="n">graph2D_mercator_coords</span>
<span class="go">Graphics object consisting of 18 graphics primitives</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph2D_mercator_coords</span><span class="o">=</span><span class="n">mercator</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span>
<span class="gp">...</span>                            <span class="n">number_values</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph2D_mercator</span> <span class="o">+</span> <span class="n">graph2D_mercator_coords</span>
<span class="go">Graphics object consisting of 18 graphics primitives</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-2.svg" class="plot-directive" src="../../../_images/integrated_curve-2.svg" />
</figure>
<p class="with-sage-tab with-python-tab">The resulting curves are horizontal and vertical as expected.
It is easier to check that these are latitude and longitude lines
respectively when plotting them on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>.
To do so, use <span class="math notranslate nohighlight">\(\mathbb{R}^{3}\)</span> as the codomain of the standard
map embedding <span class="math notranslate nohighlight">\((\mathbb{S}^{2}, (\theta, \phi))\)</span> in the
3-dimensional Euclidean space:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;R3&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">cart</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R3</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">euclid_embedding</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">R3</span><span class="p">,</span>
<span class="gp">....:</span>  <span class="p">{(</span><span class="n">polar</span><span class="p">,</span> <span class="n">cart</span><span class="p">):[</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;R3&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">cart</span> <span class="o">=</span> <span class="n">R3</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cart</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">euclid_embedding</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">R3</span><span class="p">,</span>
<span class="gp">...</span>  <span class="p">{(</span><span class="n">polar</span><span class="p">,</span> <span class="n">cart</span><span class="p">):[</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Plot the resulting curves on the grid of polar coordinates lines on
<span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_curves</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">....:</span>     <span class="n">graph3D_embedded_curves</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....:</span>            <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">....:</span>            <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_polar_coords</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">cart</span><span class="p">,</span>
<span class="gp">....:</span>                          <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">....:</span>                          <span class="n">number_values</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_curves</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_curves</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">...</span>     <span class="n">graph3D_embedded_curves</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">...</span>            <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">...</span>            <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.4&#39;</span><span class="p">),</span> <span class="n">width_tangent</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_polar_coords</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">cart</span><span class="p">,</span>
<span class="gp">...</span>                          <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">...</span>                          <span class="n">number_values</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_curves</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-3.svg" class="plot-directive" src="../../../_images/integrated_curve-3.svg" />
</figure>
<p class="with-sage-tab with-python-tab">Finally, one may plot a general autoparallel curve with respect to
<span class="math notranslate nohighlight">\(\nabla\)</span> that is neither a line of latitude or longitude.
The vectors tangent to such a curve make an angle different from 0
or <span class="math notranslate nohighlight">\(\pi/2\)</span> with the lines of latitude and longitude.
Then, compute a curve such that both components of its initial
tangent vectors are nonzero:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-angle&#39;</span><span class="p">,</span>
<span class="gp">....:</span>  <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-angle&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                          <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-angle&#39;</span><span class="p">,</span>
<span class="gp">...</span>  <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">tmin</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">tmax</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-angle&#39;</span><span class="p">,</span>
<span class="gp">...</span>                          <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Plot the resulting curve in the Mercator plane.
This generates a straight line, as expected:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>                       <span class="c1"># needs scipy sage.plot</span>
<span class="gp">....:</span>         <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">....:</span>         <span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>                       <span class="c1"># needs scipy sage.plot</span>
<span class="gp">...</span>         <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">...</span>         <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">),</span> <span class="n">width_tangent</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">))</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-4.svg" class="plot-directive" src="../../../_images/integrated_curve-4.svg" />
</figure>
<p class="with-sage-tab with-python-tab">One may eventually plot such a curve on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--25-input--1" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_angle_curve</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_angle_curve</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--25-input--2" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_angle_curve</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">...</span>        <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span> <span class="n">width_tangent</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_angle_curve</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-5.svg" class="plot-directive" src="../../../_images/integrated_curve-5.svg" />
</figure>
<p>All the curves presented are loxodromes, and the differential system
defining them (displayed above) may be solved analytically,
providing the following expressions:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\theta(t) &amp;= \theta_{0} + \dot{\theta}_{0} (t - t_{0}),      \\
\phi(t) &amp;= \phi_{0} - \frac{1}{\tan \alpha} \left(
\ln \tan \frac{\theta_{0} + \dot{\theta}_{0} (t - t_{0})}{2} -
\ln \tan \frac{\theta_{0}}{2} \right),
\end{aligned}\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the angle between the curve and any latitude
line it crosses; then, one finds
<span class="math notranslate nohighlight">\(\tan \alpha = - \dot{\theta}_{0} / (\dot{\phi}_{0} \sin \theta_{0})\)</span>
(then <span class="math notranslate nohighlight">\(\tan \alpha \leq 0\)</span> when the initial tangent vector
points towards the southeast).</p>
<p>In order to use these expressions to compare with the result
provided by the numerical integration, remember that the components
<code class="docutils literal notranslate"><span class="pre">(v_th0,</span> <span class="pre">v_ph0)</span></code> of the initial
tangent vector <code class="docutils literal notranslate"><span class="pre">v</span></code> refer to the basis
<code class="docutils literal notranslate"><span class="pre">epolar_ON</span></code> <span class="math notranslate nohighlight">\(= (\hat{e}_{\theta}, \hat{e}_{\phi})\)</span> and not the
coordinate basis
<code class="docutils literal notranslate"><span class="pre">epolar</span></code> <span class="math notranslate nohighlight">\(= (e_{\theta}, e_{\phi})\)</span>.
Therefore, the following relations hold:
<code class="docutils literal notranslate"><span class="pre">v_ph0</span></code> <span class="math notranslate nohighlight">\(= \dot{\phi}_{0} \sin \theta_{0}\)</span> (and not merely
<span class="math notranslate nohighlight">\(\dot{\phi}_{0}\)</span>), while <code class="docutils literal notranslate"><span class="pre">v_th0</span></code> clearly is <span class="math notranslate nohighlight">\(\dot{\theta}_{0}\)</span>.</p>
<p class="with-sage-tab with-python-tab">With this in mind, plot an analytical curve to compare with a
numerical solution:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--26-input--1" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph2D_mercator_angle_curve</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                               <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">expr_ph</span> <span class="o">=</span> <span class="n">ph0</span><span class="o">+</span><span class="n">v_ph0</span><span class="o">/</span><span class="n">v_th0</span><span class="o">*</span><span class="p">(</span><span class="n">ln</span><span class="p">(</span><span class="n">tan</span><span class="p">((</span><span class="n">v_th0</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">th0</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">-</span><span class="n">ln</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">th0</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">sage:</span> <span class="n">c_loxo</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">curve</span><span class="p">({</span><span class="n">polar</span><span class="p">:[</span><span class="n">th0</span><span class="o">+</span><span class="n">v_th0</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">expr_ph</span><span class="p">]},</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....:</span>                                             <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c_loxo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--26-input--2" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph2D_mercator_angle_curve</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">...</span>                               <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">expr_ph</span> <span class="o">=</span> <span class="n">ph0</span><span class="o">+</span><span class="n">v_ph0</span><span class="o">/</span><span class="n">v_th0</span><span class="o">*</span><span class="p">(</span><span class="n">ln</span><span class="p">(</span><span class="n">tan</span><span class="p">((</span><span class="n">v_th0</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">th0</span><span class="p">)</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">-</span><span class="n">ln</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">th0</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_loxo</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">curve</span><span class="p">({</span><span class="n">polar</span><span class="p">:[</span><span class="n">th0</span><span class="o">+</span><span class="n">v_th0</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">expr_ph</span><span class="p">]},</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span>
<span class="gp">...</span>                                             <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c_loxo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Ask for the expression of the loxodrome in terms of the Mercator
chart in order to add it to its dictionary of expressions.
It is a particularly long expression, and there is no particular
need to display it, which is why it may simply be affected to an
arbitrary variable <code class="docutils literal notranslate"><span class="pre">expr_mercator</span></code>, which will never be used
again.
But adding the expression to the dictionary is required to plot the
curve with respect to the Mercator chart:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--27-input--1" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">expr_mercator</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="n">chart2</span><span class="o">=</span><span class="n">mercator</span><span class="p">)</span>                        <span class="c1"># needs scipy sage.plot</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--27-input--2" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">expr_mercator</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="n">chart2</span><span class="o">=</span><span class="n">mercator</span><span class="p">)</span>                        <span class="c1"># needs scipy sage.plot</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Plot the curves (for clarity, set a 2 degrees shift in the initial
value of <span class="math notranslate nohighlight">\(\theta_{0}\)</span> so that the curves do not overlap):</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--28-input--1" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph2D_mercator_loxo</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span>
<span class="gp">....:</span>  <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span>
<span class="gp">....:</span>  <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph2D_mercator_angle_curve</span> <span class="o">+</span> <span class="n">graph2D_mercator_loxo</span>
<span class="go">Graphics object consisting of 2 graphics primitives</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--28-input--2" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph2D_mercator_loxo</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span>
<span class="gp">...</span>  <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">180</span><span class="p">),</span> <span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span> <span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)},</span>
<span class="gp">...</span>  <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph2D_mercator_angle_curve</span> <span class="o">+</span> <span class="n">graph2D_mercator_loxo</span>
<span class="go">Graphics object consisting of 2 graphics primitives</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-6.svg" class="plot-directive" src="../../../_images/integrated_curve-6.svg" />
</figure>
<p class="with-sage-tab with-python-tab">Both curves do have the same aspect.
One may eventually compare these curves on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--29-input--1" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_angle_curve</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                     <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_loxo</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">....:</span>  <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span>
<span class="gp">....:</span>  <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="p">(</span><span class="n">graph3D_embedded_angle_curve</span> <span class="o">+</span> <span class="n">graph3D_embedded_loxo</span>
<span class="gp">....:</span>  <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span><span class="p">)</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--29-input--2" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_angle_curve</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">...</span>                     <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_loxo</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">...</span>  <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">180</span><span class="p">),</span> <span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span> <span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)},</span>
<span class="gp">...</span>  <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">graph3D_embedded_angle_curve</span> <span class="o">+</span> <span class="n">graph3D_embedded_loxo</span>
<span class="gp">...</span>  <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span><span class="p">)</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-7.svg" class="plot-directive" src="../../../_images/integrated_curve-7.svg" />
</figure>
<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve.system">
<span class="sig-name descname"><span class="pre">system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L3551"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve.system" title="Link to this definition">¶</a></dt>
<dd><p>Provide a detailed description of the system defining the
autoparallel curve and returns the system defining it: chart,
equations and initial conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints a detailed
description of the curve</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>list containing the</p>
<ul>
<li><p>the equations</p></li>
<li><p>the initial conditions</p></li>
<li><p>the chart</p></li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">System defining an autoparallel curve:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--30-input--1" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t A B&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">nab</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">affine_connection</span><span class="p">(</span><span class="s1">&#39;nabla&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\nabla&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">nab</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">B</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x3</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_autoparallel_curve</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Autoparallel curve in the 3-dimensional differentiable</span>
<span class="go"> manifold M equipped with Affine connection nabla on the</span>
<span class="go"> 3-dimensional differentiable manifold M, and integrated</span>
<span class="go"> over the Real interval (0, 5) as a solution to the</span>
<span class="go"> following equations, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = -A*Dx1*Dx2*x1^2</span>
<span class="go">d(Dx2)/dt = 0</span>
<span class="go">d(Dx3)/dt = -B*Dx2*Dx3*x2*x3</span>

<span class="gp">sage:</span> <span class="n">sys_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">sys_bis</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--30-input--2" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t A B&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">nab</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">affine_connection</span><span class="p">(</span><span class="s1">&#39;nabla&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\nabla&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">nab</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span><span class="n">nab</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">B</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_autoparallel_curve</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Autoparallel curve in the 3-dimensional differentiable</span>
<span class="go"> manifold M equipped with Affine connection nabla on the</span>
<span class="go"> 3-dimensional differentiable manifold M, and integrated</span>
<span class="go"> over the Real interval (0, 5) as a solution to the</span>
<span class="go"> following equations, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = -A*Dx1*Dx2*x1^2</span>
<span class="go">d(Dx2)/dt = 0</span>
<span class="go">d(Dx3)/dt = -B*Dx2*Dx3*x2*x3</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys_bis</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.manifolds.differentiable.integrated_curve.</span></span><span class="sig-name descname"><span class="pre">IntegratedCurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equations_rhs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_tangent_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">across_charts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="curve.html#sage.manifolds.differentiable.curve.DifferentiableCurve" title="sage.manifolds.differentiable.curve.DifferentiableCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentiableCurve</span></code></a></p>
<p>Given a chart with coordinates denoted <span class="math notranslate nohighlight">\((x_{1}, \ldots, x_{n})\)</span>,
an instance of <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a> is a curve
<span class="math notranslate nohighlight">\(t \mapsto (x_{1}(t), \ldots, x_{n}(t))\)</span> constructed as a
solution to a system of second order differential equations
satisfied by the coordinate curves <span class="math notranslate nohighlight">\(t \mapsto x_{i}(t)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parent</span></code> –
<a class="reference internal" href="manifold_homset.html#sage.manifolds.differentiable.manifold_homset.IntegratedCurveSet" title="sage.manifolds.differentiable.manifold_homset.IntegratedCurveSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurveSet</span></code></a>
the set of curves <span class="math notranslate nohighlight">\(\mathrm{Hom_{integrated}}(I, M)\)</span> to which the
curve belongs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">equations_rhs</span></code> – list of the right-hand sides of the equations
on the velocities only (the term <em>velocity</em> referring to the
derivatives <span class="math notranslate nohighlight">\(d x_{i} / dt\)</span> of the coordinate curves)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">velocities</span></code> – list of the symbolic expressions used in
<code class="docutils literal notranslate"><span class="pre">equations_rhs</span></code> to denote the velocities</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curve_parameter</span></code> – symbolic expression used in
<code class="docutils literal notranslate"><span class="pre">equations_rhs</span></code> to denote the parameter of the curve (denoted
<span class="math notranslate nohighlight">\(t\)</span> in the descriptions above)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_tangent_vector</span></code> –
<a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
initial tangent vector of the curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chart</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) chart on the manifold in
which the equations are given; if <code class="docutils literal notranslate"><span class="pre">None</span></code> the default chart
of the manifold is assumed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; symbol given to the curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to
denote the curve; if none is provided, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Motion of a charged particle in an axial magnetic field linearly
increasing in time and exponentially decreasing in space:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathbf{B}(t,\mathbf{x}) = \frac{B_{0}t}{T} \exp \left(
-\frac{ x_{1}^{2} + x_{2}^{2} }{ L^{2} } \right) \mathbf{e_{3}}.\]</div>
</div>
<p>Equations of motion are:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\ddot{x}_{1}(t) &amp;= \frac{qB(t,\mathbf{x}(t))}{m} \dot{x}_{2}(t), \\
\ddot{x}_{2}(t) &amp;= -\frac{qB(t, \mathbf{x}(t))}{m} \dot{x}_{1}(t), \\
\ddot{x}_{3}(t) &amp;= 0.
\end{aligned}\end{split}\]</div>
</div>
<p class="with-sage-tab with-python-tab">Start with declaring a chart on a 3-dimensional manifold and the
symbolic expressions denoting the velocities and the various
parameters:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--31-input--1" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="go">(t, B_0, m, q, L, T)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[Dx1, Dx2, Dx3]</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--31-input--2" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="go">(t, B_0, m, q, L, T)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">L</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[Dx1, Dx2, Dx3]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Set the initial conditions:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--32-input--1" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--32-input--2" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Declare an integrated curve and display information relative to it:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--33-input--1" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                                              <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">The curve was correctly set.</span>
<span class="go">Parameters appearing in the differential system defining the</span>
<span class="go"> curve are [B_0, L, T, m, q].</span>
<span class="gp">sage:</span> <span class="n">c</span>
<span class="go">Integrated curve c in the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">sage:</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to the</span>
<span class="go"> following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on</span>
<span class="go"> the 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx3)/dt = 0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--33-input--2" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
<span class="gp">...</span>                                              <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">The curve was correctly set.</span>
<span class="go">Parameters appearing in the differential system defining the</span>
<span class="go"> curve are [B_0, L, T, m, q].</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span>
<span class="go">Integrated curve c in the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to the</span>
<span class="go"> following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on</span>
<span class="go"> the 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx3)/dt = 0</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Generate a solution of the system and an interpolation of this
solution:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--34-input--1" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>                                                   <span class="c1"># needs scipy</span>
<span class="gp">....:</span>         <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....:</span>         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 1&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Performing numerical integration with method &#39;odeint&#39;...</span>
<span class="go">Numerical integration completed.</span>

<span class="go">Checking all points are in the chart domain...</span>
<span class="go">All points are in the chart domain.</span>

<span class="go">The resulting list of points was associated with the key</span>
<span class="go"> &#39;carac time 1&#39; (if this key already referred to a former</span>
<span class="go"> numerical solution, such a solution was erased).</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 1&#39;</span><span class="p">,</span>                       <span class="c1"># needs scipy</span>
<span class="gp">....:</span>                <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Performing cubic spline interpolation by default...</span>
<span class="go">Interpolation completed and associated with the key &#39;interp 1&#39;</span>
<span class="go"> (if this key already referred to a former interpolation,</span>
<span class="go"> such an interpolation was erased).</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--34-input--2" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">),</span>                                                   <span class="c1"># needs scipy</span>
<span class="gp">...</span>         <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)},</span>
<span class="gp">...</span>         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 1&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Performing numerical integration with method &#39;odeint&#39;...</span>
<span class="go">Numerical integration completed.</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Checking all points are in the chart domain...</span>
<span class="go">All points are in the chart domain.</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">The resulting list of points was associated with the key</span>
<span class="go"> &#39;carac time 1&#39; (if this key already referred to a former</span>
<span class="go"> numerical solution, such a solution was erased).</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 1&#39;</span><span class="p">,</span>                       <span class="c1"># needs scipy</span>
<span class="gp">...</span>                <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Performing cubic spline interpolation by default...</span>
<span class="go">Interpolation completed and associated with the key &#39;interp 1&#39;</span>
<span class="go"> (if this key already referred to a former interpolation,</span>
<span class="go"> such an interpolation was erased).</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Such an interpolation is required to evaluate the curve and the
vector tangent to the curve for any value of the curve parameter:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--35-input--1" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Evaluating point coordinates from the interpolation associated</span>
<span class="go"> with the key &#39;interp 1&#39; by default...</span>
<span class="gp">sage:</span> <span class="n">p</span>
<span class="go">Point on the 3-dimensional differentiable manifold M</span>
<span class="gp">sage:</span> <span class="n">p</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">(1.377689074756845, -0.900114533011232, 1.9)</span>
<span class="gp">sage:</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="mf">4.3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Evaluating tangent vector components from the interpolation</span>
<span class="go"> associated with the key &#39;interp 1&#39; by default...</span>
<span class="gp">sage:</span> <span class="n">v2</span>
<span class="go">Tangent vector at Point on the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">sage:</span> <span class="n">v2</span><span class="p">[:]</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">[-0.9425156073651124, -0.33724314284285434, 1.0]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--35-input--2" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;1.9&#39;</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Evaluating point coordinates from the interpolation associated</span>
<span class="go"> with the key &#39;interp 1&#39; by default...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span>
<span class="go">Point on the 3-dimensional differentiable manifold M</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">(1.377689074756845, -0.900114533011232, 1.9)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;4.3&#39;</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Evaluating tangent vector components from the interpolation</span>
<span class="go"> associated with the key &#39;interp 1&#39; by default...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v2</span>
<span class="go">Tangent vector at Point on the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v2</span><span class="p">[:]</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">[-0.9425156073651124, -0.33724314284285434, 1.0]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Plotting a numerical solution (with or without its tangent vector
field) also requires the solution to be interpolated at least once:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--36-input--1" name="tab-set--36" type="radio"><label class="tab-label" for="tab-set--36-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">c_plot_2d_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">ambient_coords</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span>                  <span class="c1"># needs scipy</span>
<span class="gp">....:</span>               <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="gp">....:</span>               <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="gp">....:</span>               <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">....:</span>               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="gp">....:</span>               <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">A tiny final offset equal to 0.000251256281407035 was introduced</span>
<span class="go"> for the last point in order to safely compute it from the</span>
<span class="go"> interpolation.</span>
<span class="gp">sage:</span> <span class="n">c_plot_2d_1</span>                                                               <span class="c1"># needs scipy sage.plot</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--36-input--2" name="tab-set--36" type="radio"><label class="tab-label" for="tab-set--36-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_plot_2d_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">ambient_coords</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span>                  <span class="c1"># needs scipy</span>
<span class="gp">...</span>               <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.5&#39;</span><span class="p">),</span>
<span class="gp">...</span>               <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span>
<span class="gp">...</span>               <span class="n">plot_points_tangent</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">),</span>
<span class="gp">...</span>               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="gp">...</span>               <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">A tiny final offset equal to 0.000251256281407035 was introduced</span>
<span class="go"> for the last point in order to safely compute it from the</span>
<span class="go"> interpolation.</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_plot_2d_1</span>                                                               <span class="c1"># needs scipy sage.plot</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-8.svg" class="plot-directive" src="../../../_images/integrated_curve-8.svg" />
</figure>
<p class="with-sage-tab with-python-tab">An instance of <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a> may store several numerical
solutions and interpolations:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--37-input--1" name="tab-set--37" type="radio"><label class="tab-label" for="tab-set--37-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">....:</span>         <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">100</span><span class="p">},</span>
<span class="gp">....:</span>         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 100&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 100&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                            <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 100&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">c_plot_3d_100</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 100&#39;</span><span class="p">,</span>         <span class="c1"># needs sage.plot</span>
<span class="gp">....:</span>                   <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">....:</span>                   <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">....:</span>                   <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                   <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">c_plot_3d_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span>             <span class="c1"># needs sage.plot</span>
<span class="gp">....:</span>                   <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">....:</span>                   <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">....:</span>                   <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                   <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">c_plot_3d_1</span> <span class="o">+</span> <span class="n">c_plot_3d_100</span>                                               <span class="c1"># needs sage.plot</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--37-input--2" name="tab-set--37" type="radio"><label class="tab-label" for="tab-set--37-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">),</span>
<span class="gp">...</span>         <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">)},</span>
<span class="gp">...</span>         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 100&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 100&#39;</span><span class="p">,</span>
<span class="gp">...</span>                            <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 100&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_plot_3d_100</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 100&#39;</span><span class="p">,</span>         <span class="c1"># needs sage.plot</span>
<span class="gp">...</span>                   <span class="n">thickness</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.5&#39;</span><span class="p">),</span> <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">...</span>                   <span class="n">plot_points</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="n">plot_points_tangent</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="gp">...</span>                   <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
<span class="gp">...</span>                   <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_plot_3d_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span>             <span class="c1"># needs sage.plot</span>
<span class="gp">...</span>                   <span class="n">thickness</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.5&#39;</span><span class="p">),</span> <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">...</span>                   <span class="n">plot_points</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="n">plot_points_tangent</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="gp">...</span>                   <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
<span class="gp">...</span>                   <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_plot_3d_1</span> <span class="o">+</span> <span class="n">c_plot_3d_100</span>                                               <span class="c1"># needs sage.plot</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-9.svg" class="plot-directive" src="../../../_images/integrated_curve-9.svg" />
</figure>
<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L1885"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate the chosen numerical solution using the given
interpolation method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
numerical solution to interpolate is associated to ; a default
value is chosen if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) interpolation scheme to use;
algorithms available are</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'cubic</span> <span class="pre">spline'</span></code>, which makes use of <code class="docutils literal notranslate"><span class="pre">GSL</span></code> via
<a class="reference external" href="../../../../calculus/sage/calculus/interpolation.html#sage.calculus.interpolation.Spline" title="(in Symbolic Calculus v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spline</span></code></a></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
resulting interpolation will be associated to ; a default
value is given if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints information about
the interpolation in progress</p></li>
</ul>
<p>OUTPUT: built interpolation object</p>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Interpolating a numerical solution previously computed:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--38-input--1" name="tab-set--38" type="radio"><label class="tab-label" for="tab-set--38-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                        <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Interpolation completed and associated with the key</span>
<span class="go"> &#39;interp_T1&#39; (if this key already referred to a former</span>
<span class="go"> interpolation, such an interpolation was erased).</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Interpolating the numerical solution associated with the</span>
<span class="go"> key &#39;sol_T1&#39; by default...</span>
<span class="go">Performing cubic spline interpolation by default...</span>
<span class="go">Resulting interpolation will be associated with the key</span>
<span class="go"> &#39;cubic spline-interp-sol_T1&#39; by default.</span>
<span class="go">Interpolation completed and associated with the key</span>
<span class="go"> &#39;cubic spline-interp-sol_T1&#39; (if this key already referred</span>
<span class="go"> to a former interpolation, such an interpolation was</span>
<span class="go"> erased).</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--38-input--2" name="tab-set--38" type="radio"><label class="tab-label" for="tab-set--38-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">L</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">...</span>                        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>                        <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>                        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Interpolation completed and associated with the key</span>
<span class="go"> &#39;interp_T1&#39; (if this key already referred to a former</span>
<span class="go"> interpolation, such an interpolation was erased).</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Interpolating the numerical solution associated with the</span>
<span class="go"> key &#39;sol_T1&#39; by default...</span>
<span class="go">Performing cubic spline interpolation by default...</span>
<span class="go">Resulting interpolation will be associated with the key</span>
<span class="go"> &#39;cubic spline-interp-sol_T1&#39; by default.</span>
<span class="go">Interpolation completed and associated with the key</span>
<span class="go"> &#39;cubic spline-interp-sol_T1&#39; (if this key already referred</span>
<span class="go"> to a former interpolation, such an interpolation was</span>
<span class="go"> erased).</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolation">
<span class="sig-name descname"><span class="pre">interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolation_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L2024"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolation" title="Link to this definition">¶</a></dt>
<dd><p>Return the interpolation object associated with the given key.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
requested interpolation is associated to; a default
value is chosen if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints information about
the interpolation object returned</p></li>
</ul>
<p>OUTPUT: requested interpolation object</p>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Requesting an interpolation object previously computed:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--39-input--1" name="tab-set--39" type="radio"><label class="tab-label" for="tab-set--39-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                         <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">default_interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolation</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Returning the interpolation associated with the key</span>
<span class="go"> &#39;interp_T1&#39; by default...</span>
<span class="gp">sage:</span> <span class="n">default_interp</span> <span class="o">==</span> <span class="n">interp</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">interp_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolation</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">interp_mute</span> <span class="o">==</span> <span class="n">interp</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--39-input--2" name="tab-set--39" type="radio"><label class="tab-label" for="tab-set--39-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">L</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">...</span>                         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>                         <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">default_interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolation</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Returning the interpolation associated with the key</span>
<span class="go"> &#39;interp_T1&#39; by default...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">default_interp</span> <span class="o">==</span> <span class="n">interp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp_mute</span> <span class="o">==</span> <span class="n">interp</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated">
<span class="sig-name descname"><span class="pre">plot_integrated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambient_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_end_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_point_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.001,</span> <span class="pre">0.001)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_tangent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_tangent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">across_charts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_points_tangent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_tangent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L2274"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated" title="Link to this definition">¶</a></dt>
<dd><p>Plot the 2D or 3D projection of <code class="docutils literal notranslate"><span class="pre">self</span></code> onto the space of the
chosen two or three ambient coordinates, based on the
interpolation of a numerical solution previously computed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="curve.html#sage.manifolds.differentiable.curve.DifferentiableCurve.plot" title="sage.manifolds.differentiable.curve.DifferentiableCurve.plot"><code class="xref py py-class docutils literal notranslate"><span class="pre">plot</span></code></a>
for complete information about the input.</p>
</div>
<p>ADDITIONAL INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key associated to
the interpolation object used for the plot; a default value
is chosen if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints information about
the interpolation object used and the plotting in progress</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">display_tangent</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); determines whether
some tangent vectors should also be plotted</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color_tangent</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">blue</span></code>) color of the tangent
vectors when these are plotted</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_points_tangent</span></code> – (default: 10) number of tangent
vectors to display when these are plotted</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width_tangent</span></code> – (default: 1) sets the width of the arrows
representing the tangent vectors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> – (default: 1) scale applied to the tangent vectors
before displaying them</p></li>
</ul>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Trajectory of a particle of unit mass and unit charge in an
unit, axial, uniform, stationary magnetic field:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--40-input--1" name="tab-set--40" type="radio"><label class="tab-label" for="tab-set--40-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="go">t</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">c_plot_2d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">ambient_coords</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span>
<span class="gp">....:</span>                 <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="gp">....:</span>                 <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="gp">....:</span>                 <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">....:</span>                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                 <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Plotting from the interpolation associated with the key</span>
<span class="go"> &#39;cubic spline-interp-odeint&#39; by default...</span>
<span class="go">A tiny final offset equal to 0.000301507537688442 was</span>
<span class="go"> introduced for the last point in order to safely compute it</span>
<span class="go"> from the interpolation.</span>
<span class="gp">sage:</span> <span class="n">c_plot_2d</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--40-input--2" name="tab-set--40" type="radio"><label class="tab-label" for="tab-set--40-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="go">t</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_plot_2d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">ambient_coords</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span>
<span class="gp">...</span>                 <span class="n">thickness</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;2.5&#39;</span><span class="p">),</span>
<span class="gp">...</span>                 <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span>
<span class="gp">...</span>                 <span class="n">plot_points_tangent</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">),</span>
<span class="gp">...</span>                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="gp">...</span>                 <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Plotting from the interpolation associated with the key</span>
<span class="go"> &#39;cubic spline-interp-odeint&#39; by default...</span>
<span class="go">A tiny final offset equal to 0.000301507537688442 was</span>
<span class="go"> introduced for the last point in order to safely compute it</span>
<span class="go"> from the interpolation.</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c_plot_2d</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-10.svg" class="plot-directive" src="../../../_images/integrated_curve-10.svg" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solution">
<span class="sig-name descname"><span class="pre">solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L1823"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solution" title="Link to this definition">¶</a></dt>
<dd><p>Return the solution (list of points) associated with the given
key.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
requested numerical solution is associated to; a default
value is chosen if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints information about
the solution returned</p></li>
</ul>
<p>OUTPUT: list of the numerical points of the solution requested</p>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Requesting a numerical solution previously computed:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--41-input--1" name="tab-set--41" type="radio"><label class="tab-label" for="tab-set--41-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage:</span> <span class="n">sol_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Returning the numerical solution associated with the key</span>
<span class="go"> &#39;sol_T1&#39; by default...</span>
<span class="gp">sage:</span> <span class="n">sol_bis</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">sol_ter</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sol_ter</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
<span class="gp">sage:</span> <span class="n">sol_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">sol_mute</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--41-input--2" name="tab-set--41" type="radio"><label class="tab-label" for="tab-set--41-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">L</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Returning the numerical solution associated with the key</span>
<span class="go"> &#39;sol_T1&#39; by default...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_bis</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_ter</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_ter</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_mute</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'odeint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">control_param</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L931"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve" title="Link to this definition">¶</a></dt>
<dd><p>Integrate the curve numerically over the domain of definition.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) step of integration; default
value is a hundredth of the domain of integration if none is
provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'odeint'</span></code>) numerical scheme to
use for the integration of the curve; available algorithms are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'odeint'</span></code> – makes use of
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(in SciPy v1.12.0)"><code class="docutils literal notranslate"><span class="pre">scipy.integrate.odeint()</span></code></a>
via Sage solver
<a class="reference external" href="../../../../calculus/sage/calculus/desolvers.html#sage.calculus.desolvers.desolve_odeint" title="(in Symbolic Calculus v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_odeint()</span></code></a>; <code class="docutils literal notranslate"><span class="pre">odeint</span></code> invokes
the LSODA algorithm of the
<a class="reference external" href="https://www.netlib.org/odepack/">ODEPACK suite</a>, which
automatically selects between implicit Adams method (for non-stiff
problems) and a method based on backward differentiation formulas
(BDF) (for stiff problems).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rk4_maxima'</span></code> – 4th order classical Runge-Kutta, which
makes use of Maxima’s dynamics package via Sage solver
<a class="reference external" href="../../../../calculus/sage/calculus/desolvers.html#sage.calculus.desolvers.desolve_system_rk4" title="(in Symbolic Calculus v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_system_rk4()</span></code></a> (quite slow)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'dopri5'</span></code> – Dormand-Prince Runge-Kutta of order (4)5 provided by
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html#scipy.integrate.ode" title="(in SciPy v1.12.0)"><code class="docutils literal notranslate"><span class="pre">scipy.integrate.ode</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'dop853'</span></code> – Dormand-Prince Runge-Kutta of order 8(5,3) provided by
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html#scipy.integrate.ode" title="(in SciPy v1.12.0)"><code class="docutils literal notranslate"><span class="pre">scipy.integrate.ode</span></code></a></p></li>
</ul>
<p>and those provided by <code class="docutils literal notranslate"><span class="pre">GSL</span></code> via Sage class
<a class="reference external" href="../../../../calculus/sage/calculus/ode.html#sage.calculus.ode.ode_solver" title="(in Symbolic Calculus v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ode_solver</span></code></a>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'rk2'</span></code> – embedded Runge-Kutta (2,3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rk4'</span></code> – 4th order classical Runge-Kutta</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rkf45'</span></code> – Runge-Kutta-Felhberg (4,5)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rkck'</span></code> – embedded Runge-Kutta-Cash-Karp (4,5)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rk8pd'</span></code> – Runge-Kutta Prince-Dormand (8,9)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rk2imp'</span></code> – implicit 2nd order Runge-Kutta at Gaussian points</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rk4imp'</span></code> – implicit 4th order Runge-Kutta at Gaussian points</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'gear1'</span></code> – <span class="math notranslate nohighlight">\(M=1\)</span> implicit Gear</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'gear2'</span></code> – <span class="math notranslate nohighlight">\(M=2\)</span> implicit Gear</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bsimp'</span></code> – implicit Bulirsch-Stoer (requires Jacobian)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
resulting numerical solution will be associated to; a default
value is given if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameters_values</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) list of numerical
values of the parameters present in the system defining the
curve, to be substituted in the equations before integration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints information about
the computation in progress</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**control_param</span></code> – extra control parameters to be passed to the
chosen solver; see the example with <code class="docutils literal notranslate"><span class="pre">rtol</span></code> and <code class="docutils literal notranslate"><span class="pre">atol</span></code> below</p></li>
</ul>
<p>OUTPUT: list of the numerical points of the computed solution</p>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Computing a numerical solution:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--42-input--1" name="tab-set--42" type="radio"><label class="tab-label" for="tab-set--42-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>         <span class="c1"># needs scipy</span>
<span class="gp">....:</span>               <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Performing numerical integration with method &#39;odeint&#39;...</span>
<span class="go">Resulting list of points will be associated with the key</span>
<span class="go"> &#39;odeint&#39; by default.</span>
<span class="go">Numerical integration completed.</span>

<span class="go">Checking all points are in the chart domain...</span>
<span class="go">All points are in the chart domain.</span>

<span class="go">The resulting list of points was associated with the key</span>
<span class="go"> &#39;odeint&#39; (if this key already referred to a former</span>
<span class="go"> numerical solution, such a solution was erased).</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--42-input--2" name="tab-set--42" type="radio"><label class="tab-label" for="tab-set--42-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">L</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)},</span>         <span class="c1"># needs scipy</span>
<span class="gp">...</span>               <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Performing numerical integration with method &#39;odeint&#39;...</span>
<span class="go">Resulting list of points will be associated with the key</span>
<span class="go"> &#39;odeint&#39; by default.</span>
<span class="go">Numerical integration completed.</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Checking all points are in the chart domain...</span>
<span class="go">All points are in the chart domain.</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">The resulting list of points was associated with the key</span>
<span class="go"> &#39;odeint&#39; (if this key already referred to a former</span>
<span class="go"> numerical solution, such a solution was erased).</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The first 3 points of the solution, in the form <code class="docutils literal notranslate"><span class="pre">[t,</span> <span class="pre">x1,</span> <span class="pre">x2,</span> <span class="pre">x3]</span></code>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--43-input--1" name="tab-set--43" type="radio"><label class="tab-label" for="tab-set--43-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sol</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># abs tol 1e-12                                              # needs scipy</span>
<span class="go">[[0.0, 0.0, 0.0, 0.0],</span>
<span class="go"> [0.05, 0.04999999218759271, -2.083327338392213e-05, 0.05],</span>
<span class="go"> [0.1, 0.09999975001847655, -0.00016666146190783666, 0.1]]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--43-input--2" name="tab-set--43" type="radio"><label class="tab-label" for="tab-set--43-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span><span class="p">[:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>  <span class="c1"># abs tol 1e-12                                              # needs scipy</span>
<span class="go">[[0.0, 0.0, 0.0, 0.0],</span>
<span class="go"> [0.05, 0.04999999218759271, -2.083327338392213e-05, 0.05],</span>
<span class="go"> [0.1, 0.09999975001847655, -0.00016666146190783666, 0.1]]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The default is <code class="docutils literal notranslate"><span class="pre">verbose=False</span></code>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--44-input--1" name="tab-set--44" type="radio"><label class="tab-label" for="tab-set--44-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sol_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>                <span class="c1"># needs scipy</span>
<span class="gp">....:</span>                                       <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage:</span> <span class="n">sol_mute</span> <span class="o">==</span> <span class="n">sol</span>                                                       <span class="c1"># needs scipy</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--44-input--2" name="tab-set--44" type="radio"><label class="tab-label" for="tab-set--44-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                <span class="c1"># needs scipy</span>
<span class="gp">...</span>                                       <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol_mute</span> <span class="o">==</span> <span class="n">sol</span>                                                       <span class="c1"># needs scipy</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Specifying the relative and absolute error tolerance parameters to
be used in <a class="reference external" href="../../../../calculus/sage/calculus/desolvers.html#sage.calculus.desolvers.desolve_odeint" title="(in Symbolic Calculus v10.6.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_odeint()</span></code></a>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--45-input--1" name="tab-set--45" type="radio"><label class="tab-label" for="tab-set--45-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>         <span class="c1"># needs scipy</span>
<span class="gp">....:</span>               <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--45-input--2" name="tab-set--45" type="radio"><label class="tab-label" for="tab-set--45-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)},</span>         <span class="c1"># needs scipy</span>
<span class="gp">...</span>               <span class="n">rtol</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;1e-12&#39;</span><span class="p">),</span> <span class="n">atol</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;1e-12&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Using a numerical method different from the default one:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--46-input--1" name="tab-set--46" type="radio"><label class="tab-label" for="tab-set--46-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>         <span class="c1"># needs scipy</span>
<span class="gp">....:</span>               <span class="n">method</span><span class="o">=</span><span class="s1">&#39;rk8pd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--46-input--2" name="tab-set--46" type="radio"><label class="tab-label" for="tab-set--46-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)},</span>         <span class="c1"># needs scipy</span>
<span class="gp">...</span>               <span class="n">method</span><span class="o">=</span><span class="s1">&#39;rk8pd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts">
<span class="sig-name descname"><span class="pre">solve_across_charts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">control_param</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L1412"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts" title="Link to this definition">¶</a></dt>
<dd><p>Integrate the curve numerically over the domain of integration, with
the ability to switch chart mid-integration.</p>
<p>The only supported solver is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html#scipy.integrate.ode" title="(in SciPy v1.12.0)"><code class="docutils literal notranslate"><span class="pre">scipy.integrate.ode</span></code></a>,
because it supports basic event handling, needed to detect when the
curve is reaching the frontier of the chart. This is an adaptive step
solver. So the <code class="docutils literal notranslate"><span class="pre">step</span></code> is not the step of integration but instead the
step used to peak at the current chart, and switch if needed.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) step of chart checking; default
value is a hundredth of the domain of integration if none is
provided. If your curve can’t find a new frame on exiting the
current frame, consider reducing this parameter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">charts</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) list of chart allowed. The
integration stops once it leaves those charts. By default the whole
atlas is taken (only the top-charts).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
resulting numerical solution will be associated to; a default
value is given if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameters_values</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) list of numerical
values of the parameters present in the system defining the
curve, to be substituted in the equations before integration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints information about
the computation in progress</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**control_param</span></code> – extra control parameters to be passed to the
solver</p></li>
</ul>
<p>OUTPUT: list of the numerical points of the computed solution</p>
<p>EXAMPLES:</p>
<p>Let us use <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_across_charts()</span></code></a> to integrate a geodesic of the
Euclidean plane (a straight line) in polar coordinates.</p>
<p>In pure polar coordinates <span class="math notranslate nohighlight">\((r, \theta)\)</span>, artefacts can appear near
the origin because of the fast variation of <span class="math notranslate nohighlight">\(\theta\)</span>, resulting in
the direction of the geodesic being different before and after
getting close to the origin.</p>
<p>The solution to this problem is to switch to Cartesian coordinates
near <span class="math notranslate nohighlight">\((0,0)\)</span> to avoid any singularity.</p>
<p class="with-sage-tab with-python-tab">First let’s declare the plane as a 2-dimensional manifold, with two
charts <span class="math notranslate nohighlight">\(P\)</span> en <span class="math notranslate nohighlight">\(C\)</span> (for “Polar” and “Cartesian”) and their transition
maps:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--47-input--1" name="tab-set--47" type="radio"><label class="tab-label" for="tab-set--47-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">C</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">coord_restrictions</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">P</span><span class="o">.&lt;</span><span class="n">r</span><span class="p">,</span><span class="n">th</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">coord_restrictions</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">:</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">P_to_C</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">C</span><span class="p">,(</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)))</span>
<span class="gp">sage:</span> <span class="n">C_to_P</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">P</span><span class="p">,(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--47-input--2" name="tab-set--47" type="radio"><label class="tab-label" for="tab-set--47-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">coord_restrictions</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,)</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">coord_restrictions</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">:</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;th&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">,)</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">P_to_C</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">C</span><span class="p">,(</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">C_to_P</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">P</span><span class="p">,(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>Here we added restrictions on those charts, to avoid any
singularity.  The intersection is the donut region <span class="math notranslate nohighlight">\(2 &lt; r &lt; 3\)</span>.</p>
<p class="with-sage-tab with-python-tab">We still have to define the metric. This is done in the Cartesian
frame. The metric in the polar frame is computed automatically:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--48-input--1" name="tab-set--48" type="radio"><label class="tab-label" for="tab-set--48-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="p">:</span> <span class="p">,</span><span class="n">P</span><span class="p">]</span>
<span class="go">[  1   0]</span>
<span class="go">[  0 r^2]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--48-input--2" name="tab-set--48" type="radio"><label class="tab-label" for="tab-set--48-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="p">:</span> <span class="p">,</span><span class="n">P</span><span class="p">]</span>
<span class="go">[  1   0]</span>
<span class="go">[  0 r^2]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">To visualize our manifold, let’s declare a mapping between every chart
and the Cartesian chart, and then plot each chart in term of this
mapping:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--49-input--1" name="tab-set--49" type="radio"><label class="tab-label" for="tab-set--49-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">number_values</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>                   <span class="c1"># needs sage.plot</span>
<span class="gp">....:</span>              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span> <span class="p">{</span><span class="n">r</span><span class="p">:(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">th</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)})</span>
<span class="gp">sage:</span> <span class="n">fig</span> <span class="o">+=</span> <span class="n">C</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">number_values</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>                 <span class="c1"># needs sage.plot</span>
<span class="gp">....:</span>               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">y</span><span class="p">:(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--49-input--2" name="tab-set--49" type="radio"><label class="tab-label" for="tab-set--49-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">number_values</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">chart</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>                   <span class="c1"># needs sage.plot</span>
<span class="gp">...</span>              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span> <span class="p">{</span><span class="n">r</span><span class="p">:(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)),</span> <span class="n">th</span><span class="p">:(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">+=</span> <span class="n">C</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">number_values</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">chart</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>                 <span class="c1"># needs sage.plot</span>
<span class="gp">...</span>               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="n">y</span><span class="p">:(</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))})</span>
</pre></div>
</div>
</div>
</div>
<p>There is a clear non-empty intersection between the two
charts. This is the key point to successfully switch chart during the
integration. Indeed, at least 2 points must fall in the intersection.</p>
<p class="rubric">Geodesic integration</p>
<p class="with-sage-tab with-python-tab">Let’s define the time as <span class="math notranslate nohighlight">\(t\)</span>, the initial point as <span class="math notranslate nohighlight">\(p\)</span>, and the
initial velocity vector as <span class="math notranslate nohighlight">\(v\)</span> (define as a member of the tangent
space <span class="math notranslate nohighlight">\(T_p\)</span>). The chosen geodesic should enter the central region
from the left and leave it to the right:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--50-input--1" name="tab-set--50" type="radio"><label class="tab-label" for="tab-set--50-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="n">pi</span><span class="o">+</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.03</span><span class="p">),</span> <span class="n">P</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--50-input--2" name="tab-set--50" type="radio"><label class="tab-label" for="tab-set--50-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">pi</span><span class="o">+</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.3&#39;</span><span class="p">)),</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.03&#39;</span><span class="p">)),</span> <span class="n">P</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">While creating the integrated geodesic, we need to specify the
optional argument <code class="docutils literal notranslate"><span class="pre">across_chart=True</span></code>, to prepare the compiled
version of the changes of charts:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--51-input--1" name="tab-set--51" type="radio"><label class="tab-label" for="tab-set--51-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">across_charts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--51-input--2" name="tab-set--51" type="radio"><label class="tab-label" for="tab-set--51-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">across_charts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The integration is done as usual, but using the method
<a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_across_charts()</span></code></a> instead of <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a>. This forces the
use of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html#scipy.integrate.ode" title="(in SciPy v1.12.0)"><code class="docutils literal notranslate"><span class="pre">scipy.integrate.ode</span></code></a> as the solver, because of event
handling support.</p>
<p class="with-sage-tab with-python-tab">The argument <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> will cause the solver to write a small
message each time it is switching chart:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--52-input--1" name="tab-set--52" type="radio"><label class="tab-label" for="tab-set--52-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve_across_charts</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                   <span class="c1"># needs scipy</span>
<span class="go">Performing numerical integration with method &#39;ode&#39;.</span>
<span class="go">Integration will take place on the whole manifold domain.</span>
<span class="go">Resulting list of points will be associated with the key &#39;ode_multichart&#39; by default.</span>
<span class="go">   ...</span>
<span class="go">Exiting chart, trying to switch to another chart.</span>
<span class="go">New chart found. Resuming integration.</span>
<span class="go">Exiting chart, trying to switch to another chart.</span>
<span class="go">New chart found. Resuming integration.</span>
<span class="go">Integration successful.</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--52-input--2" name="tab-set--52" type="radio"><label class="tab-label" for="tab-set--52-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve_across_charts</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                   <span class="c1"># needs scipy</span>
<span class="go">Performing numerical integration with method &#39;ode&#39;.</span>
<span class="go">Integration will take place on the whole manifold domain.</span>
<span class="go">Resulting list of points will be associated with the key &#39;ode_multichart&#39; by default.</span>
<span class="go">   ...</span>
<span class="go">Exiting chart, trying to switch to another chart.</span>
<span class="go">New chart found. Resuming integration.</span>
<span class="go">Exiting chart, trying to switch to another chart.</span>
<span class="go">New chart found. Resuming integration.</span>
<span class="go">Integration successful.</span>
</pre></div>
</div>
</div>
</div>
<p>As expected, two changes of chart occur.</p>
<p>The returned solution is a list of pairs <code class="docutils literal notranslate"><span class="pre">(chart,</span> <span class="pre">solution)</span></code>,
where each solution is given on a unique chart, and the last
point of a solution is the first of the next.</p>
<p class="with-sage-tab with-python-tab">The following code prints the corresponding charts:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--53-input--1" name="tab-set--53" type="radio"><label class="tab-label" for="tab-set--53-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="k">for</span> <span class="n">chart</span><span class="p">,</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>                                           <span class="c1"># needs scipy</span>
<span class="gp">....:</span>     <span class="nb">print</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
<span class="go">Chart (M, (r, th))</span>
<span class="go">Chart (M, (x, y))</span>
<span class="go">Chart (M, (r, th))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--53-input--2" name="tab-set--53" type="radio"><label class="tab-label" for="tab-set--53-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">chart</span><span class="p">,</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>                                           <span class="c1"># needs scipy</span>
<span class="gp">...</span>     <span class="nb">print</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
<span class="go">Chart (M, (r, th))</span>
<span class="go">Chart (M, (x, y))</span>
<span class="go">Chart (M, (r, th))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The interpolation is done as usual:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--54-input--1" name="tab-set--54" type="radio"><label class="tab-label" for="tab-set--54-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>                                              <span class="c1"># needs scipy</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--54-input--2" name="tab-set--54" type="radio"><label class="tab-label" for="tab-set--54-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>                                              <span class="c1"># needs scipy</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">To plot the result, you must first be sure that the mapping
encompasses all the chart, which is the case here.
You must also specify <code class="docutils literal notranslate"><span class="pre">across_charts=True</span></code> in order to call
<a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_integrated()</span></code></a> again on each part.
Finally, <code class="docutils literal notranslate"><span class="pre">color</span></code> can be a list, which will be cycled through:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--55-input--1" name="tab-set--55" type="radio"><label class="tab-label" for="tab-set--55-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">fig</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">],</span>          <span class="c1"># needs scipy sage.plot</span>
<span class="gp">....:</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">across_charts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">fig</span>                                                                   <span class="c1"># needs scipy sage.plot</span>
<span class="go">Graphics object consisting of 43 graphics primitives</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--55-input--2" name="tab-set--55" type="radio"><label class="tab-label" for="tab-set--55-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">],</span>          <span class="c1"># needs scipy sage.plot</span>
<span class="gp">...</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">across_charts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">fig</span>                                                                   <span class="c1"># needs scipy sage.plot</span>
<span class="go">Graphics object consisting of 43 graphics primitives</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-11.svg" class="plot-directive" src="../../../_images/integrated_curve-11.svg" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_analytical">
<span class="sig-name descname"><span class="pre">solve_analytical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L798"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_analytical" title="Link to this definition">¶</a></dt>
<dd><p>Solve the differential system defining <code class="docutils literal notranslate"><span class="pre">self</span></code> analytically.</p>
<p>Solve analytically the differential system defining a curve
using Maxima via Sage solver <code class="docutils literal notranslate"><span class="pre">desolve_system</span></code>.
In case of success, the analytical expressions are added to the
dictionary of expressions representing the curve.
Pay attention to the fact that <code class="docutils literal notranslate"><span class="pre">desolve_system</span></code> only considers
initial conditions given at an initial parameter value equal to
zero, although the parameter range may not contain zero.
Yet, assuming that it does, values of the coordinates functions
at such zero initial parameter value are denoted by the name of
the coordinate function followed by the string <code class="docutils literal notranslate"><span class="pre">'_0'</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>list of the analytical expressions of the coordinate functions
(when the differential system could be solved analytically),
or boolean <code class="docutils literal notranslate"><span class="pre">False</span></code> (in case the differential system could
not be solved analytically)</p></li>
</ul>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Analytical expression of the trajectory of a charged particle in
a uniform, stationary magnetic field:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--56-input--1" name="tab-set--56" type="radio"><label class="tab-label" for="tab-set--56-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to</span>
<span class="go"> the following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with components</span>
<span class="go"> [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q/m</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q/m</span>
<span class="go">d(Dx3)/dt = 0</span>

<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve_analytical</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">c</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">((B_0*q*x1_0 - Dx2_0*m*cos(B_0*q*t/m) +</span>
<span class="go">   Dx1_0*m*sin(B_0*q*t/m) + Dx2_0*m)/(B_0*q),</span>
<span class="go"> (B_0*q*x2_0 + Dx1_0*m*cos(B_0*q*t/m) +</span>
<span class="go">  Dx2_0*m*sin(B_0*q*t/m) - Dx1_0*m)/(B_0*q),</span>
<span class="go"> Dx3_0*t + x3_0)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--56-input--2" name="tab-set--56" type="radio"><label class="tab-label" for="tab-set--56-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to</span>
<span class="go"> the following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with components</span>
<span class="go"> [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q/m</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q/m</span>
<span class="go">d(Dx3)/dt = 0</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve_analytical</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">((B_0*q*x1_0 - Dx2_0*m*cos(B_0*q*t/m) +</span>
<span class="go">   Dx1_0*m*sin(B_0*q*t/m) + Dx2_0*m)/(B_0*q),</span>
<span class="go"> (B_0*q*x2_0 + Dx1_0*m*cos(B_0*q*t/m) +</span>
<span class="go">  Dx2_0*m*sin(B_0*q*t/m) - Dx1_0*m)/(B_0*q),</span>
<span class="go"> Dx3_0*t + x3_0)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.system">
<span class="sig-name descname"><span class="pre">system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L690"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.system" title="Link to this definition">¶</a></dt>
<dd><p>Provide a detailed description of the system defining the curve
and return the system defining it: chart, equations and initial
conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints a detailed
description of the curve</p></li>
</ul>
<p>OUTPUT: list containing</p>
<blockquote>
<div><ul class="simple">
<li><p>the equations</p></li>
<li><p>the initial conditions</p></li>
<li><p>the chart</p></li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">System defining an integrated curve:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--57-input--1" name="tab-set--57" type="radio"><label class="tab-label" for="tab-set--57-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to</span>
<span class="go"> the following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx3)/dt = 0</span>

<span class="gp">sage:</span> <span class="n">sys_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">sys_mute</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--57-input--2" name="tab-set--57" type="radio"><label class="tab-label" for="tab-set--57-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">L</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to</span>
<span class="go"> the following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx3)/dt = 0</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys_mute</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.tangent_vector_eval_at">
<span class="sig-name descname"><span class="pre">tangent_vector_eval_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L2174"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.tangent_vector_eval_at" title="Link to this definition">¶</a></dt>
<dd><p>Return the vector tangent to <code class="docutils literal notranslate"><span class="pre">self</span></code> at the given curve
parameter with components evaluated from the given
interpolation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> – curve parameter value at which the tangent vector is
evaluated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
interpolation requested to compute the tangent vector is
associated to; a default value is chosen if none is provided</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints information about
the interpolation used</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
tangent vector with numerical components</p></li>
</ul>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Evaluating a vector tangent to the curve:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--58-input--1" name="tab-set--58" type="radio"><label class="tab-label" for="tab-set--58-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">sage:</span> <span class="c1"># needs scipy</span>
<span class="gp">sage:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage:</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....:</span>                         <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">tg_vec</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="mf">1.22</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Evaluating tangent vector components from the interpolation</span>
<span class="go"> associated with the key &#39;interp_T1&#39; by default...</span>
<span class="gp">sage:</span> <span class="n">tg_vec</span>
<span class="go">Tangent vector at Point on the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">sage:</span> <span class="n">tg_vec</span><span class="p">[:]</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">[0.7392640422917979, -0.6734182509826023, 1.0]</span>
<span class="gp">sage:</span> <span class="n">tg_vec_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="mf">1.22</span><span class="p">,</span>
<span class="gp">....:</span>                         <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">tg_vec_mute</span> <span class="o">==</span> <span class="n">tg_vec</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--58-input--2" name="tab-set--58" type="radio"><label class="tab-label" for="tab-set--58-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">L</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">q</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">...</span>                         <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">...</span>                         <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">tg_vec</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;1.22&#39;</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Evaluating tangent vector components from the interpolation</span>
<span class="go"> associated with the key &#39;interp_T1&#39; by default...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">tg_vec</span>
<span class="go">Tangent vector at Point on the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">tg_vec</span><span class="p">[:]</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">[0.7392640422917979, -0.6734182509826023, 1.0]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">tg_vec_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;1.22&#39;</span><span class="p">),</span>
<span class="gp">...</span>                         <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">tg_vec_mute</span> <span class="o">==</span> <span class="n">tg_vec</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.manifolds.differentiable.integrated_curve.</span></span><span class="sig-name descname"><span class="pre">IntegratedGeodesic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_tangent_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">across_charts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L3665"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedAutoparallelCurve</span></code></a></p>
<p>Geodesic on the manifold with respect to a given metric.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parent</span></code> –
<a class="reference internal" href="manifold_homset.html#sage.manifolds.differentiable.manifold_homset.IntegratedGeodesicSet" title="sage.manifolds.differentiable.manifold_homset.IntegratedGeodesicSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedGeodesicSet</span></code></a>
the set of curves <span class="math notranslate nohighlight">\(\mathrm{Hom_{geodesic}}(I, M)\)</span> to which the
curve belongs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metric</span></code> –
<a class="reference internal" href="metric.html#sage.manifolds.differentiable.metric.PseudoRiemannianMetric" title="sage.manifolds.differentiable.metric.PseudoRiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">PseudoRiemannianMetric</span></code></a>
metric with respect to which the curve is a geodesic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curve_parameter</span></code> – symbolic expression to be used as the
parameter of the curve (the equations defining an instance of
IntegratedGeodesic are such that <code class="docutils literal notranslate"><span class="pre">t</span></code> will actually be an affine
parameter of the curve);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_tangent_vector</span></code> –
<a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
initial tangent vector of the curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chart</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) chart on the manifold in terms of
which the equations are expressed; if <code class="docutils literal notranslate"><span class="pre">None</span></code> the default chart
of the manifold is assumed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; symbol given to the curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to denote
the curve; if none is provided, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used</p></li>
</ul>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Geodesics of the unit 2-sphere <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>.
Start with declaring the standard polar coordinates
<span class="math notranslate nohighlight">\((\theta, \phi)\)</span> on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> and the
corresponding coordinate frame <span class="math notranslate nohighlight">\((e_{\theta}, e_{\phi})\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--59-input--1" name="tab-set--59" type="radio"><label class="tab-label" for="tab-set--59-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">polar</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;=</span><span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;th ph&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">epolar</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--59-input--2" name="tab-set--59" type="radio"><label class="tab-label" for="tab-set--59-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">polar</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;th ph&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;th&#39;</span><span class="p">,</span> <span class="s1">&#39;ph&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="n">ph</span><span class="p">,)</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">epolar</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Set the standard round metric:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--60-input--1" name="tab-set--60" type="radio"><label class="tab-label" for="tab-set--60-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--60-input--2" name="tab-set--60" type="radio"><label class="tab-label" for="tab-set--60-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Set generic initial conditions for the geodesics to compute:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--61-input--1" name="tab-set--61" type="radio"><label class="tab-label" for="tab-set--61-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="p">[</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;th0 ph0 v_th0 v_ph0&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">),</span> <span class="n">basis</span><span class="o">=</span><span class="n">epolar</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--61-input--2" name="tab-set--61" type="radio"><label class="tab-label" for="tab-set--61-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;th0 ph0 v_th0 v_ph0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">),</span> <span class="n">basis</span><span class="o">=</span><span class="n">epolar</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Declare the corresponding integrated geodesic and display the
differential system it satisfies:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--62-input--1" name="tab-set--62" type="radio"><label class="tab-label" for="tab-set--62-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t tmin tmax&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span>
<span class="gp">....:</span>                            <span class="n">chart</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Geodesic c in the 2-dimensional Riemannian manifold S^2</span>
<span class="go"> equipped with Riemannian metric g on the 2-dimensional</span>
<span class="go"> Riemannian manifold S^2, and integrated over the Real</span>
<span class="go"> interval (tmin, tmax) as a solution to the following geodesic</span>
<span class="go"> equations, written with respect to Chart (S^2, (th, ph)):</span>

<span class="go">Initial point: Point p on the 2-dimensional Riemannian</span>
<span class="go">manifold S^2 with coordinates [th0, ph0] with respect to</span>
<span class="go">Chart (S^2, (th, ph))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go">2-dimensional Riemannian manifold S^2 with</span>
<span class="go">components [v_th0, v_ph0] with respect to Chart (S^2, (th, ph))</span>

<span class="go">d(th)/dt = Dth</span>
<span class="go">d(ph)/dt = Dph</span>
<span class="go">d(Dth)/dt = Dph^2*cos(th)*sin(th)</span>
<span class="go">d(Dph)/dt = -2*Dph*Dth*cos(th)/sin(th)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--62-input--2" name="tab-set--62" type="radio"><label class="tab-label" for="tab-set--62-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t tmin tmax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span>
<span class="gp">...</span>                            <span class="n">chart</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Geodesic c in the 2-dimensional Riemannian manifold S^2</span>
<span class="go"> equipped with Riemannian metric g on the 2-dimensional</span>
<span class="go"> Riemannian manifold S^2, and integrated over the Real</span>
<span class="go"> interval (tmin, tmax) as a solution to the following geodesic</span>
<span class="go"> equations, written with respect to Chart (S^2, (th, ph)):</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Initial point: Point p on the 2-dimensional Riemannian</span>
<span class="go">manifold S^2 with coordinates [th0, ph0] with respect to</span>
<span class="go">Chart (S^2, (th, ph))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go">2-dimensional Riemannian manifold S^2 with</span>
<span class="go">components [v_th0, v_ph0] with respect to Chart (S^2, (th, ph))</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">d(th)/dt = Dth</span>
<span class="go">d(ph)/dt = Dph</span>
<span class="go">d(Dth)/dt = Dph^2*cos(th)*sin(th)</span>
<span class="go">d(Dph)/dt = -2*Dph*Dth*cos(th)/sin(th)</span>
<span class="go">&lt;BLANKLINE&gt;</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Set a dictionary providing the parameter range and the initial
conditions for various geodesics:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--63-input--1" name="tab-set--63" type="radio"><label class="tab-label" for="tab-set--63-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">dict_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;equat&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....:</span>   <span class="s1">&#39;longi&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span>
<span class="gp">....:</span>   <span class="s1">&#39;angle&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--63-input--2" name="tab-set--63" type="radio"><label class="tab-label" for="tab-set--63-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">dict_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;equat&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">tmax</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)},</span>
<span class="gp">...</span>   <span class="s1">&#39;longi&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">tmax</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">th0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
<span class="gp">...</span>   <span class="s1">&#39;angle&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">tmax</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ph0</span><span class="p">:</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">),</span><span class="n">v_th0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">v_ph0</span><span class="p">:</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)}}</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Use <span class="math notranslate nohighlight">\(\mathbb{R}^{3}\)</span> as the codomain of the standard map
embedding <span class="math notranslate nohighlight">\((\mathbb{S}^{2}, (\theta, \phi))\)</span> in the
3-dimensional Euclidean space:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--64-input--1" name="tab-set--64" type="radio"><label class="tab-label" for="tab-set--64-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;R3&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">cart</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R3</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">euclid_embedding</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">R3</span><span class="p">,</span>
<span class="gp">....:</span>  <span class="p">{(</span><span class="n">polar</span><span class="p">,</span> <span class="n">cart</span><span class="p">):[</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--64-input--2" name="tab-set--64" type="radio"><label class="tab-label" for="tab-set--64-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;R3&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">cart</span> <span class="o">=</span> <span class="n">R3</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cart</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">euclid_embedding</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">R3</span><span class="p">,</span>
<span class="gp">...</span>  <span class="p">{(</span><span class="n">polar</span><span class="p">,</span> <span class="n">cart</span><span class="p">):[</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Solve, interpolate and prepare the plot for the solutions
corresponding to the three initial conditions previously set:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--65-input--1" name="tab-set--65" type="radio"><label class="tab-label" for="tab-set--65-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_geods</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">....:</span>     <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....:</span>                        <span class="n">parameters_values</span><span class="o">=</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<span class="gp">....:</span>     <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....:</span>                           <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)</span>
<span class="gp">....:</span>     <span class="n">graph3D_embedded_geods</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....:</span>                      <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">....:</span>                      <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<span class="gp">....:</span>                      <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--65-input--2" name="tab-set--65" type="radio"><label class="tab-label" for="tab-set--65-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_geods</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">...</span>     <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">...</span>                        <span class="n">parameters_values</span><span class="o">=</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<span class="gp">...</span>     <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">...</span>                           <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)</span>
<span class="gp">...</span>     <span class="n">graph3D_embedded_geods</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">...</span>                      <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">...</span>                      <span class="n">display_tangent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.3&#39;</span><span class="p">),</span>
<span class="gp">...</span>                      <span class="n">width_tangent</span><span class="o">=</span><span class="n">RealNumber</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Plot the resulting geodesics on the grid of polar coordinates lines
on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> and check that these are great circles:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--66-input--1" name="tab-set--66" type="radio"><label class="tab-label" for="tab-set--66-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_polar_coords</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">cart</span><span class="p">,</span>
<span class="gp">....:</span>                          <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">....:</span>                          <span class="n">number_values</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">graph3D_embedded_geods</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--66-input--2" name="tab-set--66" type="radio"><label class="tab-label" for="tab-set--66-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># needs scipy sage.plot</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_polar_coords</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">cart</span><span class="p">,</span>
<span class="gp">...</span>                          <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">...</span>                          <span class="n">number_values</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">graph3D_embedded_geods</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default">
<img alt="../../../_images/integrated_curve-12.svg" class="plot-directive" src="../../../_images/integrated_curve-12.svg" />
</figure>
<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic.system">
<span class="sig-name descname"><span class="pre">system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/manifolds/differentiable/integrated_curve.py#L3927"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic.system" title="Link to this definition">¶</a></dt>
<dd><p>Return the system defining the geodesic: chart, equations and
initial conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); prints a detailed
description of the curve</p></li>
</ul>
<p>OUTPUT: list containing</p>
<blockquote>
<div><ul class="simple">
<li><p>the equations</p></li>
<li><p>the initial equations</p></li>
<li><p>the chart</p></li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">System defining a geodesic:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--67-input--1" name="tab-set--67" type="radio"><label class="tab-label" for="tab-set--67-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span><span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">X</span><span class="o">.&lt;</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">t</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t A&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span>
<span class="gp">sage:</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">sage:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Geodesic c in the 2-dimensional Riemannian manifold S^2</span>
<span class="go"> equipped with Riemannian metric g on the 2-dimensional</span>
<span class="go"> Riemannian manifold S^2, and integrated over the Real</span>
<span class="go"> interval (0, pi) as a solution to the following geodesic</span>
<span class="go"> equations, written with respect to Chart (S^2, (theta, phi)):</span>

<span class="go">Initial point: Point p on the 2-dimensional Riemannian</span>
<span class="go"> manifold S^2 with coordinates [1/2*pi, 0] with respect to</span>
<span class="go"> Chart (S^2, (theta, phi))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 2-dimensional Riemannian manifold S^2 with</span>
<span class="go"> components [1/2*sqrt(2), 1/2*sqrt(2)] with respect to</span>
<span class="go"> Chart (S^2, (theta, phi))</span>

<span class="go">d(theta)/dt = Dtheta</span>
<span class="go">d(phi)/dt = Dphi</span>
<span class="go">d(Dtheta)/dt = Dphi^2*cos(theta)*sin(theta)</span>
<span class="go">d(Dphi)/dt = -2*Dphi*Dtheta*cos(theta)/sin(theta)</span>

<span class="gp">sage:</span> <span class="n">sys_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">sys_bis</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--67-input--2" name="tab-set--67" type="radio"><label class="tab-label" for="tab-set--67-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span><span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">,));</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">_first_ngens</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">t</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">A</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">pi</span><span class="o">/</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">pi</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Geodesic c in the 2-dimensional Riemannian manifold S^2</span>
<span class="go"> equipped with Riemannian metric g on the 2-dimensional</span>
<span class="go"> Riemannian manifold S^2, and integrated over the Real</span>
<span class="go"> interval (0, pi) as a solution to the following geodesic</span>
<span class="go"> equations, written with respect to Chart (S^2, (theta, phi)):</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">Initial point: Point p on the 2-dimensional Riemannian</span>
<span class="go"> manifold S^2 with coordinates [1/2*pi, 0] with respect to</span>
<span class="go"> Chart (S^2, (theta, phi))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 2-dimensional Riemannian manifold S^2 with</span>
<span class="go"> components [1/2*sqrt(2), 1/2*sqrt(2)] with respect to</span>
<span class="go"> Chart (S^2, (theta, phi))</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">d(theta)/dt = Dtheta</span>
<span class="go">d(phi)/dt = Dphi</span>
<span class="go">d(Dtheta)/dt = Dphi^2*cos(theta)*sin(theta)</span>
<span class="go">d(Dphi)/dt = -2*Dphi*Dtheta*cos(theta)/sin(theta)</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sys_bis</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../../tangent_space.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tangent Spaces</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="curve.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Curves in Manifolds</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2025, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Integrated Curves and Geodesics in Manifolds</a><ul>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve"><code class="docutils literal notranslate"><span class="pre">IntegratedAutoparallelCurve</span></code></a><ul>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve.system"><code class="docutils literal notranslate"><span class="pre">system()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a><ul>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolate"><code class="docutils literal notranslate"><span class="pre">interpolate()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolation"><code class="docutils literal notranslate"><span class="pre">interpolation()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated"><code class="docutils literal notranslate"><span class="pre">plot_integrated()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solution"><code class="docutils literal notranslate"><span class="pre">solution()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve"><code class="docutils literal notranslate"><span class="pre">solve()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts"><code class="docutils literal notranslate"><span class="pre">solve_across_charts()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_analytical"><code class="docutils literal notranslate"><span class="pre">solve_analytical()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.system"><code class="docutils literal notranslate"><span class="pre">system()</span></code></a></li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.tangent_vector_eval_at"><code class="docutils literal notranslate"><span class="pre">tangent_vector_eval_at()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic"><code class="docutils literal notranslate"><span class="pre">IntegratedGeodesic</span></code></a><ul>
<li><a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic.system"><code class="docutils literal notranslate"><span class="pre">system()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../%5fstatic/documentation_options.js"></script>
    <script src="../../../../%5fstatic/doctools.js"></script>
    <script src="../../../../%5fstatic/sphinx_highlight.js"></script>
    <script src="../../../../%5fstatic/scripts/furo.js"></script>
    <script src="../../../../%5fstatic/clipboard.min.js"></script>
    <script src="../../../../%5fstatic/copybutton.js"></script>
    <script src="../../../../%5fstatic/tabs.js"></script>
    <script src="../../../../%5fstatic/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "im": "\\mathop{\\operatorname{im}}", "rank": "\\mathop{\\operatorname{rank}}", "PP": "\\Bold{P}", "OO": "\\mathcal{O}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../%5fstatic/jupyter-sphinx-furo.js"></script>
    </body>
</html>