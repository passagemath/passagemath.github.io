<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Complex multiplication for elliptic curves" href="cm.html" /><link rel="prev" title="Isogeny class of elliptic curves over number fields" href="isogeny_class.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Tate-Shafarevich group - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-codemirror-monokai.css" />
    <link rel="stylesheet" type="text/css" href="../../../../%5fstatic/custom-tabs.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../%5fstatic/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../%5fstatic/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">passagemath 10.6.2 Reference Manual</span>
  
</a><div class="select-wrapper">
  <select id="versions-menu" onchange="changeVersion()">
    <option value="" selected>other version</option>
    <option value="https://passagemath.org/docs/10.6">passagemath-10.6.x</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_point.html">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_sum.html">Sums of morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_velusqrt.html">Square‑root Vélu algorithm for elliptic-curve isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_scalar.html">Scalar-multiplication morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_frobenius.html">Frobenius isogenies of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_small_degree.html">Isogenies of small prime degree</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_poly.html">Modular polynomials for elliptic curves</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_number_field.html">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps_number_field.html">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_padic_field.html">Elliptic curves over <span class="math notranslate nohighlight">\(p\)</span>-adic fields</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice.html">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_sym_num.html">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="heegner.html">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="BSD.html">Birch and Swinnerton-Dyer formulas</a></li>
<li class="toctree-l1"><a class="reference internal" href="cardinality.html">Specific algorithms to compute cardinality of elliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="kraus.html">Global and semi-global minimal models for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/monsky_washnitzer.html">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_endomorphism_utils.html">Some functions regarding geometric endomorphism rings of Jacobians of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/passagemath/passagemath/edit/main/src/sage/schemes/elliptic_curves/sha_tate.py" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="tate-shafarevich-group">
<span id="sage-schemes-elliptic-curves-sha-tate"></span><h1>Tate-Shafarevich group<a class="headerlink" href="#tate-shafarevich-group" title="Link to this heading">¶</a></h1>
<p id="module-sage.schemes.elliptic_curves.sha_tate">If <span class="math notranslate nohighlight">\(E\)</span> is an elliptic curve over a global field <span class="math notranslate nohighlight">\(K\)</span>, the Tate-Shafarevich
group is the subgroup of elements in <span class="math notranslate nohighlight">\(H^1(K,E)\)</span> which map to zero under every
global-to-local restriction map <span class="math notranslate nohighlight">\(H^1(K,E) \to H^1(K_v,E)\)</span>, one for each place
<span class="math notranslate nohighlight">\(v\)</span> of <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>The group is usually denoted by the Russian letter Sha (Ш), in this document
it will be denoted by <span class="math notranslate nohighlight">\(Sha\)</span>.</p>
<p><span class="math notranslate nohighlight">\(Sha\)</span> is known to be an abelian torsion group. It is conjectured that the
Tate-Shafarevich group is finite for any elliptic curve over a global field.
But it is not known in general.</p>
<p>A theorem of Kolyvagin and Gross-Zagier using Heegner points shows that if the
<span class="math notranslate nohighlight">\(L\)</span>-series of an elliptic curve <span class="math notranslate nohighlight">\(E/\QQ\)</span> does not vanish at 1 or has a simple
zero there, then <span class="math notranslate nohighlight">\(Sha\)</span> is finite.</p>
<p>A theorem of Kato, together with theorems from Iwasawa theory, allows for
certain primes <span class="math notranslate nohighlight">\(p\)</span> to show that the <span class="math notranslate nohighlight">\(p\)</span>-primary part of <span class="math notranslate nohighlight">\(Sha\)</span> is finite and
gives an effective upper bound for it.</p>
<p>The (<span class="math notranslate nohighlight">\(p\)</span>-adic) conjecture of Birch and Swinnerton-Dyer predicts the order of
<span class="math notranslate nohighlight">\(Sha\)</span> from the leading term of the (<span class="math notranslate nohighlight">\(p\)</span>-adic) <span class="math notranslate nohighlight">\(L\)</span>-series of the elliptic curve.</p>
<p>Sage can compute a few things about <span class="math notranslate nohighlight">\(Sha\)</span>. The commands <code class="docutils literal notranslate"><span class="pre">an</span></code>,
<code class="docutils literal notranslate"><span class="pre">an_numerical</span></code> and <code class="docutils literal notranslate"><span class="pre">an_padic</span></code> compute the conjectural order of <span class="math notranslate nohighlight">\(Sha\)</span> as a
real or <span class="math notranslate nohighlight">\(p\)</span>-adic number. With <code class="docutils literal notranslate"><span class="pre">p_primary_bound</span></code> one can find an upper bound
of the size of the <span class="math notranslate nohighlight">\(p\)</span>-primary part of <span class="math notranslate nohighlight">\(Sha\)</span>. Finally, if the analytic rank is
at most 1, then <code class="docutils literal notranslate"><span class="pre">bound_kato</span></code> and <code class="docutils literal notranslate"><span class="pre">bound_kolyvagin</span></code> find all primes for
which the theorems of Kato and Kolyvagin respectively do not prove the
triviality the <span class="math notranslate nohighlight">\(p\)</span>-primary part of <span class="math notranslate nohighlight">\(Sha\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 5], 1)</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + O(7^5)</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>

<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Tate-Shafarevich group for the</span>
<span class="go"> Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^3)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 5], 1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">1 + O(7^5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Tate-Shafarevich group for the</span>
<span class="go"> Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1 + O(5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^3)</span>
</pre></div>
</div>
</div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein (2007) – initial version</p></li>
<li><p>Chris Wuthrich (April 2009) – reformat docstrings</p></li>
<li><p>Aly Deines, Chris Wuthrich, Jeaninne Van Order (2016-03): Added
functionality that tests the Skinner-Urban condition.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.sha_tate.</span></span><span class="sig-name descname"><span class="pre">Sha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L104"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>The Tate-Shafarevich group associated to an elliptic curve.</p>
<p>If <span class="math notranslate nohighlight">\(E\)</span> is an elliptic curve over a global field <span class="math notranslate nohighlight">\(K\)</span>, the Tate-Shafarevich
group is the subgroup of elements in <span class="math notranslate nohighlight">\(H^1(K,E)\)</span> which map to zero under
every global-to-local restriction map <span class="math notranslate nohighlight">\(H^1(K,E) \to H^1(K_v,E)\)</span>, one for
each place <span class="math notranslate nohighlight">\(v\)</span> of <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;571a1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">_set_gens</span><span class="p">([])</span>   <span class="c1"># curve has rank 0, but non-trivial Sha[2]</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2], 1)</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">4 + O(7^5)</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">4.00000000000000</span>

<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Tate-Shafarevich group for the</span>
<span class="go"> Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>         <span class="c1"># long time</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage:</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># very long time</span>
<span class="go">1 + O(5^3)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;571a1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">_set_gens</span><span class="p">([])</span>   <span class="c1"># curve has rank 0, but non-trivial Sha[2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2], 1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">4 + O(7^5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">4.00000000000000</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Tate-Shafarevich group for the</span>
<span class="go"> Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># long time</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>         <span class="c1"># long time</span>
<span class="go">1 + O(5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># very long time</span>
<span class="go">1 + O(5^3)</span>
</pre></div>
</div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.an">
<span class="sig-name descname"><span class="pre">an</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_database</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descent_second_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L301"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an" title="Link to this definition">¶</a></dt>
<dd><p>Return the Birch and Swinnerton-Dyer conjectural order of <span class="math notranslate nohighlight">\(Sha\)</span>
as a provably correct integer, unless the analytic rank is &gt; 1,
in which case this function returns a numerical value.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">use_database</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, try
to use any databases installed to lookup the analytic order of
<span class="math notranslate nohighlight">\(Sha\)</span>, if possible.  The order of <span class="math notranslate nohighlight">\(Sha\)</span> is computed if it cannot
be looked up.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">descent_second_limit</span></code> – integer (default: 12); limit to use on
point searching for the quartic twist in the hard case</p></li>
</ul>
<p>This result is proved correct if the order of vanishing is 0
and the Manin constant is &lt;= 2.</p>
<p>If the optional parameter <code class="docutils literal notranslate"><span class="pre">use_database</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">False</span></code>), this function returns the analytic order of <span class="math notranslate nohighlight">\(Sha\)</span> as
listed in Cremona’s tables, if this curve appears in Cremona’s
tables.</p>
<p>NOTE:</p>
<p class="with-sage-tab with-python-tab">If you come across the following error:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">34874</span><span class="p">,</span> <span class="o">-</span><span class="mi">2506691</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">RuntimeError: Unable to compute the rank, hence generators, with certainty</span>
<span class="go">(lower bound=0, generators found=()).  This could be because Sha(E/Q)[2] is</span>
<span class="go">nontrivial. Try increasing descent_second_limit then trying this command again.</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">34874</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2506691</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">RuntimeError: Unable to compute the rank, hence generators, with certainty</span>
<span class="go">(lower bound=0, generators found=()).  This could be because Sha(E/Q)[2] is</span>
<span class="go">nontrivial. Try increasing descent_second_limit then trying this command again.</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">You can increase the <code class="docutils literal notranslate"><span class="pre">descent_second_limit</span></code> (in the above example,
set to the default, 12) option to try again:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">(</span><span class="n">descent_second_limit</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">(</span><span class="n">descent_second_limit</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>   <span class="c1"># 11A  = X_0(11)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># X_1(11)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">(</span><span class="n">use_database</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1"># will be faster if you have large Cremona database installed</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>   <span class="c1"># 11A  = X_0(11)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>       <span class="c1"># X_1(11)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">(</span><span class="n">use_database</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1"># will be faster if you have large Cremona database installed</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The smallest conductor curve with nontrivial <span class="math notranslate nohighlight">\(Sha\)</span>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">352</span><span class="p">,</span><span class="o">-</span><span class="mi">2689</span><span class="p">])</span>     <span class="c1"># 66b3</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">352</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2689</span><span class="p">)])</span>     <span class="c1"># 66b3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The four optimal quotients with nontrivial <span class="math notranslate nohighlight">\(Sha\)</span> and conductor &lt;= 1000:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">929</span><span class="p">,</span> <span class="o">-</span><span class="mi">10595</span><span class="p">])</span>       <span class="c1"># 571A</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1154</span><span class="p">,</span> <span class="o">-</span><span class="mi">15345</span><span class="p">])</span>       <span class="c1"># 681B</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">900</span><span class="p">,</span> <span class="o">-</span><span class="mi">10098</span><span class="p">])</span>       <span class="c1"># 960D</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">42</span><span class="p">])</span>            <span class="c1"># 960N</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">929</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10595</span><span class="p">)])</span>       <span class="c1"># 571A</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1154</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15345</span><span class="p">)])</span>       <span class="c1"># 681B</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">900</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10098</span><span class="p">)])</span>       <span class="c1"># 960D</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">42</span><span class="p">)])</span>            <span class="c1"># 960N</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The smallest conductor curve of rank &gt; 1:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># 389A (rank 2)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>       <span class="c1"># 389A (rank 2)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The following are examples that require computation of the Mordell-
Weil group and regulator:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>                     <span class="c1"># 37A  (rank 1)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;1610f3&quot;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>                     <span class="c1"># 37A  (rank 1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;1610f3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">In this case the input curve is not minimal, and if this function did
not transform it to be minimal, it would give nonsense:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">432</span><span class="o">*</span><span class="mi">6</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">432</span><span class="p">)</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">**</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">See <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/10096">upstream Issue #10096</a>: this used to give the wrong result 6.0000
before since the minimal model was not used:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1215</span><span class="o">*</span><span class="mi">1216</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="c1"># non-minimal model</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>  <span class="c1"># long time (1s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1215</span><span class="p">)</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1216</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span> <span class="c1"># non-minimal model</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>  <span class="c1"># long time (1s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.an_numerical">
<span class="sig-name descname"><span class="pre">an_numerical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_database</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L210"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an_numerical" title="Link to this definition">¶</a></dt>
<dd><p>Return the numerical analytic order of <span class="math notranslate nohighlight">\(Sha\)</span>, which is
a floating point number in all cases.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer (default: 53); bits precision – used
for the <span class="math notranslate nohighlight">\(L\)</span>-series computation, period,  regulator, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_database</span></code> – whether the rank and generators should
be looked up in the database if possible. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – boolean or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>, see proof.[tab] or
sage.structure.proof) proof option passed
onto regulator and rank computation.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See also the <a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an" title="sage.schemes.elliptic_curves.sha_tate.Sha.an"><code class="xref py py-meth docutils literal notranslate"><span class="pre">an()</span></code></a> command, which will return a
provably correct integer when the rank is 0 or 1.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the curve’s generators are not known, computing
them may be very time-consuming.  Also, computation of the
<span class="math notranslate nohighlight">\(L\)</span>-series derivative will be time-consuming for large rank and
large conductor, and the computation time for this may
increase substantially at greater precision.  However, use of
very low precision less than about 10 can cause the underlying
PARI library functions to fail.</p>
</div>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;66b3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;66b3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">4.00000000000000</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">A rank 4 curve:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">79</span><span class="p">,</span> <span class="mi">289</span><span class="p">])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>  <span class="c1"># long time (3s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">79</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">289</span><span class="p">)])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>  <span class="c1"># long time (3s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">A rank 5 curve:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">79</span><span class="p">,</span> <span class="mi">342</span><span class="p">])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># long time (22s on sage.math, 2011)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">79</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">342</span><span class="p">)])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># long time (22s on sage.math, 2011)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">See <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/1115">upstream Issue #1115</a>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sha</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="p">[</span><span class="n">sha</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>  <span class="c1"># long time (3s on sage.math, 2013)</span>
<span class="go">[1.0000000000,</span>
<span class="go"> 1.0000000000000,</span>
<span class="go"> 1.0000000000000000,</span>
<span class="go"> 1.0000000000000000000,</span>
<span class="go"> 1.0000000000000000000000,</span>
<span class="go"> 1.0000000000000000000000000]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sha</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">sha</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">))]</span>  <span class="c1"># long time (3s on sage.math, 2013)</span>
<span class="go">[1.0000000000,</span>
<span class="go"> 1.0000000000000,</span>
<span class="go"> 1.0000000000000000,</span>
<span class="go"> 1.0000000000000000000,</span>
<span class="go"> 1.0000000000000000000000,</span>
<span class="go"> 1.0000000000000000000000000]</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.an_padic">
<span class="sig-name descname"><span class="pre">an_padic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_twists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L460"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an_padic" title="Link to this definition">¶</a></dt>
<dd><p>Return the conjectural order of <span class="math notranslate nohighlight">\(Sha(E/\QQ)\)</span>,
according to the <span class="math notranslate nohighlight">\(p\)</span>-adic analogue of the Birch
and Swinnerton-Dyer conjecture as formulated
in <a class="reference internal" href="../../../../references/index.html#mtt1986" id="id1"><span>[MTT1986]</span></a> and <a class="reference internal" href="../../../../references/index.html#bp1993" id="id2"><span>[BP1993]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime &gt; 3</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (optional) the precision used in the computation of the
<span class="math notranslate nohighlight">\(p\)</span>-adic L-Series</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_twists</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code> the algorithm may
change to a quadratic twist with minimal conductor to do the modular
symbol computations rather than using the modular symbols of the
curve itself. If <code class="docutils literal notranslate"><span class="pre">False</span></code> it forces the computation using the
modular symbols of the curve itself.</p></li>
</ul>
<p>OUTPUT: <span class="math notranslate nohighlight">\(p\)</span>-adic number - that conjecturally equals <span class="math notranslate nohighlight">\(\# Sha(E/\QQ)\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">prec</span></code> is set to zero (default) then the precision is set so that
at least the first <span class="math notranslate nohighlight">\(p\)</span>-adic digit of conjectural <span class="math notranslate nohighlight">\(\# Sha(E/\QQ)\)</span> is
determined.</p>
<p>EXAMPLES:</p>
<p class="with-sage-tab with-python-tab">Good ordinary examples:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># rank 0</span>
<span class="go">1 + O(5^22)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;43a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># rank 1</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># rank 2, long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^3)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;858k2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>   <span class="c1"># rank 0, non trivial sha, long time (10s on sage.math, 2011)</span>
<span class="go">7^2 + O(7^24)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;300b2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c1"># 9 elements in sha, long time (2s on sage.math, 2011)</span>
<span class="go">3^2 + O(3^24)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;300b2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">2 + 7 + O(7^8)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>    <span class="c1"># rank 0</span>
<span class="go">1 + O(5^22)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;43a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>    <span class="c1"># rank 1</span>
<span class="go">1 + O(5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># rank 2, long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^3)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;858k2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>   <span class="c1"># rank 0, non trivial sha, long time (10s on sage.math, 2011)</span>
<span class="go">7^2 + O(7^24)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;300b2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>   <span class="c1"># 9 elements in sha, long time (2s on sage.math, 2011)</span>
<span class="go">3^2 + O(3^24)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;300b2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>  <span class="c1"># long time</span>
<span class="go">2 + 7 + O(7^8)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Exceptional cases:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># rank 0</span>
<span class="go">1 + O(11^22)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;130a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 1</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="c1"># rank 0</span>
<span class="go">1 + O(11^22)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;130a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># rank 1</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Non-split, but rank 0 case (<a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/7331">upstream Issue #7331</a>):</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;270b1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 0, long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^22)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;270b1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># rank 0, long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^22)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">The output has the correct sign:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;123a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span> <span class="c1"># rank 1, long time (3s on sage.math, 2011)</span>
<span class="go">1 + O(41)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;123a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span> <span class="c1"># rank 1, long time (3s on sage.math, 2011)</span>
<span class="go">1 + O(41)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Supersingular cases:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;34a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 0</span>
<span class="go">1 + O(5^22)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;53a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 1, long time (11s on sage.math, 2011)</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;34a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># rank 0</span>
<span class="go">1 + O(5^22)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;53a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># rank 1, long time (11s on sage.math, 2011)</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Cases that use a twist to a lower conductor:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;99a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;240d3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># sha has 4 elements here</span>
<span class="go">4 + O(5)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;448c5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_twists</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">2 + 7 + O(7^6)</span>
<span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span><span class="mi">34</span><span class="p">])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># see trac #6455, long time (4s on sage.math, 2011)</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;99a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1 + O(5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;240d3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># sha has 4 elements here</span>
<span class="go">4 + O(5)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;448c5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">use_twists</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">2 + 7 + O(7^6)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">34</span><span class="p">)])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># see trac #6455, long time (4s on sage.math, 2011)</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Test for <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/15737">upstream Issue #15737</a>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage:</span> <span class="n">s</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">s</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">1 + O(13^20)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">1 + O(13^20)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.bound">
<span class="sig-name descname"><span class="pre">bound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L1143"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound" title="Link to this definition">¶</a></dt>
<dd><p>Compute a provably correct bound on the order of the Tate-Shafarevich
group of this curve.</p>
<p>The bound is either <code class="docutils literal notranslate"><span class="pre">False</span></code> (no bound) or a list <code class="docutils literal notranslate"><span class="pre">B</span></code> of primes
such that any prime divisor of the order of <span class="math notranslate nohighlight">\(Sha\)</span> is in this list.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound</span><span class="p">()</span>
<span class="go">([2], 1)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound</span><span class="p">()</span>
<span class="go">([2], 1)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.bound_kato">
<span class="sig-name descname"><span class="pre">bound_kato</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L1067"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound_kato" title="Link to this definition">¶</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(p\)</span> such that the theorems of Kato’s <a class="reference internal" href="../../../../references/index.html#kat2004" id="id3"><span>[Kat2004]</span></a>
and others (e.g., as explained in a thesis of Grigor Grigorov <a class="reference internal" href="../../../../references/index.html#gri2005" id="id4"><span>[Gri2005]</span></a>)
imply that if <span class="math notranslate nohighlight">\(p\)</span> divides  the order of <span class="math notranslate nohighlight">\(Sha(E/\QQ)\)</span> then <span class="math notranslate nohighlight">\(p\)</span> is in
the list.</p>
<p>If <span class="math notranslate nohighlight">\(L(E,1) = 0\)</span>, then this function gives no information, so
it returns <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>THEOREM: Suppose <span class="math notranslate nohighlight">\(L(E,1) \neq 0\)</span> and <span class="math notranslate nohighlight">\(p \neq 2\)</span> is a prime such
that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\)</span> does not have additive reduction at <span class="math notranslate nohighlight">\(p\)</span>,</p></li>
<li><p>either the <span class="math notranslate nohighlight">\(p\)</span>-adic representation is surjective or has its
image contained in a Borel subgroup.</p></li>
</ul>
<p>Then <span class="math notranslate nohighlight">\({ord}_p(\#Sha(E))\)</span> is bounded from above by the <span class="math notranslate nohighlight">\(p\)</span>-adic valuation of  <span class="math notranslate nohighlight">\(L(E,1)\cdot\#E(\QQ)_{tor}^2 / (\Omega_E \cdot \prod c_v)\)</span>.</p>
<p>If the <span class="math notranslate nohighlight">\(L\)</span>-series vanishes, the method <code class="docutils literal notranslate"><span class="pre">p_primary_bound</span></code> can be used instead.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>   <span class="c1"># 11A  = X_0(11)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># X_1(11)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">352</span><span class="p">,</span><span class="o">-</span><span class="mi">2689</span><span class="p">])</span>     <span class="c1"># 66B3</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>   <span class="c1"># 11A  = X_0(11)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>       <span class="c1"># X_1(11)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">352</span><span class="p">),</span><span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2689</span><span class="p">)])</span>     <span class="c1"># 66B3</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">For the following curve one really has that 25 divides the
order of <span class="math notranslate nohighlight">\(Sha\)</span> (by <a class="reference internal" href="../../../../references/index.html#gjpst2009" id="id5"><span>[GJPST2009]</span></a>):</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">332311</span><span class="p">,</span> <span class="o">-</span><span class="mi">73733731</span><span class="p">])</span>   <span class="c1"># 1058D1</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>                        <span class="c1"># long time (about 1 second)</span>
<span class="go">[2, 5, 23]</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (about 1 second)</span>
<span class="go">[]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">332311</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">73733731</span><span class="p">)])</span>   <span class="c1"># 1058D1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>                        <span class="c1"># long time (about 1 second)</span>
<span class="go">[2, 5, 23]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (about 1 second)</span>
<span class="go">[]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">For this one, <span class="math notranslate nohighlight">\(Sha\)</span> is divisible by 7:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--25-input--1" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4062871</span><span class="p">,</span> <span class="o">-</span><span class="mi">3152083138</span><span class="p">])</span>   <span class="c1"># 3364C1</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>                        <span class="c1"># long time (&lt; 10 seconds)</span>
<span class="go">[2, 7, 29]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--25-input--2" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">4062871</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3152083138</span><span class="p">)])</span>   <span class="c1"># 3364C1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>                        <span class="c1"># long time (&lt; 10 seconds)</span>
<span class="go">[2, 7, 29]</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">No information about curves of rank &gt; 0:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--26-input--1" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># 37A  (rank 1)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--26-input--2" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>       <span class="c1"># 37A  (rank 1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.bound_kolyvagin">
<span class="sig-name descname"><span class="pre">bound_kolyvagin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regulator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nonsurj_hypothesis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L911"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound_kolyvagin" title="Link to this definition">¶</a></dt>
<dd><p>Given a fundamental discriminant <span class="math notranslate nohighlight">\(D \neq -3,-4\)</span> that satisfies the
Heegner hypothesis for <span class="math notranslate nohighlight">\(E\)</span>, return a list of primes so that
Kolyvagin’s theorem (as in Gross’s paper) implies that any
prime divisor of <span class="math notranslate nohighlight">\(Sha\)</span> is in this list.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> – (optional) a fundamental discriminant &lt; -4 that satisfies
the Heegner hypothesis for <span class="math notranslate nohighlight">\(E\)</span>; if not given, use the first such <span class="math notranslate nohighlight">\(D\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regulator</span></code> – (optional) regulator of <span class="math notranslate nohighlight">\(E(K)\)</span>; if not given, will
be computed (which could take a long time)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_nonsurj_hypothesis</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>);
if <code class="docutils literal notranslate"><span class="pre">True</span></code>, then gives the bound coming from Heegner point
index, but without any hypothesis on surjectivity
of the mod-<span class="math notranslate nohighlight">\(p\)</span> representation</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> – list of primes such that if <span class="math notranslate nohighlight">\(p\)</span> divides <span class="math notranslate nohighlight">\(Sha(E/K)\)</span>, then
<span class="math notranslate nohighlight">\(p\)</span> is in this list, unless <span class="math notranslate nohighlight">\(E/K\)</span> has complex multiplication or
analytic rank greater than 2 (in which case we return 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> – the odd part of the index of the Heegner point in the full
group of <span class="math notranslate nohighlight">\(K\)</span>-rational points on <span class="math notranslate nohighlight">\(E\)</span> (if <span class="math notranslate nohighlight">\(E\)</span> has CM, returns 0)</p></li>
</ul>
<p>REMARKS:</p>
<ol class="arabic simple">
<li><p>We do not have to assume that the Manin constant is 1
(or a power of 2).  If the Manin constant were
divisible by a prime, that prime would get included in
the list of bad primes.</p></li>
<li><p>We assume the Gross-Zagier theorem is true under the
hypothesis that <span class="math notranslate nohighlight">\(gcd(N,D) = 1\)</span>, instead of the stronger
hypothesis <span class="math notranslate nohighlight">\(gcd(2\cdot N,D)=1\)</span> that is in the original
Gross-Zagier paper.  That Gross-Zagier is true when
<span class="math notranslate nohighlight">\(gcd(N,D)=1\)</span> is “well-known” to the experts, but does not
seem to written up well in the literature.</p></li>
<li><p>Correctness of the computation is guaranteed using
interval arithmetic, under the assumption that the
regulator, square root, and period lattice are
computed to precision at least <span class="math notranslate nohighlight">\(10^{-10}\)</span>, i.e., they are
correct up to addition or a real number with absolute
value less than <span class="math notranslate nohighlight">\(10^{-10}\)</span>.</p></li>
</ol>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--27-input--1" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2], 1)</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;141a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 7], 49)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--27-input--2" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2], 1)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;141a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 7], 49)</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">We get no information when the curve has rank 2.:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--28-input--1" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">(0, 0)</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;681b&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 3], 9)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--28-input--2" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">(0, 0)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;681b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 3], 9)</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_bound">
<span class="sig-name descname"><span class="pre">p_primary_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L769"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_bound" title="Link to this definition">¶</a></dt>
<dd><p>Return a provable upper bound for the order of the
<span class="math notranslate nohighlight">\(p\)</span>-primary part <span class="math notranslate nohighlight">\(Sha(E)(p)\)</span> of the Tate-Shafarevich group.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime &gt; 2</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> – nonnegative integer such that <span class="math notranslate nohighlight">\(p^e\)</span> is an upper
bound for the order of <span class="math notranslate nohighlight">\(Sha(E)(p)\)</span></p></li>
</ul>
<p>In particular, if this algorithm does not fail, then it proves
that the <span class="math notranslate nohighlight">\(p\)</span>-primary part of <span class="math notranslate nohighlight">\(Sha\)</span> is finite. This works also
for curves of rank &gt; 1.</p>
<p>Note also that this bound is sharp if one assumes the main conjecture
of Iwasawa theory of elliptic curves. One may use the method
<code class="docutils literal notranslate"><span class="pre">p_primary_order</span></code> for checking if the extra conditions hold under
which the main conjecture is known by the work of Skinner and Urban.
This then returns the provable <span class="math notranslate nohighlight">\(p\)</span>-primary part of the Tate-Shafarevich
group.</p>
<p>Currently the algorithm is only implemented when the following
conditions are verified:</p>
<ul class="simple">
<li><p>The <span class="math notranslate nohighlight">\(p\)</span>-adic Galois representation must be surjective or
must have its image contained in a Borel subgroup.</p></li>
<li><p>The reduction at <span class="math notranslate nohighlight">\(p\)</span> is not allowed to be additive.</p></li>
<li><p>If the reduction at <span class="math notranslate nohighlight">\(p\)</span> is non-split multiplicative, then
the rank must be 0.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(p = 3\)</span>, then the reduction at 3 must be good ordinary or
split multiplicative, and the rank must be 0.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>The algorithm is described in <a class="reference internal" href="../../../../references/index.html#sw2013" id="id6"><span>[SW2013]</span></a>. The results for the
reducible case can be found in <a class="reference internal" href="../../../../references/index.html#wu2004" id="id7"><span>[Wu2004]</span></a>. The main ingredient is
Kato’s result on the main conjecture in Iwasawa theory.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--29-input--1" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a3&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage:</span> <span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage:</span> <span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;858k2&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># long time (10s on sage.math, 2011)</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--29-input--2" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">0</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">0</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;858k2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># long time (10s on sage.math, 2011)</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
</div>
<p class="with-sage-tab with-python-tab">Some checks for <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/6406">upstream Issue #6406</a> and <a class="extlink-issue reference external" href="https://github.com/sagemath/sage/issues/16959">upstream Issue #16959</a>:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--30-input--1" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">2</span>

<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;608b1&#39;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: The p-adic Galois representation is not surjective or reducible.</span>
<span class="go">Current knowledge about Euler systems does not provide an upper bound</span>
<span class="go">in this case. Try an_padic for a conjectural bound.</span>

<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>           <span class="c1"># long time</span>
<span class="go">1 + O(5^22)</span>

<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;5040bi1&quot;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># long time</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--30-input--2" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>  <span class="c1"># long time</span>
<span class="go">2</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;608b1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: The p-adic Galois representation is not surjective or reducible.</span>
<span class="go">Current knowledge about Euler systems does not provide an upper bound</span>
<span class="go">in this case. Try an_padic for a conjectural bound.</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>           <span class="c1"># long time</span>
<span class="go">1 + O(5^22)</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;5040bi1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>    <span class="c1"># long time</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_order">
<span class="sig-name descname"><span class="pre">p_primary_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L714"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_order" title="Link to this definition">¶</a></dt>
<dd><p>Return the order of the <span class="math notranslate nohighlight">\(p\)</span>-primary part of the Tate-Shafarevich
group.</p>
<p>This uses the result of Skinner and Urban <a class="reference internal" href="../../../../references/index.html#su2014" id="id8"><span>[SU2014]</span></a> on the
main conjecture in Iwasawa theory. In particular the elliptic
curve must have good ordinary reduction at <span class="math notranslate nohighlight">\(p\)</span>, the residual
Galois representation must be surjective. Furthermore there must
be an auxiliary prime <span class="math notranslate nohighlight">\(\ell\)</span> dividing the conductor of the curve
exactly once such that the residual representation is ramified
at <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – an odd prime</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> – nonnegative integer such that <span class="math notranslate nohighlight">\(p^e\)</span> is the
order of the <span class="math notranslate nohighlight">\(p\)</span>-primary order if the conditions are satisfied
and raises a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> otherwise.</p></li>
</ul>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--31-input--1" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;389a1&quot;</span><span class="p">)</span>  <span class="c1"># rank 2</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">)</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: The order is not provably known using Skinner-Urban.</span>
<span class="go">Try running p_primary_bound to get a bound.</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--31-input--2" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;389a1&quot;</span><span class="p">)</span>  <span class="c1"># rank 2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="gp">...</span>
<span class="go">ValueError: The order is not provably known using Skinner-Urban.</span>
<span class="go">Try running p_primary_bound to get a bound.</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.sha_tate.Sha.two_selmer_bound">
<span class="sig-name descname"><span class="pre">two_selmer_bound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/passagemath/passagemath/blob/main/src/sage/schemes/elliptic_curves/sha_tate.py#L878"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.two_selmer_bound" title="Link to this definition">¶</a></dt>
<dd><p>Return the 2-rank, i.e. the <span class="math notranslate nohighlight">\(\GF{2}\)</span>-dimension
of the 2-torsion part of <span class="math notranslate nohighlight">\(Sha\)</span>, provided we can determine the
rank of <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p class="with-sage-tab with-python-tab">EXAMPLES:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--32-input--1" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--1">Sage</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage:</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;571a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage:</span> <span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>

<span class="gp">sage:</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;66a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage:</span> <span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage:</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;960d1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage:</span> <span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage:</span> <span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--32-input--2" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--2">Python</label><div class="tab-content docutils container">
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;571a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;66a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;960d1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="cm.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Complex multiplication for elliptic curves</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="isogeny_class.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Isogeny class of elliptic curves over number fields</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2025, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tate-Shafarevich group</a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha"><code class="docutils literal notranslate"><span class="pre">Sha</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an"><code class="docutils literal notranslate"><span class="pre">an()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an_numerical"><code class="docutils literal notranslate"><span class="pre">an_numerical()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an_padic"><code class="docutils literal notranslate"><span class="pre">an_padic()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound"><code class="docutils literal notranslate"><span class="pre">bound()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound_kato"><code class="docutils literal notranslate"><span class="pre">bound_kato()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound_kolyvagin"><code class="docutils literal notranslate"><span class="pre">bound_kolyvagin()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_bound"><code class="docutils literal notranslate"><span class="pre">p_primary_bound()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_order"><code class="docutils literal notranslate"><span class="pre">p_primary_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.two_selmer_bound"><code class="docutils literal notranslate"><span class="pre">two_selmer_bound()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../%5fstatic/documentation_options.js"></script>
    <script src="../../../../%5fstatic/doctools.js"></script>
    <script src="../../../../%5fstatic/sphinx_highlight.js"></script>
    <script src="../../../../%5fstatic/scripts/furo.js"></script>
    <script src="../../../../%5fstatic/clipboard.min.js"></script>
    <script src="../../../../%5fstatic/copybutton.js"></script>
    <script src="../../../../%5fstatic/tabs.js"></script>
    <script src="../../../../%5fstatic/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "im": "\\mathop{\\operatorname{im}}", "rank": "\\mathop{\\operatorname{rank}}", "PP": "\\Bold{P}", "OO": "\\mathcal{O}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../%5fstatic/jupyter-sphinx-furo.js"></script>
    </body>
</html>